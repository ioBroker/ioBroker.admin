const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DhhR2_Nl.js","./index-Dk74W0Oi.js","./_commonjsHelpers-BosuxZz1.js","./AdminComponentEasyAccessSet__loadShare__react__loadShare__-q7umYvNn.js","./AdminComponentEasyAccessSet__mf_v__runtimeInit__mf_v__-JbSPU0nV.js"])))=>i.map(i=>d[i]);
import{A as _e,R as o}from"./AdminComponentEasyAccessSet__loadShare__react__loadShare__-q7umYvNn.js";import{a as Nt,c as We,g as St}from"./_commonjsHelpers-BosuxZz1.js";import{A as d}from"./AdminComponentEasyAccessSet__loadShare___mf_0_mui_mf_1_material__loadShare__-CyJ0aZA_.js";import{A as P,C as Pt,D as Tt}from"./AdminComponentEasyAccessSet__loadShare__react_mf_2_dropzone__loadShare__-DcYFTtZ9.js";import{A as D}from"./AdminComponentEasyAccessSet__loadShare___mf_0_iobroker_mf_1_adapter_mf_2_react_mf_2_v5__loadShare__-Ccv-XSYH.js";import{R as Rt}from"./AdminComponentEasyAccessSet__loadShare__react_mf_2_dom__loadShare__-CyZEwvXd.js";import{F as Mt}from"./FilledInput-DXFSGhGa.js";import{b as Vt}from"./defaultTheme-DCv9Tyqi.js";import{A as _t,i as It}from"./AdminComponentEasyAccessSet__mf_v__runtimeInit__mf_v__-JbSPU0nV.js";import{_ as jt}from"./preload-helper-C1FmrZbK.js";import"./index-Dk74W0Oi.js";import"./DefaultPropsProvider-BB95xOjQ.js";import"./emotion-serialize.esm-BUa21YfQ.js";import"./AdminComponentEasyAccessSet__loadShare___mf_0_emotion_mf_1_react__loadShare__-ThZRd2Or.js";import"./jsx-runtime-DEOw6lrW.js";import"./useTheme-PVkhNxHz.js";var Ut=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,Wt=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,zt=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,ze={Space_Separator:Ut,ID_Start:Wt,ID_Continue:zt},te={isSpaceSeparator(h){return typeof h=="string"&&ze.Space_Separator.test(h)},isIdStartChar(h){return typeof h=="string"&&(h>="a"&&h<="z"||h>="A"&&h<="Z"||h==="$"||h==="_"||ze.ID_Start.test(h))},isIdContinueChar(h){return typeof h=="string"&&(h>="a"&&h<="z"||h>="A"&&h<="Z"||h>="0"&&h<="9"||h==="$"||h==="_"||h==="‌"||h==="‍"||ze.ID_Continue.test(h))},isDigit(h){return typeof h=="string"&&/[0-9]/.test(h)},isHexDigit(h){return typeof h=="string"&&/[0-9A-Fa-f]/.test(h)}};let et,ie,me,Ve,ye,ue,se,nt,Te;var Ht=function(e,t){et=String(e),ie="start",me=[],Ve=0,ye=1,ue=0,se=void 0,nt=void 0,Te=void 0;do se=Jt(),Xt[ie]();while(se.type!=="eof");return typeof t=="function"?tt({"":Te},"",t):Te};function tt(h,e,t){const s=h[e];if(s!=null&&typeof s=="object")if(Array.isArray(s))for(let i=0;i<s.length;i++){const n=String(i),r=tt(s,n,t);r===void 0?delete s[n]:Object.defineProperty(s,n,{value:r,writable:!0,enumerable:!0,configurable:!0})}else for(const i in s){const n=tt(s,i,t);n===void 0?delete s[i]:Object.defineProperty(s,i,{value:n,writable:!0,enumerable:!0,configurable:!0})}return t.call(h,e,s)}let K,q,Se,de,Y;function Jt(){for(K="default",q="",Se=!1,de=1;;){Y=fe();const h=kt[K]();if(h)return h}}function fe(){if(et[Ve])return String.fromCodePoint(et.codePointAt(Ve))}function R(){const h=fe();return h===`
`?(ye++,ue=0):h?ue+=h.length:ue++,h&&(Ve+=h.length),h}const kt={default(){switch(Y){case"	":case"\v":case"\f":case" ":case" ":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":R();return;case"/":R(),K="comment";return;case void 0:return R(),Z("eof")}if(te.isSpaceSeparator(Y)){R();return}return kt[ie]()},comment(){switch(Y){case"*":R(),K="multiLineComment";return;case"/":R(),K="singleLineComment";return}throw Q(R())},multiLineComment(){switch(Y){case"*":R(),K="multiLineCommentAsterisk";return;case void 0:throw Q(R())}R()},multiLineCommentAsterisk(){switch(Y){case"*":R();return;case"/":R(),K="default";return;case void 0:throw Q(R())}R(),K="multiLineComment"},singleLineComment(){switch(Y){case`
`:case"\r":case"\u2028":case"\u2029":R(),K="default";return;case void 0:return R(),Z("eof")}R()},value(){switch(Y){case"{":case"[":return Z("punctuator",R());case"n":return R(),ve("ull"),Z("null",null);case"t":return R(),ve("rue"),Z("boolean",!0);case"f":return R(),ve("alse"),Z("boolean",!1);case"-":case"+":R()==="-"&&(de=-1),K="sign";return;case".":q=R(),K="decimalPointLeading";return;case"0":q=R(),K="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":q=R(),K="decimalInteger";return;case"I":return R(),ve("nfinity"),Z("numeric",1/0);case"N":return R(),ve("aN"),Z("numeric",NaN);case'"':case"'":Se=R()==='"',q="",K="string";return}throw Q(R())},identifierNameStartEscape(){if(Y!=="u")throw Q(R());R();const h=st();switch(h){case"$":case"_":break;default:if(!te.isIdStartChar(h))throw rt();break}q+=h,K="identifierName"},identifierName(){switch(Y){case"$":case"_":case"‌":case"‍":q+=R();return;case"\\":R(),K="identifierNameEscape";return}if(te.isIdContinueChar(Y)){q+=R();return}return Z("identifier",q)},identifierNameEscape(){if(Y!=="u")throw Q(R());R();const h=st();switch(h){case"$":case"_":case"‌":case"‍":break;default:if(!te.isIdContinueChar(h))throw rt();break}q+=h,K="identifierName"},sign(){switch(Y){case".":q=R(),K="decimalPointLeading";return;case"0":q=R(),K="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":q=R(),K="decimalInteger";return;case"I":return R(),ve("nfinity"),Z("numeric",de*(1/0));case"N":return R(),ve("aN"),Z("numeric",NaN)}throw Q(R())},zero(){switch(Y){case".":q+=R(),K="decimalPoint";return;case"e":case"E":q+=R(),K="decimalExponent";return;case"x":case"X":q+=R(),K="hexadecimal";return}return Z("numeric",de*0)},decimalInteger(){switch(Y){case".":q+=R(),K="decimalPoint";return;case"e":case"E":q+=R(),K="decimalExponent";return}if(te.isDigit(Y)){q+=R();return}return Z("numeric",de*Number(q))},decimalPointLeading(){if(te.isDigit(Y)){q+=R(),K="decimalFraction";return}throw Q(R())},decimalPoint(){switch(Y){case"e":case"E":q+=R(),K="decimalExponent";return}if(te.isDigit(Y)){q+=R(),K="decimalFraction";return}return Z("numeric",de*Number(q))},decimalFraction(){switch(Y){case"e":case"E":q+=R(),K="decimalExponent";return}if(te.isDigit(Y)){q+=R();return}return Z("numeric",de*Number(q))},decimalExponent(){switch(Y){case"+":case"-":q+=R(),K="decimalExponentSign";return}if(te.isDigit(Y)){q+=R(),K="decimalExponentInteger";return}throw Q(R())},decimalExponentSign(){if(te.isDigit(Y)){q+=R(),K="decimalExponentInteger";return}throw Q(R())},decimalExponentInteger(){if(te.isDigit(Y)){q+=R();return}return Z("numeric",de*Number(q))},hexadecimal(){if(te.isHexDigit(Y)){q+=R(),K="hexadecimalInteger";return}throw Q(R())},hexadecimalInteger(){if(te.isHexDigit(Y)){q+=R();return}return Z("numeric",de*Number(q))},string(){switch(Y){case"\\":R(),q+=qt();return;case'"':if(Se)return R(),Z("string",q);q+=R();return;case"'":if(!Se)return R(),Z("string",q);q+=R();return;case`
`:case"\r":throw Q(R());case"\u2028":case"\u2029":Gt(Y);break;case void 0:throw Q(R())}q+=R()},start(){switch(Y){case"{":case"[":return Z("punctuator",R())}K="value"},beforePropertyName(){switch(Y){case"$":case"_":q=R(),K="identifierName";return;case"\\":R(),K="identifierNameStartEscape";return;case"}":return Z("punctuator",R());case'"':case"'":Se=R()==='"',K="string";return}if(te.isIdStartChar(Y)){q+=R(),K="identifierName";return}throw Q(R())},afterPropertyName(){if(Y===":")return Z("punctuator",R());throw Q(R())},beforePropertyValue(){K="value"},afterPropertyValue(){switch(Y){case",":case"}":return Z("punctuator",R())}throw Q(R())},beforeArrayValue(){if(Y==="]")return Z("punctuator",R());K="value"},afterArrayValue(){switch(Y){case",":case"]":return Z("punctuator",R())}throw Q(R())},end(){throw Q(R())}};function Z(h,e){return{type:h,value:e,line:ye,column:ue}}function ve(h){for(const e of h){if(fe()!==e)throw Q(R());R()}}function qt(){switch(fe()){case"b":return R(),"\b";case"f":return R(),"\f";case"n":return R(),`
`;case"r":return R(),"\r";case"t":return R(),"	";case"v":return R(),"\v";case"0":if(R(),te.isDigit(fe()))throw Q(R());return"\0";case"x":return R(),Kt();case"u":return R(),st();case`
`:case"\u2028":case"\u2029":return R(),"";case"\r":return R(),fe()===`
`&&R(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw Q(R());case void 0:throw Q(R())}return R()}function Kt(){let h="",e=fe();if(!te.isHexDigit(e)||(h+=R(),e=fe(),!te.isHexDigit(e)))throw Q(R());return h+=R(),String.fromCodePoint(parseInt(h,16))}function st(){let h="",e=4;for(;e-- >0;){const t=fe();if(!te.isHexDigit(t))throw Q(R());h+=R()}return String.fromCodePoint(parseInt(h,16))}const Xt={start(){if(se.type==="eof")throw Ee();He()},beforePropertyName(){switch(se.type){case"identifier":case"string":nt=se.value,ie="afterPropertyName";return;case"punctuator":Oe();return;case"eof":throw Ee()}},afterPropertyName(){if(se.type==="eof")throw Ee();ie="beforePropertyValue"},beforePropertyValue(){if(se.type==="eof")throw Ee();He()},beforeArrayValue(){if(se.type==="eof")throw Ee();if(se.type==="punctuator"&&se.value==="]"){Oe();return}He()},afterPropertyValue(){if(se.type==="eof")throw Ee();switch(se.value){case",":ie="beforePropertyName";return;case"}":Oe()}},afterArrayValue(){if(se.type==="eof")throw Ee();switch(se.value){case",":ie="beforeArrayValue";return;case"]":Oe()}},end(){}};function He(){let h;switch(se.type){case"punctuator":switch(se.value){case"{":h={};break;case"[":h=[];break}break;case"null":case"boolean":case"numeric":case"string":h=se.value;break}if(Te===void 0)Te=h;else{const e=me[me.length-1];Array.isArray(e)?e.push(h):Object.defineProperty(e,nt,{value:h,writable:!0,enumerable:!0,configurable:!0})}if(h!==null&&typeof h=="object")me.push(h),Array.isArray(h)?ie="beforeArrayValue":ie="beforePropertyName";else{const e=me[me.length-1];e==null?ie="end":Array.isArray(e)?ie="afterArrayValue":ie="afterPropertyValue"}}function Oe(){me.pop();const h=me[me.length-1];h==null?ie="end":Array.isArray(h)?ie="afterArrayValue":ie="afterPropertyValue"}function Q(h){return je(h===void 0?`JSON5: invalid end of input at ${ye}:${ue}`:`JSON5: invalid character '${Bt(h)}' at ${ye}:${ue}`)}function Ee(){return je(`JSON5: invalid end of input at ${ye}:${ue}`)}function rt(){return ue-=5,je(`JSON5: invalid identifier character at ${ye}:${ue}`)}function Gt(h){console.warn(`JSON5: '${Bt(h)}' in strings is not valid ECMAScript; consider escaping`)}function Bt(h){const e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(e[h])return e[h];if(h<" "){const t=h.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return h}function je(h){const e=new SyntaxError(h);return e.lineNumber=ye,e.columnNumber=ue,e}var Yt=function(e,t,s){const i=[];let n="",r,a,l="",c;if(t!=null&&typeof t=="object"&&!Array.isArray(t)&&(s=t.space,c=t.quote,t=t.replacer),typeof t=="function")a=t;else if(Array.isArray(t)){r=[];for(const A of t){let w;typeof A=="string"?w=A:(typeof A=="number"||A instanceof String||A instanceof Number)&&(w=String(A)),w!==void 0&&r.indexOf(w)<0&&r.push(w)}}return s instanceof Number?s=Number(s):s instanceof String&&(s=String(s)),typeof s=="number"?s>0&&(s=Math.min(10,Math.floor(s)),l="          ".substr(0,s)):typeof s=="string"&&(l=s.substr(0,10)),u("",{"":e});function u(A,w){let F=w[A];switch(F!=null&&(typeof F.toJSON5=="function"?F=F.toJSON5(A):typeof F.toJSON=="function"&&(F=F.toJSON(A))),a&&(F=a.call(w,A,F)),F instanceof Number?F=Number(F):F instanceof String?F=String(F):F instanceof Boolean&&(F=F.valueOf()),F){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof F=="string")return m(F);if(typeof F=="number")return String(F);if(typeof F=="object")return Array.isArray(F)?T(F):y(F)}function m(A){const w={"'":.1,'"':.2},F={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let S="";for(let x=0;x<A.length;x++){const C=A[x];switch(C){case"'":case'"':w[C]++,S+=C;continue;case"\0":if(te.isDigit(A[x+1])){S+="\\x00";continue}}if(F[C]){S+=F[C];continue}if(C<" "){let p=C.charCodeAt(0).toString(16);S+="\\x"+("00"+p).substring(p.length);continue}S+=C}const L=c||Object.keys(w).reduce((x,C)=>w[x]<w[C]?x:C);return S=S.replace(new RegExp(L,"g"),F[L]),L+S+L}function y(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let w=n;n=n+l;let F=r||Object.keys(A),S=[];for(const x of F){const C=u(x,A);if(C!==void 0){let p=_(x)+":";l!==""&&(p+=" "),p+=C,S.push(p)}}let L;if(S.length===0)L="{}";else{let x;if(l==="")x=S.join(","),L="{"+x+"}";else{let C=`,
`+n;x=S.join(C),L=`{
`+n+x+`,
`+w+"}"}}return i.pop(),n=w,L}function _(A){if(A.length===0)return m(A);const w=String.fromCodePoint(A.codePointAt(0));if(!te.isIdStartChar(w))return m(A);for(let F=w.length;F<A.length;F++)if(!te.isIdContinueChar(String.fromCodePoint(A.codePointAt(F))))return m(A);return A}function T(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let w=n;n=n+l;let F=[];for(let L=0;L<A.length;L++){const x=u(String(L),A);F.push(x!==void 0?x:"null")}let S;if(F.length===0)S="[]";else if(l==="")S="["+F.join(",")+"]";else{let L=`,
`+n,x=F.join(L);S=`[
`+n+x+`,
`+w+"]"}return i.pop(),n=w,S}};const Zt={parse:Ht,stringify:Yt};var Qt=Zt,it={exports:{}};function es(h){throw new Error('Could not dynamically require "'+h+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Me={exports:{}};const ts={},ss=Object.freeze(Object.defineProperty({__proto__:null,default:ts},Symbol.toStringTag,{value:"Module"})),ns=Nt(ss);var is=Me.exports,ot;function rs(){return ot||(ot=1,function(h,e){(function(t,s){h.exports=s()})(is,function(){var t=t||function(s,i){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof We<"u"&&We.crypto&&(n=We.crypto),!n&&typeof es=="function")try{n=ns}catch{}var r=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function S(){}return function(L){var x;return S.prototype=L,x=new S,S.prototype=null,x}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(S){var L=a(this);return S&&L.mixIn(S),(!L.hasOwnProperty("init")||this.init===L.init)&&(L.init=function(){L.$super.init.apply(this,arguments)}),L.init.prototype=L,L.$super=this,L},create:function(){var S=this.extend();return S.init.apply(S,arguments),S},init:function(){},mixIn:function(S){for(var L in S)S.hasOwnProperty(L)&&(this[L]=S[L]);S.hasOwnProperty("toString")&&(this.toString=S.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),m=c.WordArray=u.extend({init:function(S,L){S=this.words=S||[],L!=i?this.sigBytes=L:this.sigBytes=S.length*4},toString:function(S){return(S||_).stringify(this)},concat:function(S){var L=this.words,x=S.words,C=this.sigBytes,p=S.sigBytes;if(this.clamp(),C%4)for(var g=0;g<p;g++){var f=x[g>>>2]>>>24-g%4*8&255;L[C+g>>>2]|=f<<24-(C+g)%4*8}else for(var v=0;v<p;v+=4)L[C+v>>>2]=x[v>>>2];return this.sigBytes+=p,this},clamp:function(){var S=this.words,L=this.sigBytes;S[L>>>2]&=4294967295<<32-L%4*8,S.length=s.ceil(L/4)},clone:function(){var S=u.clone.call(this);return S.words=this.words.slice(0),S},random:function(S){for(var L=[],x=0;x<S;x+=4)L.push(r());return new m.init(L,S)}}),y=l.enc={},_=y.Hex={stringify:function(S){for(var L=S.words,x=S.sigBytes,C=[],p=0;p<x;p++){var g=L[p>>>2]>>>24-p%4*8&255;C.push((g>>>4).toString(16)),C.push((g&15).toString(16))}return C.join("")},parse:function(S){for(var L=S.length,x=[],C=0;C<L;C+=2)x[C>>>3]|=parseInt(S.substr(C,2),16)<<24-C%8*4;return new m.init(x,L/2)}},T=y.Latin1={stringify:function(S){for(var L=S.words,x=S.sigBytes,C=[],p=0;p<x;p++){var g=L[p>>>2]>>>24-p%4*8&255;C.push(String.fromCharCode(g))}return C.join("")},parse:function(S){for(var L=S.length,x=[],C=0;C<L;C++)x[C>>>2]|=(S.charCodeAt(C)&255)<<24-C%4*8;return new m.init(x,L)}},A=y.Utf8={stringify:function(S){try{return decodeURIComponent(escape(T.stringify(S)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(S){return T.parse(unescape(encodeURIComponent(S)))}},w=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new m.init,this._nDataBytes=0},_append:function(S){typeof S=="string"&&(S=A.parse(S)),this._data.concat(S),this._nDataBytes+=S.sigBytes},_process:function(S){var L,x=this._data,C=x.words,p=x.sigBytes,g=this.blockSize,f=g*4,v=p/f;S?v=s.ceil(v):v=s.max((v|0)-this._minBufferSize,0);var E=v*g,B=s.min(E*4,p);if(E){for(var $=0;$<E;$+=g)this._doProcessBlock(C,$);L=C.splice(0,E),x.sigBytes-=B}return new m.init(L,B)},clone:function(){var S=u.clone.call(this);return S._data=this._data.clone(),S},_minBufferSize:0});c.Hasher=w.extend({cfg:u.extend(),init:function(S){this.cfg=this.cfg.extend(S),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(S){return this._append(S),this._process(),this},finalize:function(S){S&&this._append(S);var L=this._doFinalize();return L},blockSize:16,_createHelper:function(S){return function(L,x){return new S.init(x).finalize(L)}},_createHmacHelper:function(S){return function(L,x){return new F.HMAC.init(S,x).finalize(L)}}});var F=l.algo={};return l}(Math);return t})}(Me)),Me.exports}var os=it.exports;(function(h,e){(function(t,s){h.exports=s(rs())})(os,function(t){return function(s){var i=t,n=i.lib,r=n.WordArray,a=n.Hasher,l=i.algo,c=[];(function(){for(var A=0;A<64;A++)c[A]=s.abs(s.sin(A+1))*4294967296|0})();var u=l.MD5=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(A,w){for(var F=0;F<16;F++){var S=w+F,L=A[S];A[S]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}var x=this._hash.words,C=A[w+0],p=A[w+1],g=A[w+2],f=A[w+3],v=A[w+4],E=A[w+5],B=A[w+6],$=A[w+7],O=A[w+8],I=A[w+9],k=A[w+10],M=A[w+11],z=A[w+12],W=A[w+13],H=A[w+14],J=A[w+15],N=x[0],j=x[1],V=x[2],U=x[3];N=m(N,j,V,U,C,7,c[0]),U=m(U,N,j,V,p,12,c[1]),V=m(V,U,N,j,g,17,c[2]),j=m(j,V,U,N,f,22,c[3]),N=m(N,j,V,U,v,7,c[4]),U=m(U,N,j,V,E,12,c[5]),V=m(V,U,N,j,B,17,c[6]),j=m(j,V,U,N,$,22,c[7]),N=m(N,j,V,U,O,7,c[8]),U=m(U,N,j,V,I,12,c[9]),V=m(V,U,N,j,k,17,c[10]),j=m(j,V,U,N,M,22,c[11]),N=m(N,j,V,U,z,7,c[12]),U=m(U,N,j,V,W,12,c[13]),V=m(V,U,N,j,H,17,c[14]),j=m(j,V,U,N,J,22,c[15]),N=y(N,j,V,U,p,5,c[16]),U=y(U,N,j,V,B,9,c[17]),V=y(V,U,N,j,M,14,c[18]),j=y(j,V,U,N,C,20,c[19]),N=y(N,j,V,U,E,5,c[20]),U=y(U,N,j,V,k,9,c[21]),V=y(V,U,N,j,J,14,c[22]),j=y(j,V,U,N,v,20,c[23]),N=y(N,j,V,U,I,5,c[24]),U=y(U,N,j,V,H,9,c[25]),V=y(V,U,N,j,f,14,c[26]),j=y(j,V,U,N,O,20,c[27]),N=y(N,j,V,U,W,5,c[28]),U=y(U,N,j,V,g,9,c[29]),V=y(V,U,N,j,$,14,c[30]),j=y(j,V,U,N,z,20,c[31]),N=_(N,j,V,U,E,4,c[32]),U=_(U,N,j,V,O,11,c[33]),V=_(V,U,N,j,M,16,c[34]),j=_(j,V,U,N,H,23,c[35]),N=_(N,j,V,U,p,4,c[36]),U=_(U,N,j,V,v,11,c[37]),V=_(V,U,N,j,$,16,c[38]),j=_(j,V,U,N,k,23,c[39]),N=_(N,j,V,U,W,4,c[40]),U=_(U,N,j,V,C,11,c[41]),V=_(V,U,N,j,f,16,c[42]),j=_(j,V,U,N,B,23,c[43]),N=_(N,j,V,U,I,4,c[44]),U=_(U,N,j,V,z,11,c[45]),V=_(V,U,N,j,J,16,c[46]),j=_(j,V,U,N,g,23,c[47]),N=T(N,j,V,U,C,6,c[48]),U=T(U,N,j,V,$,10,c[49]),V=T(V,U,N,j,H,15,c[50]),j=T(j,V,U,N,E,21,c[51]),N=T(N,j,V,U,z,6,c[52]),U=T(U,N,j,V,f,10,c[53]),V=T(V,U,N,j,k,15,c[54]),j=T(j,V,U,N,p,21,c[55]),N=T(N,j,V,U,O,6,c[56]),U=T(U,N,j,V,J,10,c[57]),V=T(V,U,N,j,B,15,c[58]),j=T(j,V,U,N,W,21,c[59]),N=T(N,j,V,U,v,6,c[60]),U=T(U,N,j,V,M,10,c[61]),V=T(V,U,N,j,g,15,c[62]),j=T(j,V,U,N,I,21,c[63]),x[0]=x[0]+N|0,x[1]=x[1]+j|0,x[2]=x[2]+V|0,x[3]=x[3]+U|0},_doFinalize:function(){var A=this._data,w=A.words,F=this._nDataBytes*8,S=A.sigBytes*8;w[S>>>5]|=128<<24-S%32;var L=s.floor(F/4294967296),x=F;w[(S+64>>>9<<4)+15]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,w[(S+64>>>9<<4)+14]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,A.sigBytes=(w.length+1)*4,this._process();for(var C=this._hash,p=C.words,g=0;g<4;g++){var f=p[g];p[g]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}return C},clone:function(){var A=a.clone.call(this);return A._hash=this._hash.clone(),A}});function m(A,w,F,S,L,x,C){var p=A+(w&F|~w&S)+L+C;return(p<<x|p>>>32-x)+w}function y(A,w,F,S,L,x,C){var p=A+(w&S|F&~S)+L+C;return(p<<x|p>>>32-x)+w}function _(A,w,F,S,L,x,C){var p=A+(w^F^S)+L+C;return(p<<x|p>>>32-x)+w}function T(A,w,F,S,L,x,C){var p=A+(F^(w|~S))+L+C;return(p<<x|p>>>32-x)+w}i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),t.MD5})})(it);var as=it.exports;const at=St(as),ls=window.innerWidth<=600?12:void 0;function Je(h){return Object.prototype.toString.call(h)==="[object Object]"}class b extends _e.Component{static DIFFERENT_VALUE="__different__";static DIFFERENT_LABEL="ra___different__";static NONE_VALUE="";static NONE_LABEL="ra_none";defaultValue;isError;lang;defaultSendToDone;sendToTimeout;noPlaceRequired;constructor(e){super(e),this.state={confirmDialog:!1,confirmNewValue:null,confirmAttr:null,confirmData:null,confirmCallback:null},this.isError={},e.schema&&(e.custom?this.defaultValue=e.schema.defaultFunc?this.executeCustom(e.schema.defaultFunc,e.data,e.customObj,e.oContext.instanceObj,e.arrayIndex,e.globalData):e.schema.default:e.schema.type!=="state"&&(this.defaultValue=e.schema.defaultFunc?this.execute(e.schema.defaultFunc,e.schema.default,e.data,e.arrayIndex,e.globalData):e.schema.default)),this.lang=D.I18n.getLanguage()}componentDidMount(){this.props.oContext.registerOnForceUpdate&&this.props.oContext.registerOnForceUpdate(this.props.attr,this.onUpdate);const e=["select","autocomplete","autocompleteSendTo"];if(this.defaultValue!==void 0){const t=b.getValue(this.props.data,this.props.attr);(t===void 0||e.includes(this.props.schema.type)&&(t===""||t===null))&&setTimeout(()=>{this.props.custom?this.props.onChange(this.props.attr,this.defaultValue,()=>setTimeout(()=>this.props.oContext.forceUpdate([this.props.attr],this.props.data),100)):(b.setValue(this.props.data,this.props.attr,this.defaultValue),this.props.onChange(this.props.data,void 0,()=>this.props.oContext.forceUpdate([this.props.attr],this.props.data)))},100)}else this.props.schema.defaultSendTo&&this.sendTo()}sendTo(){if(this.props.alive){this.defaultSendToDone=!0;let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData,null,!0);try{e=JSON.parse(t)}catch{console.error(`Cannot parse json data: ${t}`)}}else e={attr:this.props.attr,value:b.getValue(this.props.data,this.props.attr)};e===void 0&&(e=null),this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.defaultSendTo,e).then(t=>{t!=null&&(this.props.custom?this.props.onChange(this.props.attr,t,()=>this.props.oContext.forceUpdate([this.props.attr],this.props.data)):(b.setValue(this.props.data,this.props.attr,t),this.props.onChange(this.props.data,void 0,()=>this.props.oContext.forceUpdate([this.props.attr],this.props.data))))})}else this.defaultSendToDone=!1,this.props.schema.allowSaveWithError||this.onError(this.props.attr,D.I18n.t("ra_Instance %s is not alive",this.props.oContext.instance.toString()))}componentWillUnmount(){this.props.oContext.registerOnForceUpdate&&this.props.oContext.registerOnForceUpdate(this.props.attr),this.sendToTimeout&&(clearTimeout(this.sendToTimeout),this.sendToTimeout=null)}onUpdate=e=>{const t=b.getValue(e||this.props.data,this.props.attr)||"";this.state.value!==t?this.setState({value:t}):this.forceUpdate()};static getValue(e,t){if(typeof t=="string")return b.getValue(e,t.split("."));if(t.length===1)return e[t[0]];const s=t.shift();if(typeof s=="string"&&typeof e[s]=="object")return b.getValue(e[s],t)}static setValue(e,t,s){if(typeof t=="string"){b.setValue(e,t.split("."),s);return}if(t.length===1)s===null?delete e[t[0]]:e[t[0]]=s;else{const i=t.shift();if(typeof i!="string")return;(!e[i]||typeof e[i]=="object")&&(e[i]=e[i]||{}),b.setValue(e[i],t,s)}}getText(e,t){if(!e)return"";if(typeof e=="string"){const s=t?e:D.I18n.t(e);return s.includes("${")?this.getPattern(s,null,t):s}return Je(e)?e.func?typeof e.func=="object"?this.getPattern(e.func[this.lang]||e.func.en||"",null,!0):this.getPattern(e.func,null,t):e[this.lang]||e.en||"":e.toString()}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const e=this.state.confirmData||this.props.schema.confirm;let t=null;return e.type==="warning"?t=o.createElement(P.Warning,null):e.type==="error"?t=o.createElement(P.Error,null):e.type==="info"&&(t=o.createElement(P.Info,null)),o.createElement(D.DialogConfirm,{title:this.getText(e.title)||D.I18n.t("ra_Please confirm"),text:this.getText(e.text),ok:this.getText(e.ok)||D.I18n.t("ra_Ok"),cancel:this.getText(e.cancel)||D.I18n.t("ra_Cancel"),icon:t||void 0,onClose:s=>this.setState({confirmDialog:!1},()=>{if(s){if(this.state.confirmCallback){const n=this.state.confirmCallback;this.setState({confirmCallback:null},()=>n(!0));return}const i=JSON.parse(JSON.stringify(this.props.data));this.state.confirmDepAttr&&b.setValue(i,this.state.confirmDepAttr,this.state.confirmDepNewValue),b.setValue(i,this.state.confirmAttr,this.state.confirmNewValue),this.setState({confirmDialog:!1,confirmDepAttr:null,confirmDepNewValue:null,confirmNewValue:null,confirmAttr:null,confirmData:null},()=>this.props.onChange(i))}else{const i=this.state.confirmCallback;this.setState({confirmDialog:!1,confirmDepAttr:null,confirmDepNewValue:null,confirmNewValue:null,confirmAttr:null,confirmData:null,confirmCallback:null},()=>{i&&i(!1)})}})})}getIcon(e){e=e||this.props.schema.icon;let t=null;return e==="auth"?t=o.createElement(P.Key,null):e==="send"?t=o.createElement(P.Send,null):e==="web"?t=o.createElement(P.Public,null):e==="warning"?t=o.createElement(P.Warning,null):e==="error"?t=o.createElement(P.Error,null):e==="info"?t=o.createElement(P.Info,null):e==="search"?t=o.createElement(P.Search,null):e==="book"?t=o.createElement(P.MenuBook,null):e==="help"?t=o.createElement(P.Help,null):e==="upload"?t=o.createElement(P.UploadFile,null):e==="edit"?t=o.createElement(P.Edit,null):e==="user"?t=o.createElement(P.Person,null):e==="group"?t=o.createElement(P.Group,null):e==="delete"?t=o.createElement(P.Delete,null):e==="refresh"?t=o.createElement(P.Refresh,null):e==="add"?t=o.createElement(P.Add,null):e==="unpair"?t=o.createElement(P.LinkOff,null):e==="pair"?t=o.createElement(P.Link,null):e==="save"?t=o.createElement(P.Save,null):e==="open"?t=o.createElement(P.OpenInNew,null):e&&((e.endsWith(".png")||e.endsWith(".svg")||e.endsWith(".jpg"))&&!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`./adapter/${this.props.oContext.adapterName}/${e}`),t=o.createElement(D.Icon,{src:e,style:{width:22,height:22}})),t}onChangeAsync(e,t){return new Promise(s=>{const i=this.onChange(e,t,s);i instanceof Promise&&i.catch(n=>console.error(`Cannot set value: ${n}`))})}onChange(e,t,s){const i=JSON.parse(JSON.stringify(this.props.data));if(b.setValue(i,e,t),this.props.schema.confirm&&this.execute(this.props.schema.confirm.condition,!1,i,this.props.arrayIndex,this.props.globalData))return new Promise(r=>{this.setState({confirmDialog:!0,confirmNewValue:t,confirmAttr:e,confirmData:null},()=>{typeof s=="function"?s():r()})});if(this.props.schema.confirmDependsOn)for(let r=0;r<this.props.schema.confirmDependsOn.length;r++){const a=this.props.schema.confirmDependsOn[r];if(a.confirm){const l=b.getValue(i,a.attr);if(this.execute(a.confirm.condition,!1,i,this.props.arrayIndex,this.props.globalData))return new Promise(c=>{this.setState({confirmDialog:!0,confirmNewValue:t,confirmAttr:e,confirmDepNewValue:l,confirmDepAttr:a.attr,confirmData:a.confirm},()=>{typeof s=="function"?s():c()})})}}const n=[];if(this.props.schema.onChangeDependsOn)for(let r=0;r<this.props.schema.onChangeDependsOn.length;r++){const a=this.props.schema.onChangeDependsOn[r];if(a.onChange){const l=b.getValue(i,a.attr);let c;this.props.custom?c=this.executeCustom(a.onChange.calculateFunc,i,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):c=this.execute(a.onChange.calculateFunc,l,i,this.props.arrayIndex,this.props.globalData),c!==l&&(b.setValue(i,a.attr,c),n.push(a.attr))}}if(this.props.schema.hiddenDependsOn)for(let r=0;r<this.props.schema.hiddenDependsOn.length;r++){const a=this.props.schema.hiddenDependsOn[r];a.hidden&&n.push(a.attr)}if(this.props.schema.labelDependsOn)for(let r=0;r<this.props.schema.labelDependsOn.length;r++){const a=this.props.schema.labelDependsOn[r];a.hidden&&n.push(a.attr)}if(this.props.schema.helpDependsOn)for(let r=0;r<this.props.schema.helpDependsOn.length;r++){const a=this.props.schema.helpDependsOn[r];a.hidden&&n.push(a.attr)}if(this.props.schema.onChange&&!this.props.schema.onChange.ignoreOwnChanges){const r=b.getValue(i,this.props.attr),a=this.props.custom?this.executeCustom(this.props.schema.onChange.calculateFunc,i,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):this.execute(this.props.schema.onChange.calculateFunc,r,i,this.props.arrayIndex,this.props.globalData);a!==r&&b.setValue(i,this.props.attr,a)}return this.props.custom?(this.props.onChange(e,t,()=>s&&s()),n!=null&&n.length&&n.forEach((r,a)=>setTimeout(()=>this.props.onChange(r,b.getValue(i,r)),a*50))):this.props.onChange(i,void 0,()=>{n.length&&this.props.oContext.forceUpdate(n,i),s&&s()}),Promise.resolve()}execute(e,t,s,i,n){let r;if(Je(e))r=e.func;else if(typeof e=="string")r=e;else return e;if(!r)return t;try{return new Function("data","originalData","_system","_alive","_common","_socket","_instance","arrayIndex","globalData","_changed",r.includes("return")?r:`return ${r}`)(s||this.props.data,this.props.originalData,this.props.oContext.systemConfig,this.props.alive,this.props.common,this.props.oContext.socket,this.props.oContext.instance,i,n,this.props.changed)}catch(a){return console.error(`Cannot execute ${JSON.stringify(e)}: ${a}`),t}}executeCustom(e,t,s,i,n,r){let a;if(Je(e))a=e.func;else if(typeof e=="string")a=e;else return e;if(!a)return null;try{return new Function("data","originalData","_system","instanceObj","customObj","_socket","arrayIndex","globalData","_changed",a.includes("return")?a:`return ${a}`)(t||this.props.data,this.props.originalData,this.props.oContext.systemConfig,i,s,this.props.oContext.socket,n,r,this.props.changed)}catch(l){return console.error(`Cannot execute ${a}: ${l}`),null}}calculate(e){let t,s,i,n;return this.props.custom?(t=e.validator?!this.executeCustom(e.validator,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):!1,e.disabled===!0?s=!0:s=e.disabled?this.executeCustom(e.disabled,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):!1,e.hidden===!0?i=!0:i=e.hidden?this.executeCustom(e.hidden,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):!1,n=e.defaultFunc?this.executeCustom(e.defaultFunc,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):e.default):(t=e.validator?!this.execute(e.validator,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,e.disabled===!0?s=!0:s=e.disabled?this.execute(e.disabled,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,e.hidden===!0?i=!0:i=e.hidden?this.execute(e.hidden,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,n=e.defaultFunc?this.execute(e.defaultFunc,e.default,this.props.data,this.props.arrayIndex,this.props.globalData):e.default),{error:t,disabled:s,hidden:i,defaultValue:n}}onError(e,t){t?this.isError[e]=t:delete this.isError[e],this.props.onError&&this.props.onError(e,t)}renderItem(e,t,s){return this.getText(this.props.schema.label)||this.getText(this.props.schema.text)}renderHelp(e,t,s){return t?o.createElement("a",{href:t,target:"_blank",rel:"noreferrer",style:{color:this.props.oContext.themeType==="dark"?"#a147ff":"#5b238f",textDecoration:"underline"}},this.getText(e,s)):(e=this.getText(e,s)||"",e&&(e.includes("<a ")||e.includes("<br")||e.includes("<b>")||e.includes("<i>"))?D.Utils.renderTextWithA(e):e)}static escapeString(e,t){return typeof e!="string"?"":(e=e.replace(/`/g,"\\`"),e=e.replace(/\${([^}]+)}/g,(s,i)=>{if(i&&typeof i=="string"&&i.startsWith("data.")){const n=b.getValue(t,i.replace(/^data\./,""));if(typeof n=="string"&&n.includes('"'))return`\${${i}.replace(/"/g, '\\\\"')}`}return s}),e)}getPattern(e,t,s){if(t=t||this.props.data,!e)return"";let i;typeof e=="object"?e.func?i=e.func:(console.log(`Object must be stringified: ${JSON.stringify(e)}`),i=JSON.stringify(e)):i=e;try{if(this.props.custom)return new Function("data","originalData","arrayIndex","globalData","_system","instanceObj","customObj","_socket","_changed",`return \`${b.escapeString(i,t)}\``)(t,this.props.originalData,this.props.arrayIndex,this.props.globalData,this.props.oContext.systemConfig,this.props.oContext.instanceObj,this.props.customObj,this.props.oContext.socket,this.props.changed);const r=new Function("data","originalData","arrayIndex","globalData","_system","_alive","_common","_socket","_changed",`return \`${b.escapeString(i,t)}\``)(t,this.props.originalData,this.props.arrayIndex,this.props.globalData,this.props.oContext.systemConfig,this.props.alive,this.props.common,this.props.oContext.socket,this.props.changed);return s?r:D.I18n.t(r)}catch(n){return console.error(`Cannot execute ${i}: ${n}`),i}}render(){const e=this.props.schema;if(!e||this.props.oContext.expertMode===!1&&e.expertMode)return null;this.props.alive&&this.defaultSendToDone===!1&&(this.sendToTimeout=setTimeout(()=>{this.sendToTimeout=null,this.sendTo()},200));const{error:t,disabled:s,hidden:i,defaultValue:n}=this.calculate(e);if(i){if(Object.keys(this.isError).length&&(setTimeout(l=>Object.keys(l).forEach(c=>this.props.onError(c)),100,JSON.parse(JSON.stringify(this.isError))),this.isError={}),e.hideOnlyControl){const l=o.createElement(d.Grid2,{size:{xs:e.xs||ls,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},style:{marginBottom:0,textAlign:"left",...e.style,...this.props.oContext.themeType==="dark"?e.darkStyle:{}}});return e.newLine?o.createElement(o.Fragment,null,o.createElement("div",{style:{flexBasis:"100%",height:0}}),l):l}return null}e.validatorNoSaveOnError&&(t&&!Object.keys(this.isError).length?(this.isError={[this.props.attr]:e.validatorErrorText?D.I18n.t(e.validatorErrorText):!0},setTimeout(l=>Object.keys(l).forEach(c=>this.props.onError(c,l[c])),100,JSON.parse(JSON.stringify(this.isError)))):!t&&Object.keys(this.isError).length&&(setTimeout(l=>Object.keys(l).forEach(c=>this.props.onError(c)),100,JSON.parse(JSON.stringify(this.isError))),this.isError={}));const r=this.renderItem(t,s||this.props.commandRunning||this.props.disabled,n);if(this.noPlaceRequired)return r;const a=o.createElement(d.Grid2,{title:this.getText(e.tooltip),size:{xs:e.xs||12,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},style:{marginBottom:0,textAlign:"left",width:e.type==="divider"||e.type==="header"?e.width||"100%":void 0,...e.style,...this.props.oContext.themeType==="dark"?e.darkStyle:{}}},this.props.schema.defaultSendTo&&this.props.schema.button?o.createElement(d.Grid2,{container:!0,style:{width:"100%"}},o.createElement(d.Grid2,{flex:1},r),o.createElement(d.Grid2,null,o.createElement(d.Button,{disabled:s,variant:"outlined",onClick:()=>this.sendTo(),title:this.props.schema.buttonTooltip?this.getText(this.props.schema.buttonTooltip,this.props.schema.buttonTooltipNoTranslation):D.I18n.t("ra_Request data by instance")},this.getText(this.props.schema.button)))):r);return e.newLine?o.createElement(o.Fragment,null,o.createElement("div",{style:{flexBasis:"100%",height:0}}),this.renderDialogConfirm(),a):this.state.confirmDialog?o.createElement(o.Fragment,null,this.renderDialogConfirm(),a):a}}const ae={fullWidth:{width:"100%"},accordionSummary:h=>({backgroundColor:h.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)"}),accordionTitle:{},toolbar:h=>({backgroundColor:h.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",borderRadius:"3px"}),tooltip:{pointerEvents:"none"}};class us extends b{typingTimer=null;constructor(e){super(e),this.props.schema.items=this.props.schema.items||[]}componentDidMount(){super.componentDidMount();let e=b.getValue(this.props.data,this.props.attr)||[];Array.isArray(e)||(e=[]),this.setState({value:e,activeIndex:-1,iteration:0})}componentWillUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),super.componentWillUnmount()}itemAccordion(e,t){const{value:s}=this.state,{schema:i}=this.props,n={type:"panel",items:i.items.reduce((r,a)=>(r[a.attr]=a,r),{}),style:{marginLeft:"-8px",marginTop:"10px",marginBottom:"10px"}};return o.createElement(Ae,{oContext:this.props.oContext,index:t+this.state.iteration,arrayIndex:t,changed:this.props.changed,globalData:this.props.data,common:this.props.common,alive:this.props.alive,themeName:this.props.themeName,data:e,custom:!0,schema:n,originalData:this.props.originalData,onChange:(r,a)=>{const l=JSON.parse(JSON.stringify(s));l[t][r]=a,this.setState({value:l},()=>this.onChangeWrapper(l))},onError:(r,a)=>this.onError(r,a),table:this.props.table})}onDelete=e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value));t.splice(e,1),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))};onClone=e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value)),s=JSON.parse(JSON.stringify(t[e]));if(typeof this.props.schema.clone=="string"&&typeof s[this.props.schema.clone]=="string"){let i=1,n=s[this.props.schema.clone];const r=n.match(/(\d+)$/);for(r?(n=n.replace(r[0],""),i=parseInt(r[0],10)+1):n+="_";t.find(a=>a[this.props.schema.clone]===n+i.toString());)i++;s[this.props.schema.clone]=`${s[this.props.schema.clone]}_${i}`}t.splice(e,0,s),this.setState({value:t,activeIndex:-1,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))};onChangeWrapper=e=>{this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=setTimeout(t=>{this.typingTimer=null;const s=this.onChange(this.props.attr,t);s instanceof Promise&&s.catch(i=>this.onError(i))},300,e)};onAdd=()=>{const{schema:e}=this.props,t=JSON.parse(JSON.stringify(this.state.value)),s=e.items&&e.items.reduce((i,n)=>{let r;return n.defaultFunc?this.props.custom?r=n.defaultFunc?this.executeCustom(n.defaultFunc,this.props.data,this.props.customObj,this.props.oContext.instanceObj,t.length,this.props.data):this.props.schema.default:r=n.defaultFunc?this.execute(n.defaultFunc,this.props.schema.default,this.props.data,t.length,this.props.data):this.props.schema.default:r=n.default===void 0?null:n.default,i[n.attr]=r,i},{});t.push(s),this.setState({value:t,activeIndex:t.length-1},()=>this.onChangeWrapper(t))};onMoveUp(e){const t=JSON.parse(JSON.stringify(this.state.value)),s=t[e];t.splice(e,1),t.splice(e-1,0,s);const i=this.state.activeIndex-1;this.setState({value:t,activeIndex:i,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))}onMoveDown(e){const t=JSON.parse(JSON.stringify(this.state.value)),s=t[e];t.splice(e,1),t.splice(e+1,0,s);const i=this.state.activeIndex+1;this.setState({value:t,activeIndex:i,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))}renderItem(){const{schema:e}=this.props,{value:t}=this.state;return t?o.createElement(d.Paper,null,e.label||!e.noDelete?o.createElement(d.Toolbar,{variant:"dense"},e.label?o.createElement(d.Typography,{variant:"h6",id:"tableTitle",component:"div"},this.getText(e.label)):null,e.noDelete?null:o.createElement(d.IconButton,{size:"small",color:"primary",onClick:this.onAdd},o.createElement(P.Add,null))):null,t.map((s,i)=>o.createElement(d.Accordion,{key:`${s}_${i}`,expanded:this.state.activeIndex===i,onChange:(n,r)=>this.setState({activeIndex:r?i:-1})},o.createElement(d.AccordionSummary,{expandIcon:o.createElement(P.ExpandMore,null),sx:D.Utils.getStyle(this.props.oContext.theme,ae.fullWidth,ae.accordionSummary)},o.createElement(d.Typography,{style:ae.accordionTitle},s[e.titleAttr])),o.createElement(d.AccordionDetails,{style:{...e.style,...this.props.oContext.themeType?e.darkStyle:void 0}},this.itemAccordion(t[i],i),o.createElement(d.Toolbar,{sx:ae.toolbar},i?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move up"),slotProps:{popper:{sx:ae.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveUp(i)},o.createElement(P.ArrowUpward,null))):o.createElement("div",{style:ae.buttonEmpty}),i<t.length-1?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move down"),slotProps:{popper:{sx:ae.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveDown(i)},o.createElement(P.ArrowDownward,null))):o.createElement("div",{style:ae.buttonEmpty}),e.noDelete?null:o.createElement(d.Tooltip,{title:D.I18n.t("ra_Delete current row"),slotProps:{popper:{sx:ae.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onDelete(i)},o.createElement(P.Delete,null))),e.clone?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Clone current row"),slotProps:{popper:{sx:ae.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onClone(i)},o.createElement(P.ContentCopy,null))):null)))),!e.noDelete&&t.length>0?o.createElement(d.Toolbar,{variant:"dense",sx:ae.rootTool},o.createElement(d.IconButton,{size:"small",color:"primary",onClick:this.onAdd},o.createElement(P.Add,null))):null,e.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null):null}}const lt={root:{width:"100%"},notAlive:{color:"#a30000"}};class cs extends b{componentDidMount(){super.componentDidMount();const e=this.getInstance();this.props.oContext.socket.getState(`${e}.alive`).then(t=>this.setState({alive:!!(t&&t.val),instance:e}))}getInstance(){let e=this.props.schema.instance||`${this.props.oContext.adapterName}.${this.props.oContext.instance}`;return e.includes("${")&&(e=this.getPattern(e,null,!0)),e&&!e.startsWith("system.adapter.")&&(e=`system.adapter.${e}`),e}renderItem(){if(this.getInstance()!==this.state.instance&&setTimeout(()=>{const t=this.getInstance();t?this.props.oContext.socket.getState(`${t}.alive`).then(s=>this.setState({alive:!!(s&&s.val),instance:t})):this.setState({alive:null,instance:t})},200),this.state.alive!==!1&&this.state.alive!==!0)return null;const e=this.state.instance.replace(/^system.adapter./,"");return o.createElement("div",{style:{...lt.root,...this.state.alive?void 0:lt.notAlive}},this.state.alive?this.props.schema.textAlive!==void 0?this.props.schema.textAlive?D.I18n.t(this.props.schema.textAlive,e):"":D.I18n.t("ra_Instance %s is alive",e):this.props.schema.textNotAlive!==void 0?this.props.schema.textNotAlive?D.I18n.t(this.props.schema.textNotAlive,e):"":D.I18n.t("ra_Instance %s is not alive",e))}}class hs extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr),t=this.props.schema.options.map(s=>typeof s=="string"?{label:s,value:s}:JSON.parse(JSON.stringify(s)));Array.isArray(e)?(t.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),this.setState({value:b.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})}renderItem(e,t){if(!this.state.selectOptions)return null;let s;const i=JSON.parse(JSON.stringify(this.state.selectOptions));return Array.isArray(this.state.value)||this.state.value===b.DIFFERENT_VALUE?([...this.state.value].filter(r=>!i.find(a=>typeof a=="object"?a.value===r:a===r)).forEach(r=>i.push({label:r.toString(),value:r})),s={label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE},i.unshift(s)):(s=this.state.value!==null&&this.state.value!==void 0&&i.find(r=>typeof r=="object"?r.value==this.state.value:r==this.state.value),this.state.value!==null&&this.state.value!==void 0&&!s&&this.props.schema.freeSolo&&(s={value:this.state.value,label:this.state.value},i.push(s))),o.createElement(d.Autocomplete,{fullWidth:!0,freeSolo:!!this.props.schema.freeSolo,value:s,options:i,isOptionEqualToValue:(r,a)=>r.value===a.value,filterOptions:(r,a)=>{const l=r.filter(c=>a.inputValue===""?!0:c.label.toLowerCase().includes(a.inputValue.toLowerCase())||c.value.toLowerCase().includes(a.inputValue.toLowerCase()));return this.props.schema.freeSolo&&a.inputValue!==""&&l.push({label:a.inputValue,value:a.inputValue}),l},onInputChange:r=>{if(!r||!this.props.schema.freeSolo)return;const a=r.target.value;a!==this.state.value&&this.setState({value:a},()=>this.onChange(this.props.attr,a))},onChange:(r,a)=>{const l=typeof a=="object"?a?a.value:"":a;l!==this.state.value&&this.setState({value:l},()=>this.onChange(this.props.attr,l))},getOptionLabel:r=>typeof r=="object"?(r==null?void 0:r.label)??"":"",renderInput:r=>o.createElement(d.TextField,{variant:"standard",...r,error:!!e,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:t})})}}class ps extends b{initialized=!1;localContext;askInstance(){const e=b.getValue(this.props.data,this.props.attr),t=this.props.schema.options?this.props.schema.options.map(s=>typeof s=="string"?{label:s,value:s}:JSON.parse(JSON.stringify(s))):[];if(this.props.alive){let s=this.props.schema.data;if(s===void 0&&this.props.schema.jsonData){const i=this.getPattern(this.props.schema.jsonData,null,!0);try{typeof i=="string"&&(s=JSON.parse(i))}catch{console.error(`Cannot parse json data: ${JSON.stringify(s)}`)}}s===void 0&&(s=null),this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.command||"send",s).then(i=>{i&&Array.isArray(i)&&i.forEach(n=>t.push(typeof n=="string"?{label:n,value:n}:JSON.parse(JSON.stringify(n)))),Array.isArray(e)?(t.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),this.setState({value:b.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})})}else Array.isArray(e)?(t.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),this.setState({value:b.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=b.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(e,t){if(this.props.alive){const r=this.getContext();(r!==this.localContext||!this.initialized)&&(this.localContext=r,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}let s;const i=this.state.selectOptions?JSON.parse(JSON.stringify(this.state.selectOptions)):[];return Array.isArray(this.state.value)||this.state.value===b.DIFFERENT_LABEL?([...this.state.value].filter(r=>!i.find(a=>a.value===r)).forEach(r=>i.push({label:r.toString(),value:r})),s={label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE},i.unshift(s)):(s=this.state.value!==null&&this.state.value!==void 0&&i.find(r=>r.value==this.state.value),this.state.value!==null&&this.state.value!==void 0&&!s&&this.props.schema.freeSolo&&(s={value:this.state.value,label:this.state.value},i.push(s)),s=s||null),i.length?o.createElement(d.Autocomplete,{value:s,fullWidth:!0,freeSolo:!!this.props.schema.freeSolo,options:i,isOptionEqualToValue:(r,a)=>r.value===a.value,filterOptions:(r,a)=>{const l=r.filter(c=>a.inputValue===""?!0:c.label.toLowerCase().includes(a.inputValue.toLowerCase())||c.value.toLowerCase().includes(a.inputValue.toLowerCase()));return this.props.schema.freeSolo&&a.inputValue!==""&&l.push({label:a.inputValue,value:a.inputValue}),l},getOptionLabel:r=>(r==null?void 0:r.label)??"",onInputChange:r=>{if(!r||!this.props.schema.freeSolo)return;const a=r.target.value;a!==this.state.value&&this.setState({value:a},()=>this.onChange(this.props.attr,a))},onChange:(r,a)=>{const l=typeof a=="object"?a?a.value:"":a;l!==this.state.value&&this.setState({value:l},()=>this.onChange(this.props.attr,l))},renderInput:r=>o.createElement(d.TextField,{variant:"standard",...r,error:!!e,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:t})}):o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e,disabled:t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},onChange:r=>{const a=r.target.value;this.setState({value:a},()=>this.onChange(this.props.attr,(a||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const qe={fullWidth:{width:"100%"},flex:{display:"flex"},button:{height:48,marginLeft:4,minWidth:48}};class ds extends b{componentDidMount(){super.componentDidMount();const{data:e,attr:t}=this.props,s=b.getValue(e,t)||"";this.setState({value:s,showDialog:!1})}renderItem(e,t){const{schema:s,attr:i}=this.props,{value:n,showDialog:r}=this.state;return o.createElement(d.FormControl,{style:qe.fullWidth,variant:"standard"},s.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(s.label)):null,o.createElement("div",{style:qe.flex},o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:n??"",error:!!e,disabled:t,placeholder:this.getText(s.placeholder),label:this.getText(s.label),helperText:this.renderHelp(s.help,s.helpLink,s.noTranslation),onChange:a=>{const l=a.target.value;this.setState({value:l},()=>this.onChange(i,l))}}),o.createElement(d.Button,{color:"grey",disabled:t,style:qe.button,size:"small",variant:"outlined",onClick:()=>this.setState({showDialog:!0})},"...")),r?o.createElement(D.DialogCron,{title:D.I18n.t("ra_Define schedule"),simple:s.simple,complex:s.complex,cron:n,onClose:()=>this.setState({showDialog:!1}),cancel:D.I18n.t("ra_Cancel"),ok:D.I18n.t("ra_Ok"),theme:this.props.oContext.theme,onOk:a=>this.setState({showDialog:!1,value:a},()=>this.onChange(i,a))}):null)}}class ms extends b{async componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr),s=(await this.props.oContext.socket.getCertificates()).filter(i=>{const n=this.props.attr.toLowerCase();return n.includes(i.type)||i.type==="public"&&n.includes("cert")||i.type==="private"&&(n.includes("priv")||n.includes("key"))?!0:!!(i.type==="chained"&&(n.includes("chain")||n.includes("ca")))}).map(i=>({label:i.name,value:i.name}));s.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),this.setState({value:e,selectOptions:s})}renderItem(e,t){var i,n;if(!this.state.selectOptions)return null;const s=(i=this.state.selectOptions)==null?void 0:i.find(r=>r.value===this.state.value);return o.createElement(d.FormControl,{style:{width:"100%"},variant:"standard"},this.props.schema.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:this.state.value,renderValue:()=>this.getText(s==null?void 0:s.label,this.props.schema.noTranslation!==!1),onChange:r=>this.setState({value:r.target.value},()=>this.onChange(this.props.attr,this.state.value))},(n=this.state.selectOptions)==null?void 0:n.map(r=>o.createElement(d.MenuItem,{key:r.value,value:r.value,style:r.value===b.NONE_VALUE?{opacity:.5}:{}},this.getText(r.label,this.props.schema.noTranslation!==!1)))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Fe={fullWidth:{width:"100%"},leWidth:{width:620,marginBottom:10},certWidth:{width:200,marginRight:10}};class fs extends b{async componentDidMount(){var a;super.componentDidMount();const e=await this.props.oContext.socket.getCertificates(),t=[],s=[],i=[];let n=[];const r=await this.props.oContext.socket.getObject("system.certificates");(a=r==null?void 0:r.native)!=null&&a.collections?n=Object.keys(r.native.collections):n=null,e.forEach(l=>{l.type==="public"?t.push({label:l.name,value:l.name}):l.type==="private"?s.push({label:l.name,value:l.name}):l.type==="chained"?i.push({label:l.name,value:l.name}):(t.push({label:l.name,value:l.name}),s.push({label:l.name,value:l.name}),i.push({label:l.name,value:l.name}))}),t.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),s.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),i.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),this.setState({certsPublicOptions:t,certsChainOptions:i,certsPrivateOptions:s,collectionsOptions:n})}renderItem(e,t){var u,m,y,_,T,A,w;if(!this.state.certsPublicOptions||!this.state.certsPrivateOptions||!this.state.certsChainOptions)return null;const s=(b.getValue(this.props.data,this.props.schema.leCollectionName||"leCollection")||"false").toString(),i=b.getValue(this.props.data,this.props.schema.certPublicName||"certPublic"),n=b.getValue(this.props.data,this.props.schema.certPrivateName||"certPrivate"),r=b.getValue(this.props.data,this.props.schema.certChainedName||"certChained"),a=(u=this.state.certsPublicOptions)==null?void 0:u.find(F=>F.value===i),l=(m=this.state.certsPrivateOptions)==null?void 0:m.find(F=>F.value===n),c=(y=this.state.certsChainOptions)==null?void 0:y.find(F=>F.value===r);return o.createElement("div",{style:Fe.fullWidth},this.state.collectionsOptions?o.createElement(d.FormControl,{style:Fe.leWidth,variant:"standard"},o.createElement(d.InputLabel,{shrink:!0},"Let's encrypt"),o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:s,onChange:F=>this.onChange(this.props.schema.leCollectionName||"leCollection",F.target.value==="false"?!1:F.target.value==="true"?!0:F.target.value)},o.createElement(d.MenuItem,{key:"_false",value:"false",style:{fontWeight:"bold"}},D.I18n.t("ra_Do not use let's encrypt")),o.createElement(d.MenuItem,{key:"_true",value:"true",style:{fontWeight:"bold"}},D.I18n.t("ra_Use all available let's encrypt certificates")),(_=this.state.collectionsOptions)==null?void 0:_.map(F=>o.createElement(d.MenuItem,{key:F,value:F},F)))):null,this.state.collectionsOptions?o.createElement("br",null):null,this.state.collectionsOptions&&s!=="false"?o.createElement("div",null,D.I18n.t("ra_Fallback custom certificates")):null,o.createElement(d.FormControl,{style:Fe.certWidth,variant:"standard"},o.createElement(d.InputLabel,{shrink:!0},D.I18n.t("ra_Public certificate")),o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:i||"",renderValue:()=>this.getText(a==null?void 0:a.label),onChange:F=>this.onChange(this.props.schema.certPublicName||"certPublic",F.target.value)},(T=this.state.certsPublicOptions)==null?void 0:T.map((F,S)=>o.createElement(d.MenuItem,{key:`${F.value}_${S}`,value:F.value,style:F.value===b.NONE_VALUE?{opacity:.5}:{}},this.getText(F.label))))),o.createElement(d.FormControl,{style:Fe.certWidth,variant:"standard"},o.createElement(d.InputLabel,{shrink:!0},D.I18n.t("ra_Private certificate")),o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:n||"",renderValue:()=>this.getText(l==null?void 0:l.label),onChange:F=>this.onChange(this.props.schema.certPrivateName||"certPrivate",F.target.value)},(A=this.state.certsPrivateOptions)==null?void 0:A.map((F,S)=>o.createElement(d.MenuItem,{key:`${F.value}_${S}`,value:F.value,style:F.value===b.NONE_VALUE?{opacity:.5}:{}},this.getText(F.label))))),o.createElement(d.FormControl,{style:Fe.certWidth,variant:"standard"},o.createElement(d.InputLabel,{shrink:!0},D.I18n.t("ra_Chained certificate")),o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:r||"",renderValue:()=>this.getText(c==null?void 0:c.label),onChange:F=>this.onChange(this.props.schema.certChainedName||"certChained",F.target.value)},(w=this.state.certsChainOptions)==null?void 0:w.map((F,S)=>o.createElement(d.MenuItem,{key:`${F.value}_${S}`,value:F.value,style:F.value===b.NONE_VALUE?{opacity:.5}:{}},this.getText(F.label))))))}}class gs extends b{async componentDidMount(){var s;super.componentDidMount();let e;const t=await this.props.oContext.socket.getObject("system.certificates");(s=t==null?void 0:t.native)!=null&&s.collections?e=Object.keys(t.native.collections):e=[],this.setState({collectionsOptions:e})}renderItem(e,t){var i;if(!this.state.collectionsOptions)return null;const s=(b.getValue(this.props.data,this.props.schema.leCollectionName||"leCollection")||"false").toString();return o.createElement(d.FormControl,{style:{width:"100%"},variant:"standard"},this.props.schema.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:s,onChange:n=>this.onChange(this.props.schema.leCollectionName||"leCollection",n.target.value==="false"?!1:n.target.value==="true"?!0:n.target.value)},o.createElement(d.MenuItem,{key:"_false",value:"false",style:{fontWeight:"bold"}},D.I18n.t("ra_Do not use let's encrypt")),o.createElement(d.MenuItem,{key:"_true",value:"true",style:{fontWeight:"bold"}},D.I18n.t("ra_Use all available let's encrypt certificates")),(i=this.state.collectionsOptions)==null?void 0:i.map(n=>o.createElement(d.MenuItem,{key:n,value:n},n))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const re={fullWidth:{width:"100%"},licLabel:{fontWeight:"bold",minWidth:100,marginRight:10,textTransform:"capitalize",display:"inline-block"},errorTitle:h=>({color:h.palette.mode==="dark"?"#e39191":"#b62020"}),okTitle:h=>({color:h.palette.mode==="dark"?"#6fd56f":"#007c00"}),errorText:h=>({color:h.palette.mode==="dark"?"#e39191":"#b62020",mb:"30px"})};class Ce extends b{componentDidMount(){super.componentDidMount(),this.setState({_error:"",running:!1,showLicenseData:null,foundSuitableLicense:!1,licenseOfflineCheck:!1,result:null,allLicenses:null,askForUpdate:!1,showLinkToProfile:!1})}renderErrorDialog(){if(this.state._error&&!this.state.showLicenseData){let e=this.state._error;return this.state.allLicenses&&(e=[o.createElement("div",{key:"error"},e)],e.push(o.createElement(d.Button,{key:"button",variant:"contained",onClick:()=>window.open("https://iobroker.net/www/account/licenses","_blank")},D.I18n.t("iobroker.net"))),this.state.allLicenses.length?e.push(o.createElement(d.TableContainer,{key:"table"},o.createElement(d.Table,{size:"small"},o.createElement(d.TableHead,null,o.createElement(d.TableRow,null,o.createElement(d.TableCell,null,D.I18n.t("ra_Product")),o.createElement(d.TableCell,null,D.I18n.t("ra_Version")),o.createElement(d.TableCell,null,"UUID"),o.createElement(d.TableCell,null,D.I18n.t("ra_ValidTill")),o.createElement(d.TableCell,null,D.I18n.t("ra_Commercial")),o.createElement(d.TableCell,null,"ID"))),o.createElement(d.TableBody,null,this.state.allLicenses.map(t=>o.createElement(d.TableRow,{key:t.id},o.createElement(d.TableCell,{sx:t.validName?null:re.errorText},t.license.product),o.createElement(d.TableCell,{sx:t.validVersion?null:re.errorText},t.license.version),o.createElement(d.TableCell,{sx:t.validUuid?null:re.errorText},t.license.uuid||"--"),o.createElement(d.TableCell,{sx:t.validTill?null:re.errorText},t.license.validTill&&t.license.validTill!=="0000-00-00 00:00:00"?new Date(t.license.validTill).toLocaleDateString():"--"),o.createElement(d.TableCell,null,t.license.invoice!=="free"?t.license.invoice==="MANUALLY_CREATED"?"✓":t.license.invoice:"-"),o.createElement(d.TableCell,null,t.id))))))):(e.push(o.createElement("div",{key:"text1"},D.I18n.t("ra_No one license found in license manager"))),e.push(o.createElement("div",{key:"text2"},D.I18n.t("ra_Please create license"))))),o.createElement(d.Dialog,{open:!0,maxWidth:"xl",fullWidth:this.props.fullWidth!==void 0?this.props.fullWidth:!0,onClick:()=>this.setState({_error:"",allLicenses:null})},o.createElement(d.DialogTitle,null,D.I18n.t("ra_Error")),o.createElement(d.DialogContent,null,o.createElement(d.DialogContentText,null,e)),o.createElement(d.DialogActions,null,o.createElement(d.Button,{variant:"contained",onClick:()=>this.setState({_error:"",allLicenses:null}),color:"primary",autoFocus:!0,startIcon:o.createElement(P.Check,null)},D.I18n.t("ra_Ok"))))}return null}renderMessageDialog(){if(this.state.showLicenseData){const e=[],t=this.state.showLicenseData;return Object.keys(t).forEach(s=>{if(!(t[s]===null||t[s]===void 0))if(typeof t[s]=="object"){const i=t[s];Object.keys(i).forEach(n=>{i[n]!==null&&i[n]!==void 0&&(typeof i[n]=="object"?e.push(o.createElement("div",{key:n},o.createElement("div",{style:re.licLabel},n,":"),JSON.stringify(i[n],null,2))):e.push(o.createElement("div",{key:n},o.createElement("div",{style:re.licLabel},s," -",n,":"),i[n].toString())))})}else e.push(o.createElement("div",{key:s},o.createElement("div",{style:re.licLabel},s.replace(/_/g," "),":"),t[s].toString()))}),e.push(o.createElement("div",{key:"checked"},o.createElement("div",{style:re.licLabel},D.I18n.t("ra_Checked"),":"),this.state.licenseOfflineCheck?D.I18n.t("ra_locally"):D.I18n.t("ra_via internet"))),o.createElement(d.Dialog,{open:!0,onClose:()=>this.setState({showLicenseData:null})},o.createElement(d.DialogTitle,null,o.createElement(d.Box,{component:"span",sx:this.state.result?re.okTitle:re.errorTitle},D.I18n.t("ra_License %s",this.state.result?"OK":"INVALID"))),o.createElement(d.DialogContent,null,this.state.showLinkToProfile?o.createElement(d.Button,{variant:"contained",onClick:()=>window.open("https://iobroker.net/www/account/licenses","_blank")},"https://iobroker.net"):null,this.state._error?o.createElement(d.Box,{component:"div",sx:re.errorText},this.state._error):null,e),o.createElement(d.DialogActions,null,o.createElement(d.Button,{onClick:()=>this.setState({showLicenseData:null,_error:""}),color:"primary",variant:"contained"},D.I18n.t("ra_Close"))))}return null}static parseJwt(e){const s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(s).split("").map(n=>`%${`00${n.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));try{return JSON.parse(i)}catch{return null}}static isVersionValid(e,t,s,i){if(!t||!e)return!0;let n=!0;const[r]=e.split(".");return t.startsWith(">=")?n=parseInt(r,10)>=parseInt(t.substring(2,10)):t.startsWith("<=")?n=parseInt(r,10)<=parseInt(t.substring(2,10)):t.startsWith(">")?n=parseInt(r,10)>parseInt(t.substring(1,10)):t.startsWith("<")?n=parseInt(r,10)<parseInt(t.substring(1,10)):t.startsWith("=")?n=parseInt(r,10)===parseInt(t.substring(1,10)):t.startsWith("==")?n=parseInt(r,10)===parseInt(t.substring(2,10)):t.startsWith("===")&&(n=parseInt(r,10)===parseInt(t.substring(3,10))),!0}async findInLicenseManager(e){var i,n,r,a;const t=await this.props.oContext.socket.getObject("system.licenses"),s=[];if((n=(i=t==null?void 0:t.native)==null?void 0:i.licenses)!=null&&n.length){let l=null;const c=Date.now();let u;if(this.props.schema.uuid){const y=await this.props.oContext.socket.getObject("system.meta.uuid");u=(r=y==null?void 0:y.native)==null?void 0:r.uuid}let m;if(this.props.schema.version){const y=await this.props.oContext.socket.getObject(`system.adapter.${e}`);m=(a=y==null?void 0:y.common)==null?void 0:a.version}t.native.licenses.forEach(y=>{const _=!y.validTill||y.validTill==="0000-00-00 00:00:00"||new Date(y.validTill).getTime()>c,T=(y.product||"").split("."),A=T[1]===e||e==="vis-2"&&T[1]==="vis",w=!u||!y.uuid||y.uuid===u,F=Ce.isVersionValid(m,y.version,y.invoice,e);(!l||y.invoice!=="free")&&_&&A&&w&&F&&(l=y),s.push({id:y.id,validName:A,validUuid:w,validVersion:F,validTill:_,license:y})}),l&&(s.find(y=>y.id===l.id).used=!0)}return s}async checkLicense(e,t){var a,l,c;let s;if(this.props.schema.uuid){const u=await this.props.oContext.socket.getObject("system.meta.uuid");s=(a=u==null?void 0:u.native)==null?void 0:a.uuid}let i;if(this.props.schema.version){const u=await this.props.oContext.socket.getObject(`system.adapter.${t}`);i=(l=u==null?void 0:u.common)==null?void 0:l.version}const n=new AbortController;let r=setTimeout(()=>{r=null,n.abort()},5e3);try{const u=await window.fetch("https://iobroker.net/api/v1/public/cert/",{method:"POST",body:JSON.stringify({json:e,uuid:s}),headers:{"Content-Type":"text/plain"},signal:n.signal});r&&clearTimeout(r);const m=await u.text();let y;try{y=JSON.parse(m)}catch{}if(y!=null&&y.error)try{const _=Ce.parseJwt(e),T=D.I18n.t(`ra_${_.error||y.error||"Unknown error"}`).replace(/^ra_/,"");return this.setState({_error:T,licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1})}catch{return console.log("Cannot parse license"),this.setState({_error:y.error,result:!1,running:!1})}else{let _=null;try{_=Ce.parseJwt(e)}catch{}if(y){const T=y.validTill||y.valid_till;if(T&&T!=="0000-00-00 00:00:00"&&new Date(T).getTime()<Date.now())return this.setState({_error:D.I18n.t("ra_License expired on %s",new Date(T).toLocaleString()),licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1});const A=(y.name||"").split(".");return A[1]===t||A[1]==="vis"&&t==="vis-2"?s&&!y.uuid&&t==="vis-2"?this.setState({_error:D.I18n.t("ra_License must be converted",y.uuid),showLinkToProfile:!0,licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1}):s&&y.uuid&&y.uuid!==s?this.setState({_error:D.I18n.t('ra_Serial number (UUID) "%s" in license is for other device.',y.uuid),licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1}):Ce.isVersionValid(i,y.version,y.invoice,t)?this.setState({licenseOfflineCheck:!1,showLicenseData:_,result:!0,running:!1}):this.setState({_error:D.I18n.t("ra_License is for version %s, but required version is %s",y.version,this.props.schema.version),licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1}):this.setState({_error:D.I18n.t('ra_License for other product "%s"',y.name),licenseOfflineCheck:!1,showLicenseData:_,result:!1,running:!1})}throw new Error("ra_Invalid answer from server")}}catch(u){if(((c=u==null?void 0:u.response)==null?void 0:c.status)===404)return this.setState({_error:D.I18n.t("ra_License does not exist"),result:!1,running:!1});try{const m=Ce.parseJwt(e),y=(m.name||"").split(".");return m.valid_till&&m.valid_till!=="0000-00-00 00:00:00"&&new Date(m.valid_till).getTime()<Date.now()?this.setState({_error:D.I18n.t("ra_License expired on %s",new Date(m.valid_till).toLocaleString()),showLicenseData:m,licenseOfflineCheck:!0,running:!1,result:!1}):y[1]===t?s&&m.uuid&&m.uuid!==s?this.setState({_error:D.I18n.t('ra_Serial number (UUID) "%s" in license is for other device.',m.uuid),showLicenseData:m,licenseOfflineCheck:!0,result:!1,running:!1}):Ce.isVersionValid(i,m.version,m.invoice,t)?this.setState({running:!1,result:!0,licenseOfflineCheck:!0,showLicenseData:m}):this.setState({_error:D.I18n.t("ra_License is for version %s, but required version is %s",m.version,this.props.schema.version),licenseOfflineCheck:!0,showLicenseData:m,result:!1,running:!1}):this.setState({_error:D.I18n.t('ra_License for other product "%s"',m.name),licenseOfflineCheck:!0,showLicenseData:m,result:!1,running:!1})}catch{return this.setState({_error:D.I18n.t("ra_Cannot decode license"),result:!1,licenseOfflineCheck:!0,running:!1})}}}renderAskForUpdate(){return this.state.askForUpdate?o.createElement(D.DialogConfirm,{text:D.I18n.t("ra_License not found in license manager. Do you want to read licenses from iobroker.net?"),ok:D.I18n.t("ra_Yes"),onClose:async e=>{if(e){this.setState({askForUpdate:!1});try{await this.props.oContext.socket.updateLicenses(null,null)}catch(t){window.alert(D.I18n.t("ra_Cannot read licenses: %s",t));return}await this._onClick(!0)}else this.setState({askForUpdate:!1,running:!1})}}):null}async _onClick(e){const t=this.props.oContext.adapterName==="vis-2"?"vis":this.props.oContext.adapterName;this.setState({running:!0});let s,i;if(this.props.data.useLicenseManager){if(i=await this.findInLicenseManager(t),s=i.find(n=>n.used),s&&(s=s.license.json),!s&&!e){this.setState({askForUpdate:!0});return}}else s=this.props.data.license;s?await this.checkLicense(s,t):this.props.data.useLicenseManager?this.setState({_error:D.I18n.t("ra_Suitable license not found in license manager"),result:!1,running:!1,allLicenses:i}):this.setState({_error:D.I18n.t("ra_Please enter the license"),result:!1,running:!1})}renderItem(){return o.createElement("div",{style:re.fullWidth},o.createElement(d.Button,{variant:this.props.schema.variant||"outlined",color:this.props.schema.color||"primary",style:re.fullWidth,disabled:!this.props.data.license&&!this.props.data.useLicenseManager||this.state.running,startIcon:o.createElement(P.Send,null),onClick:()=>this._onClick()},this.state.running?o.createElement(d.CircularProgress,{size:20,style:{marginRight:8}}):null,this.getText(this.props.schema.label||"ra_Check license",this.props.schema.noTranslation)),this.renderMessageDialog(),this.renderErrorDialog(),this.renderAskForUpdate())}}class Ds extends b{renderItem(e,t){const s=b.getValue(this.props.data,this.props.attr),i=Array.isArray(s);return o.createElement(d.FormControl,{style:{width:"100%"},variant:"standard"},o.createElement(d.FormControlLabel,{onClick:n=>{if(n.preventDefault(),n.stopPropagation(),!t){const r=this.onChange(this.props.attr,!s);r instanceof Promise&&r.catch(a=>console.error(`Cannot set value: ${a}`))}},control:o.createElement(d.Checkbox,{indeterminate:i,checked:!!s,onChange:n=>{let r;i?r=this.onChange(this.props.attr,!0):r=this.onChange(this.props.attr,n.target.checked),r instanceof Promise&&r.catch(a=>console.error(`Cannot set value: ${a}`))},disabled:t||this.props.schema.readOnly}),label:this.getText(this.props.schema.label)}),o.createElement(d.FormHelperText,{style:{color:"red"}},e?this.props.schema.validatorErrorText?D.I18n.t(this.props.schema.validatorErrorText):D.I18n.t("ra_Error"):null),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Cs={standard:d.Input,filled:Mt,outlined:d.OutlinedInput},ys=h=>{const e=h.palette.mode==="light",t=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{},inputRoot:{display:"inline-flex",flexWrap:"wrap",flex:1,marginTop:0,minWidth:70,"&.mui-variant-outlined,&.mui-variant-filled":{boxSizing:"border-box"},"&.mui-variant-outlined":{paddingTop:"14px"},"&.mui-variant-filled":{paddingTop:"28px"}},input:{display:"inline-block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",appearance:"none",WebkitTapHighlightColor:"rgba(0,0,0,0)",float:"left",flex:1},chipContainer:{display:"flex",flexFlow:"row wrap",alignItems:"center",cursor:"text",marginBottom:"-2px",minHeight:40},outlined:{"& input":{height:16,paddingTop:"4px",paddingBottom:"12px",marginTop:"4px",marginBottom:"4px"}},standard:{marginTop:"18px"},filled:{"& input":{height:22,marginBottom:"4px",marginTop:"4px",paddingTop:0},"$marginDense & input":{height:26}},labeled:{},label:{top:4,"&$outlined&:not($labelShrink)":{top:2,"$marginDense &":{top:5}},"&$filled&:not($labelShrink)":{top:15,"$marginDense &":{top:20}}},labelShrink:{top:0},helperText:{marginBottom:-20},focused:{},disabled:{},underline:{"&:after":{borderBottom:`2px solid ${h.palette.primary[e?"dark":"light"]}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:h.transitions.create("transform",{duration:h.transitions.duration.shorter,easing:h.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:h.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:h.transitions.create("border-bottom-color",{duration:h.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:`2px solid ${h.palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{"&:after":{backgroundColor:h.palette.error.main,transform:"scaleX(1)"}},chip:{margin:"0 8px 8px 0",float:"left"},marginDense:{}}},$e={BACKSPACE:8,DELETE:46,LEFT_ARROW:37,RIGHT_ARROW:39},vs=({value:h,isFocused:e,isDisabled:t,isReadOnly:s,handleClick:i,handleDelete:n,style:r},a)=>o.createElement(d.Chip,{key:a,style:{...r,pointerEvents:t||s?"none":void 0,backgroundColor:e?Vt[300]:void 0},onClick:i,onDelete:n,label:h});class Es extends o.Component{labelRef;labelNode=null;input;newChipKeyCodes;newChipKeys;actualInput=null;inputBlurTimeout=null;_keyPressed;_preventChipCreation;styles={};styleTheme=null;constructor(e){super(e),this.state={chips:e.defaultValue||[],focusedChip:null,inputValue:"",isFocused:!1,chipsUpdated:!1,prevPropsValue:[],variant:this.props.variant||"standard"},this.newChipKeyCodes=e.newChipKeyCodes||[13],this.newChipKeys=e.newChipKeys||["Enter"],this.labelRef=o.createRef(),this.input=o.createRef()}componentDidMount(){this.state.variant==="outlined"&&(this.labelNode=Rt.findDOMNode(this.labelRef.current),this.forceUpdate())}componentWillUnmount(){this.inputBlurTimeout&&clearTimeout(this.inputBlurTimeout)}static getDerivedStateFromProps(e,t){let s=null;return e.value&&e.value.length!==t.prevPropsValue.length&&(s={prevPropsValue:e.value},e.clearInputValueOnChange&&(s.inputValue="")),e.clearInputValueOnChange&&e.value&&e.value.length!==t.prevPropsValue.length&&(s={prevPropsValue:e.value,inputValue:""}),e.disabled&&(s={...s,focusedChip:null}),!t.chipsUpdated&&e.defaultValue&&(s={...s,chips:e.defaultValue}),s}focus=()=>{var e;(e=this.actualInput)==null||e.focus(),this.state.focusedChip&&this.setState({focusedChip:null})};handleInputBlur=e=>{this.props.onBlur&&this.props.onBlur(e),this.setState({isFocused:!1}),this.state.focusedChip&&this.setState({focusedChip:null});const t=e.target.value;let s;switch(this.props.blurBehavior||"clear"){case"add-or-clear":s={clearInputOnFail:!0};case"add":if(this.props.delayBeforeAdd){const i=(this.props.value||this.state.chips).length;this.inputBlurTimeout=setTimeout(()=>{const n=(this.props.value||this.state.chips).length;i===n?this.handleAddChip(t,s):this.clearInput()},150)}else this.handleAddChip(t,s);break;case"clear":this.clearInput();break}};handleInputFocus=e=>{this.setState({isFocused:!0}),this.props.onFocus&&this.props.onFocus(e)};handleKeyDown=e=>{const{focusedChip:t}=this.state;if(this._keyPressed=!1,this._preventChipCreation=!1,this.props.onKeyDown&&(this.props.onKeyDown(e),e.isDefaultPrevented()))return;const s=this.props.value||this.state.chips;if(this.newChipKeyCodes.includes(e.keyCode)||this.newChipKeys.includes(e.key)){this.handleAddChip(e.target.value)!==!1&&e.preventDefault();return}switch(e.keyCode){case $e.BACKSPACE:e.target.value===""&&(t?(this.handleDeleteChip(s[t],t),t&&this.setState({focusedChip:t-1})):this.setState({focusedChip:s.length-1}));break;case $e.DELETE:e.target.value===""&&t&&(this.handleDeleteChip(s[t],t),t<=s.length-1&&this.setState({focusedChip:t}));break;case $e.LEFT_ARROW:t===null&&e.target.value===""&&s.length?this.setState({focusedChip:s.length-1}):t!==null&&t>0&&this.setState({focusedChip:t-1});break;case $e.RIGHT_ARROW:t!==null&&t<s.length-1?this.setState({focusedChip:t+1}):this.setState({focusedChip:null});break;default:this.setState({focusedChip:null});break}};handleKeyUp=e=>{!this._preventChipCreation&&(this.newChipKeyCodes.includes(e.keyCode)||this.newChipKeys.includes(e.key))&&this._keyPressed?this.clearInput():this.updateInput(e.target.value),this.props.onKeyUp&&this.props.onKeyUp(e)};handleUpdateInput=e=>{(this.props.inputValue===null||this.props.inputValue===void 0)&&this.updateInput(e.target.value),this.props.onUpdateInput&&this.props.onUpdateInput(e)};handleAddChip(e,t){if(this.props.onBeforeAdd&&!this.props.onBeforeAdd(e))return this._preventChipCreation=!0,t&&t.clearInputOnFail&&this.clearInput(),!1;this.clearInput();const s=this.props.value||this.state.chips;return e.trim().length?((this.props.allowDuplicates||!s.includes(e))&&(this.props.value&&this.props.onAdd?this.props.onAdd(e):this.updateChips([...this.state.chips,e])),!0):!1}handleDeleteChip(e,t){if(this.props.value)this.props.onDelete&&this.props.onDelete(e,t);else{const s=this.state.chips.slice();if(s.splice(t,1)){let n=this.state.focusedChip;this.state.focusedChip===t?n=null:this.state.focusedChip>t&&(n=this.state.focusedChip-1),this.updateChips(s,{focusedChip:n})}}}updateChips(e,t={}){this.setState({chips:e,chipsUpdated:!0,...t}),this.props.onChange&&this.props.onChange(e)}clearInput(){this.updateInput("")}updateInput(e){this.setState({inputValue:e})}setActualInputRef=e=>{this.actualInput=e,this.props.inputRef&&this.props.inputRef(e)};render(){const{alwaysShowPlaceholder:e,chipRenderer:t=vs,className:s,disabled:i,disableUnderline:n,error:r,FormHelperTextProps:a,fullWidth:l,fullWidthInput:c,helperText:u,id:m,InputProps:y={},InputLabelProps:_={},inputValue:T,label:A,placeholder:w,readOnly:F,required:S,rootRef:L,value:x,margin:C}=this.props,p=this.state.variant;this.styleTheme!==this.props.theme.palette.mode&&(this.styleTheme=this.props.theme.palette.mode,this.styles=D.Utils.getStyle(this.props.theme,ys));let g=x||this.state.chips||[];Array.isArray(g)||(g=(g||"").toString().split(/[,\s]+/).map(I=>I.trim()));const f=T??this.state.inputValue,v=(this.props.value||f).length||f.length,E=typeof _.shrink=="boolean"?_.shrink:A!==null&&(v||this.state.isFocused||g.length),B=g.map((I,k)=>t({value:I,isDisabled:!!i,isReadOnly:F,isFocused:this.state.focusedChip===k,handleClick:()=>this.setState({focusedChip:k}),handleDelete:()=>this.handleDeleteChip(I,k),style:this.styles.chip},k.toString())),$={};p==="outlined"&&($.notched=!!E,$.labelWidth=E&&this.labelNode&&this.labelNode.offsetWidth||0),p!=="standard"?$.startAdornment=B:y.disableUnderline=!0;const O=Cs[p];return o.createElement(d.FormControl,{ref:L,fullWidth:l,className:s,sx:{...this.styles.root,...C==="dense"?this.styles.marginDense:{}},error:r,required:g.length>0?void 0:S,onClick:this.focus,disabled:i,variant:p,component:"div",margin:C},A&&o.createElement(d.InputLabel,{htmlFor:m,sx:{"&.MuiInputLabel-root":this.styles.label,"&.MuiInputLabel-shrink":this.styles.labelShrink},shrink:!!E,focused:this.state.isFocused,variant:p,ref:this.labelRef,required:S,component:"label",..._},A),o.createElement(d.Box,{component:"div",id:"input-chip-container",sx:{...this.styles[p],...this.styles.chipContainer,...this.state.isFocused?this.styles.focused:void 0,...!n&&p==="standard"?this.styles.underline:void 0,...i?this.styles.disabled:void 0,...A?this.styles.labeled:void 0,...r?this.styles.error:void 0}},p==="standard"&&B,o.createElement(O,{ref:this.input,className:`mui-variant-${this.styles[p]} ${A?"mui-chip-with-label":"mui-chip-no-label"}`,sx:{"&.MuiInputBase-input":{...this.styles.input,...this.styles[p]},"&.MuiInputBase-root":{...this.styles.inputRoot}},id:m,value:f,onChange:this.handleUpdateInput,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,inputRef:this.setActualInputRef,disabled:i,fullWidth:c,placeholder:!v&&(E||A===null||A===void 0)||e?w:null,readOnly:F,...y,...$})),u&&o.createElement(d.FormHelperText,{...a,className:a==null?void 0:a.className,style:this.styles.helperText},u))}}class ut extends b{componentDidMount(){super.componentDidMount();const{data:e,attr:t}=this.props,s=b.getValue(e,t);if(this.props.schema.delimiter&&typeof s=="string"){const i=s.split(this.props.schema.delimiter).map(n=>n.trim()).filter(n=>n);this.setState({value:i})}else this.setState({value:s||[]})}renderItem(e,t){const{attr:s,schema:i}=this.props,{value:n}=this.state;return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},o.createElement(Es,{value:n,disabled:!!t,label:this.getText(i.label),error:!!e,onAdd:r=>{const a=JSON.parse(JSON.stringify(n));a.push(r),this.setState({value:a},()=>{let l;this.props.schema.delimiter?l=this.onChange(s,a.join(`${this.props.schema.delimiter} `)):l=this.onChange(s,a),l instanceof Promise&&l.catch(c=>console.error(c))})},theme:this.props.oContext.theme,onDelete:(r,a)=>{const l=JSON.parse(JSON.stringify(n));l.splice(a,1),this.setState({value:l},()=>{let c;this.props.schema.delimiter?c=this.onChange(s,l.join(`${this.props.schema.delimiter} `)):c=this.onChange(s,l),c instanceof Promise&&c.catch(u=>console.error(u))})}}),o.createElement(d.FormHelperText,null,D.I18n.t("ra_Press ENTER Key to add new item")),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}class bs extends b{renderColorDialog(){return!!this.state.showColorDialog&&o.createElement(d.Dialog,{onClose:()=>this.setState({showColorDialog:!1}),open:this.state.showColorDialog},o.createElement(Pt,{color:this.state.colorDialogValue,onChange:e=>this.setState({colorDialogValue:e.hex},()=>this.onChange(this.props.attr,this.state.colorDialogValue))}))}renderItem(e,t){const s=b.getValue(this.props.data,this.props.attr);let i=D.Utils.isUseBright(s,null);return i===null&&(i=void 0),o.createElement(o.Fragment,null,this.renderColorDialog(),o.createElement(d.TextField,{variant:"standard",disabled:!!t,style:{minWidth:100,width:"calc(100% - 8px)"},label:this.getText(this.props.schema.label),value:s||"",onClick:()=>!this.props.schema.readOnly&&this.setState({showColorDialog:!0,colorDialogValue:s||""}),onChange:n=>{const r=n.target.value,a=this.onChange(this.props.attr,r);a instanceof Promise&&a.catch(l=>console.error(`Cannot set value: ${l}`))},slotProps:{htmlInput:{style:{backgroundColor:s,color:i?"#FFF":"#000"},readOnly:this.props.schema.readOnly||!1},input:{endAdornment:!this.props.schema.readOnly&&s&&!this.props.schema.noClearButton?o.createElement(d.IconButton,{size:"small",onClick:n=>{n.stopPropagation();const r=this.onChange(this.props.attr,"");r instanceof Promise&&r.catch(a=>console.error(`Cannot set value: ${a}`))}},o.createElement(P.Close,null)):void 0},inputLabel:{shrink:!0}}}))}}const Ke={width:{width:"calc(100% - 85px)"},width50:{width:120,marginRight:5}};class xs extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e});const t={};this.props.schema.useSystemName&&(t.useSystem=!!b.getValue(this.props.data,this.props.schema.useSystemName)),this.props.schema.longitudeName&&this.props.schema.latitudeName?(t.longitude=b.getValue(this.props.data,this.props.schema.longitudeName),t.latitude=b.getValue(this.props.data,this.props.schema.latitudeName),!t.longitude&&!t.latitude&&this.props.schema.autoInit&&setTimeout(()=>this.getCoordinates(),300)):!b.getValue(this.props.data,this.props.attr)&&this.props.schema.autoInit&&setTimeout(()=>this.getCoordinates(),300),Object.keys(t).length&&setTimeout(()=>this.setState(t),50)}async getSystemCoordinates(){const e=await this.props.oContext.socket.getCompactSystemConfig();if(e!=null&&e.common&&(e.common.longitude||e.common.latitude))if(window.alert(D.I18n.t("ra_Used system settings")),this.props.schema.longitudeName&&this.props.schema.latitudeName)this.setState({longitude:e.common.longitude,latitude:e.common.latitude},async()=>{await this.onChange(this.props.schema.longitudeName,e.common.longitude),await this.onChange(this.props.schema.latitudeName,e.common.latitude)});else{const t=e.common.latitude+(this.props.schema.divider||",")+e.common.longitude;this.setState({value:t},()=>{const s=this.onChange(this.props.attr,t);s instanceof Promise&&s.catch(i=>console.error(`Cannot set value: ${i}`))})}else window.alert(D.I18n.t("ra_Cannot determine position: System settings are empty and GPS detection is disabled in browser"))}getCoordinates(){navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{if(e!=null&&e.coords)if(this.props.schema.longitudeName&&this.props.schema.latitudeName)this.setState({longitude:e.coords.longitude,latitude:e.coords.latitude},async()=>{await this.onChange(this.props.schema.longitudeName,e.coords.longitude||""),await this.onChange(this.props.schema.latitudeName,e.coords.latitude||"")});else{const t=e.coords.latitude+(this.props.schema.divider||",")+e.coords.longitude;this.setState({value:t},()=>{const s=this.onChange(this.props.attr,t);s instanceof Promise&&s.catch(i=>console.error(`Cannot set value: ${i}`))})}else await this.getSystemCoordinates()},async e=>{console.error(`Cannot determine coordinates from browser: ${e.message}`),await this.getSystemCoordinates()}):this.getSystemCoordinates().catch(e=>{console.error(`Cannot determine coordinates: ${e}`)})}renderItem(e,t){return o.createElement(o.Fragment,null,this.props.schema.useSystemName?o.createElement(d.FormControlLabel,{control:o.createElement(d.Checkbox,{checked:!!this.state.useSystem,onChange:s=>{const i=s.target.checked;i&&this.getSystemCoordinates().catch(n=>console.error(`Cannot determine coordinates: ${n}`)),this.setState({useSystem:i},()=>this.onChange(this.props.schema.useSystemName,i))}}),label:D.I18n.t("ra_Use system settings for position")}):null,this.props.schema.longitudeName&&this.props.schema.latitudeName?o.createElement(d.TextField,{variant:"standard",style:Ke.width50,value:this.state.longitude??"",error:!!e,disabled:this.state.useSystem||!!t,onChange:s=>{const i=s.target.value;this.setState({longitude:i},()=>{const n=this.onChange(this.props.schema.longitudeName,(i||"").trim());n instanceof Promise&&n.catch(r=>console.error(`Cannot set value: ${r}`))})},label:D.I18n.t("ra_Longitude")}):null,this.props.schema.longitudeName&&this.props.schema.latitudeName?o.createElement(d.TextField,{variant:"standard",style:Ke.width50,value:this.state.latitude??"",error:!!e,disabled:this.state.useSystem||!!t,onChange:s=>{const i=s.target.value;this.setState({latitude:i},()=>this.onChange(this.props.schema.latitudeName,(i||"").trim()))},label:D.I18n.t("ra_Latitude")}):null,!this.props.schema.longitudeName||!this.props.schema.latitudeName?o.createElement(d.TextField,{variant:"standard",style:Ke.width,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e,disabled:!!t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.state.useSystem}},onChange:s=>{const i=s.target.value;this.setState({value:i},()=>this.onChange(this.props.attr,(i||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}):null,this.state.useSystem?null:o.createElement(d.Fab,{size:"small",onClick:()=>this.getCoordinates(),title:D.I18n.t("ra_Take browser position"),style:{marginRight:4}},o.createElement(P.LocationOn,null)),this.state.useSystem?null:o.createElement(d.Fab,{size:"small",onClick:()=>this.getSystemCoordinates(),title:D.I18n.t("ra_Take position from system settings")},o.createElement(P.GpsFixed,null)))}}const ws=(h,e,t)=>new Promise((s,i)=>{if(window[h])s(window[h]);else{const n=document.querySelector(`script[data-webpack="${h}"]`),r=async()=>{if(window[h])window[h].__initialized||(typeof __webpack_share_scopes__>"u"?await window[h].init(e):await window[h].init(__webpack_share_scopes__[e]),window[h].__initialized=!0);else{console.error(`Cannot load ${h}`),i(new Error(`Cannot load ${h}`));return}s(window[h])};if(n)n.onload=r,n.onerror=i;else if(t){const a=document,l=a.createElement("script");l.type="text/javascript",l.setAttribute("data-webpack",`${h}`),l.async=!0,l.onerror=i,l.onload=r,l.src=t,a.getElementsByTagName("head")[0].appendChild(l)}else i(new Error(`Cannot Find Remote ${h} to inject`))}});function As(h,e,t,s){return async()=>(await(await ws(h,e,s)).get(t))()}class Ie extends b{static runningLoads={};constructor(e){super(e),Object.assign(this.state,{Component:null,error:""})}async componentDidMount(){if(!this.props.schema.url){console.error("URL is empty. Cannot load custom component!"),this.setState({error:"URL is empty. Cannot load custom component!"});return}let e;this.props.schema.url.startsWith("./")?e=`${window.location.protocol}//${window.location.host}${this.props.schema.url.replace(/^\./,"")}`:e=`${window.location.protocol}//${window.location.host}/adapter/${this.props.oContext.adapterName}/${this.props.schema.url}`;const[t,s,...i]=this.props.schema.name.split("/"),n=i.join("/");if(!e){console.error('Cannot find URL for custom component! Please define "url" as "custom/customComponents.js" in the schema');return}if(!t||!s||!n){console.error('Invalid format of "name"! Please define "name" as "ConfigCustomBackItUpSet/Components/AdapterExist" in the schema');return}let r=Ie.runningLoads[`${e}!${s}`];if(!(r instanceof Promise)){let a;if(this.props.schema.i18n===!0){const l=e.lastIndexOf("/");let c;l!==-1?c=e.substring(0,l):c=e;const u=D.I18n.getLanguage(),m=`${c}/i18n/${u}.json`;a=fetch(m).then(y=>y.json()).then(y=>D.I18n.extendTranslations(y,u)).catch(y=>{if(u!=="en"){fetch(`${c}/i18n/en.json`).then(_=>_.json()).then(_=>D.I18n.extendTranslations(_,u)).catch(_=>console.log(`Cannot load i18n "${m}": ${_}`));return}console.log(`Cannot load i18n "${m}": ${y}`)})}else if(this.props.schema.i18n&&typeof this.props.schema.i18n=="object")try{D.I18n.extendTranslations(this.props.schema.i18n)}catch(l){console.error(`Cannot import i18n: ${l}`)}try{console.log(t,s,n),r=As(t,"default",s.startsWith("http://")||s.startsWith("https://")||s.startsWith(".")?s:`./${s}`,e)(),a instanceof Promise&&(r=Promise.all([r,a]).then(l=>l[0])),Ie.runningLoads[`${e}!${s}`]=r}catch(l){this.setState({error:`Cannot import from ${this.props.schema.url}: ${l}`})}}try{const a=(await r).default;if(a!=null&&a[n])this.setState({Component:a[n]});else{const l=Object.keys(a||{});console.error("URL is empty. Cannot load custom component!"),this.setState({error:`Component ${this.props.schema.name} not found in ${this.props.schema.url}. Found: ${l.join(", ")}`})}}catch(a){this.setState({error:`Cannot import from ${this.props.schema.url}: ${a}`})}}render(){const e=this.state.Component,t=this.props.schema||{};let s=e?o.createElement(e,{...this.props,socket:this.props.oContext.socket,theme:this.props.oContext.theme,themeType:this.props.oContext.themeType,instance:this.props.oContext.instance,adapterName:this.props.oContext.adapterName,systemConfig:this.props.oContext.systemConfig,forceUpdate:this.props.oContext.forceUpdate}):this.state.error?o.createElement("div",null,this.state.error):o.createElement(d.LinearProgress,null);return t.newLine?o.createElement(o.Fragment,null,o.createElement("div",{style:{flexBasis:"100%",height:0}}),s):s}}const{loadShare:Fs}=It,{initPromise:Ss}=_t,Ts=Ss.then(h=>Fs("@mui/x-date-pickers",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),_s=await Ts.then(h=>h());var Ot=_s;class Is extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e})}renderItem(e,t){return o.createElement(Ot.DatePicker,{sx:s=>({width:"100%",borderBottom:`1px solid ${s.palette.text.primary}`,"& fieldset":{display:"none"},"& input":{padding:`${s.spacing(1.5)} 0 4px 0`},"& .MuiInputAdornment-root":{marginLeft:0,marginTop:1},"& label":{transform:"translate(0px, -9px) scale(0.75)"}}),format:this.props.oContext.systemConfig.dateFormat.toLowerCase().replace("mm","MM"),disabled:!!t,value:this.state.value,onChange:s=>{this.setState({value:s},()=>this.onChange(this.props.attr,this.state.value))},label:this.getText(this.props.schema.label)})}}class ks extends b{renderItem(){if(!this.props.schema)return null;if(this.props.oContext.DeviceManager){const t=this.props.oContext.DeviceManager;return o.createElement(t,{uploadImagesToInstance:`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,title:this.getText(this.props.schema.label),socket:this.props.oContext.socket,selectedInstance:`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,themeName:this.props.themeName,theme:this.props.oContext.theme,themeType:this.props.oContext.themeType,isFloatComma:this.props.oContext.isFloatComma,dateFormat:this.props.oContext.dateFormat})}return o.createElement("div",null,"DeviceManager not found")}}const le={fullWidth:{width:"100%"},uploadDiv:{position:"relative",width:"100%"},uploadDivDragging:{opacity:1,background:"rgba(128,255,128,0.1)"},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"100%",height:"100%",position:"absolute",display:"flex"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},disabledOpacity:{opacity:.3,cursor:"default"},error:{border:"2px solid red"},deleteButton:{},selectedImage:{height:40,width:40,display:"inline-block",marginRight:8}},Bs=["jpg","jpeg","svg","png","webp","gif","apng","avif","webp"],Os=["mp3","ogg","wav","aac"],$s=["avi","mp4","mov"],Ls=["txt","log","html","htm"],Ns=["json","js","ts"];class Ue extends b{dropzoneRef;imagePrefix;objectID;path;constructor(e){super(e),this.dropzoneRef=o.createRef(),this.imagePrefix=this.props.oContext.imagePrefix===void 0?"./files":this.props.oContext.imagePrefix}componentDidMount(){super.componentDidMount(),this.objectID=(this.props.schema.objectID||"0_userdata.0").replace("%INSTANCE%",(this.props.oContext.instance||0).toString()),this.path=this.props.schema.upload,this.path&&(this.path==="/"?this.path="":this.path.endsWith("/")||(this.path=`${this.path}/`)),this.updateFiles().then(()=>{const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e}),this.props.oContext.socket.subscribeFiles(this.objectID,`${this.path}/*`,this.onFolderChanged).catch(t=>console.error(`Cannot subscribe: ${t}`))})}onFolderChanged=(e,t)=>{this.path&&t.startsWith(this.path)&&this.updateFiles().catch(s=>console.error(`Cannot update files: ${s}`))};componentWillUnmount(){this.props.oContext.socket.subscribeFiles(this.objectID,`${this.path}/*`,this.onFolderChanged).catch(e=>console.error(`Cannot subscribe: ${e}`)),super.componentWillUnmount()}async updateFiles(){const e=await this.readFiles(this.props.schema.pattern);await new Promise(t=>this.setState({files:e},t))}async readFolder(e,t,s){try{const i=await this.props.oContext.socket.readDir(this.objectID,e.replace(/^\//,"")||null);for(let n=0;n<i.length;n++){const r=i[n];if(r.isDir)await this.readFolder(`${e+r.file}/`,t,s);else{let a=!1;s==="*.*"&&r.file.includes(".")||!s||s==="*"||s===".*"&&r.file.startsWith(".")?a=!0:a=new RegExp(`^${s.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(r.file),a&&t.push({name:e+r.file,size:r.stats?D.Utils.formatBytes(r.stats.size):"--"})}}}catch(i){console.error(`Cannot read "${e}": ${i}`)}return t}async readFiles(e){const t=[];e=e||this.props.schema.pattern,e||(e="**/*.*");let s;const i=e.lastIndexOf("/");if(i===-1?s=e:s=e.substring(i+1),e.startsWith("**"))await this.readFolder("/",t,s);else{const n=e.lastIndexOf("/");if(n===-1)await this.readFolder("/",t,s);else{const r=e.substring(0,n+1);await this.readFolder(r,t,s)}}return t}onDrop(e){const t=e[0],s=new FileReader,i=this.props.schema.maxSize||2*1024*1024;s.onabort=()=>console.log("file reading was aborted"),s.onerror=()=>console.log("file reading has failed"),s.onload=()=>{if(t.size>i){window.alert(D.I18n.t("File is too big. Max %sk allowed. Try use SVG.",Math.round(i/1024)));return}this.props.oContext.socket.writeFile64(this.objectID,this.path+t.name,s.result).then(()=>this.updateFiles()).then(()=>this.setState({value:this.path+t.name},()=>this.onChange(this.props.attr,this.path+t.name))).catch(n=>window.alert(`Cannot upload file: ${n}`))},s.readAsArrayBuffer(t)}renderDeleteDialog(){return this.state.deleteFile?o.createElement(D.DialogConfirm,{title:D.I18n.t("ra_Are you sure?"),text:D.I18n.t("ra_File will be deleted"),ok:D.I18n.t("ra_Delete"),cancel:D.I18n.t("ra_Cancel"),onClose:e=>{const t=this.state.deleteFile;this.setState({deleteFile:""},()=>{e&&this.props.oContext.socket.deleteFile(this.objectID,t).then(()=>this.updateFiles()).catch(s=>window.alert(`Cannot delete file: ${s}`))})}}):null}static base64ToArrayBuffer(e){const t=window.atob(e),s=t.length,i=new Uint8Array(s);for(let n=0;n<s;n++)i[n]=t.charCodeAt(n);return i.buffer}loadFile(){return this.props.oContext.socket.readFile(this.objectID,this.state.value,!0)}play(){this.loadFile().then(e=>{if(typeof AudioContext<"u"){const t=new AudioContext,s=Ue.base64ToArrayBuffer(e.file);t.decodeAudioData(s,i=>{const n=t.createBufferSource();n.buffer=i,n.connect(t.destination),n.start(0)},i=>window.alert(`Cannot play: ${i.message}`))}})}getFileIcon(e){return e!=null&&e.extension?Bs.includes(e.extension)?o.createElement("div",{style:{...le.selectedImage,backgroundImage:`url(${this.imagePrefix}/${this.objectID}/${e.value})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"}}):Os.includes(e.extension)?o.createElement(P.MusicNote,null):Ls.includes(e.extension)?o.createElement(P.Article,null):$s.includes(e.extension)?o.createElement(P.Videocam,null):Ns.includes(e.extension)?o.createElement(P.Code,null):null:null}renderItem(e,t){if(!this.state.files)return null;const s=[];this.props.schema.withFolder||this.state.files.forEach(u=>{const m=u.name.lastIndexOf("/");if(m===-1)s.includes("/")||s.push("/");else{const y=u.name.substring(0,m+1);s.includes(y)||s.push(y)}});const i=this.state.files.map(u=>({value:u.name,label:!this.props.schema.withFolder&&s.length===1?`${u.name.substring(s[0].length)}`:`${u.name}${this.props.schema.noSize?"":`(${u.size})`}`,extension:u.name.toLowerCase().split(".").pop()}));this.props.schema.noNone||i.unshift({label:D.I18n.t("ra_none"),value:""});const n=i.find(u=>u.value===this.state.value);let r=0;this.props.schema.upload&&r++,this.props.schema.refresh&&r++;const a=this.state.value&&(this.state.value.endsWith(".mp3")||this.state.value.endsWith(".ogg")||this.state.value.endsWith(".wav"));a&&r++;const l=o.createElement("div",{style:le.fullWidth},o.createElement(d.FormControl,{variant:"standard",style:{width:`calc(100% - ${r*42}px)`}},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>o.createElement(o.Fragment,null,this.getFileIcon(n),o.createElement("span",null,(n==null?void 0:n.label)||"")),onChange:u=>{this.setState({value:u.target.value==="_"?"":u.target.value},()=>this.onChange(this.props.attr,this.state.value))}},i.map(u=>o.createElement(d.MenuItem,{key:u.value,value:u.value},o.createElement(d.ListItemIcon,null,this.getFileIcon(u)),o.createElement(d.ListItemText,null,u.label),this.props.schema.delete&&n.value?o.createElement(d.IconButton,{style:le.deleteButton,size:"small",onClick:()=>this.setState({deleteFile:n.value})},o.createElement(P.Delete,null)):null))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null),this.props.schema.refresh&&o.createElement(d.IconButton,{onClick:()=>this.updateFiles()},o.createElement(P.Refresh,null)),this.props.schema.upload&&o.createElement(d.IconButton,{onClick:()=>{var u;return(u=this.dropzoneRef.current)==null?void 0:u.open()}},o.createElement(P.UploadFile,null)),a&&o.createElement(d.IconButton,{style:{color:"#00FF00"},onClick:()=>this.play()},o.createElement(P.PlayArrow,null)));if(!this.props.schema.upload)return o.createElement(o.Fragment,null,l,this.renderDeleteDialog());let c={"*/*":[]};if(this.props.schema.fileTypes==="image"?c={"image/*":[".png",".jpg",".svg",".gif",".apng",".avif",".webp"]}:this.props.schema.fileTypes==="audio"?c={"audio/*":[".mp3",".ogg",".wav",".mp4"]}:this.props.schema.fileTypes==="text"&&(c={"text/plain":[".txt"]}),this.props.schema.pattern){const u=this.props.schema.pattern.split("/").pop().toLowerCase().replace(/.*\./,"");u==="png"||u==="jpg"||u==="svg"||u==="gif"||u==="apng"||u==="avif"||u==="webp"?c={"image/*":[".png",".jpg",".svg",".gif",".apng",".avif",".webp"]}:u==="mp3"||u==="ogg"||u==="wav"?c={"audio/*":[".mp3",".ogg",".wav",".mp4"]}:u==="ics"?c={"text/calendar":[".ics"]}:u==="txt"?c={"text/plain":[".txt"]}:u==="pem"?c={"text/plain":[".pem"]}:c={"*/*":[`.${u}`]}}return o.createElement(Tt,{ref:this.dropzoneRef,multiple:!1,accept:c,noKeyboard:!0,noClick:!0,maxSize:this.props.schema.maxSize||2*1024*1024,onDragEnter:()=>{this.setState({uploadFile:"dragging"})},onDragLeave:()=>this.setState({uploadFile:!0}),onDrop:(u,m)=>{var y,_,T;this.setState({uploadFile:!1}),u.length?this.onDrop(u):window.alert(((T=(_=(y=m==null?void 0:m[0])==null?void 0:y.errors)==null?void 0:_[0])==null?void 0:T.message)||D.I18n.t("Cannot upload"))}},({getRootProps:u,getInputProps:m})=>o.createElement("div",{style:{...le.uploadDiv,...this.state.uploadFile==="dragging"?le.uploadDivDragging:void 0,...t?le.disabledOpacity:void 0},...u()},o.createElement("input",{...m()}),this.state.uploadFile==="dragging"?o.createElement("div",{style:{...le.uploadCenterDiv,...this.state.uploadError?le.error:void 0}},o.createElement("div",{style:le.uploadCenterTextAndIcon},o.createElement(P.UploadFile,{style:le.uploadCenterIcon}),o.createElement("div",{style:le.uploadCenterText},this.state.uploadFile==="dragging"?D.I18n.t("ra_Drop file here"):D.I18n.t("ra_Place your files here or click here to open the browse dialog")))):null,l,this.renderDeleteDialog()))}}const Le={fullWidth:{width:"100%"},fullWidthOneButton:{width:"calc(100% - 69px)",marginRight:4},fullWidthIcon:{width:"calc(100% - 119px)",marginRight:4},selectedImage:{height:40,width:40,display:"inline-block",marginRight:8}},Ps=["jpg","jpeg","svg","png","webp","gif","apng","avif","webp"],Rs=["mp3","ogg","wav","aac"],Ms=["avi","mp4","mov"],Vs=["txt","log","html","htm"],js=["json","js","ts"];class Us extends b{imagePrefix="../..";componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.imagePrefix=this.props.oContext.imagePrefix===void 0?"./files":this.props.oContext.imagePrefix,this.setState({value:e??""})}static getDerivedStateFromProps(e,t){const s=b.getValue(e.data,e.attr);return s==null||s.toString().trim()!==(t.value||"").toString().trim()?{value:s??""}:null}loadFile(){const e=this.state.value.indexOf("/");if(e!==-1){const t=this.state.value.substring(0,e),s=this.state.value.substring(e+1);return this.props.oContext.socket.readFile(t,s,!0)}return Promise.resolve(null)}play(){this.loadFile().then(e=>{if(typeof AudioContext<"u"&&(e!=null&&e.file)){const t=new AudioContext,s=Ue.base64ToArrayBuffer(e.file);t.decodeAudioData(s,i=>{const n=t.createBufferSource();n.buffer=i,n.connect(t.destination),n.start(0)},i=>window.alert(`Cannot play: ${i.message}`))}})}getIcon(){const e=this.state.value.split(".").pop().toLowerCase();return Ps.includes(e)?o.createElement("div",{style:{...Le.selectedImage,backgroundImage:`url(${this.imagePrefix}/${this.state.value})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"}}):Rs.includes(e)?o.createElement(d.IconButton,{style:{color:"#00FF00"},onClick:()=>this.play()},o.createElement(P.PlayArrow,null)):Vs.includes(e)?o.createElement(P.Article,null):Ms.includes(e)?o.createElement(P.Videocam,null):js.includes(e)?o.createElement(P.Code,null):null}renderFileBrowser(){return this.state.showFileBrowser?o.createElement(D.DialogSelectFile,{imagePrefix:this.props.oContext.imagePrefix,socket:this.props.oContext.socket,selected:this.state.value,onClose:()=>this.setState({showFileBrowser:!1}),onOk:e=>{const t=Array.isArray(e)?e[0]:e;this.setState({value:t},()=>this.onChange(this.props.attr,this.props.schema.trim===!1?t:(t||"").trim()))},selectOnlyFolders:this.props.schema.selectOnlyFolders,allowUpload:this.props.schema.allowUpload,allowDownload:this.props.schema.allowDownload,allowCreateFolder:this.props.schema.allowCreateFolder,allowView:this.props.schema.allowView,showToolbar:this.props.schema.showToolbar,limitPath:this.props.schema.limitPath,theme:this.props.oContext.theme}):null}renderItem(e,t){const s=this.getIcon();return o.createElement("div",{style:Le.fullWidth},s,o.createElement(d.TextField,{variant:"standard",style:s?Le.fullWidthIcon:Le.fullWidthOneButton,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e,disabled:!!t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:!!this.props.schema.disableEdit}},onChange:i=>{const n=i.target.value;this.setState({value:n},()=>this.onChange(this.props.attr,this.props.schema.trim===!1?n:(n||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}),o.createElement(d.Button,{disabled:t,variant:"outlined",onClick:()=>this.setState({showFileBrowser:!0})},"..."),this.renderFileBrowser())}}class Ws extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.props.oContext.socket.getEnums("functions").then(t=>{const s=Object.keys(t).map(i=>({value:this.props.schema.short?i.replace("enum.functions.",""):i,label:this.getText(t[i].common.name),obj:t[i]}));this.props.schema.allowDeactivate!==!1&&s.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),this.setState({value:e,selectOptions:s})})}renderItem(e,t){if(!this.state.selectOptions)return null;const s=this.state.selectOptions.find(i=>i.value===this.state.value);return o.createElement(d.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>s?s.obj?o.createElement(D.TextWithIcon,{value:s.obj,themeType:this.props.oContext.themeType,lang:D.I18n.getLanguage()}):s.label:"",onChange:i=>{this.setState({value:i.target.value==="_"?"":i.target.value},()=>this.onChange(this.props.attr,this.state.value))}},this.state.selectOptions.map(i=>o.createElement(d.MenuItem,{key:i.value,value:i.value,style:i.value===b.DIFFERENT_VALUE?{opacity:.5}:{}},i.obj?o.createElement(D.TextWithIcon,{value:i.obj,themeType:this.props.oContext.themeType,lang:D.I18n.getLanguage()}):i.label))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}class zs extends b{componentDidMount(){super.componentDidMount(),this.props.oContext.socket.getHostByIp(this.props.common.host).then(e=>{this.props.schema.listenOnAllPorts||(e=e.filter(t=>t.address!=="0.0.0.0"&&t.address!=="::")),this.props.schema.onlyIp4?e=e.filter(t=>t.family==="ipv4"):this.props.schema.onlyIp6&&(e=e.filter(t=>t.family==="ipv6")),this.props.schema.noInternal&&(e=e.filter(t=>!t.internal)),e.forEach(t=>{t.address==="0.0.0.0"?t.name=`[IPv4] 0.0.0.0 - ${D.I18n.t("ra_Listen on all IPs")}`:t.address==="::"&&(t.name=`[IPv6] :: - ${D.I18n.t("ra_Listen on all IPs")}`)}),this.setState({ips:e})}).catch(e=>console.error(e))}renderItem(e,t){var n,r;const s=b.getValue(this.props.data,this.props.attr),i=(n=this.state.ips)==null?void 0:n.find(a=>a.address===s);return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},this.state.ips&&this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,this.state.ips?o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:s,renderValue:a=>(i==null?void 0:i.name)||a,onChange:a=>this.onChange(this.props.attr,a.target.value)},(r=this.state.ips)==null?void 0:r.map((a,l)=>o.createElement(d.MenuItem,{key:l,value:a.address},a.name))):o.createElement(d.TextField,{fullWidth:!0,variant:"standard",error:!!e,disabled:!!t,value:s,onChange:a=>this.onChange(this.props.attr,a.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}class Hs extends b{initialized=!1;localContext;componentDidMount(){super.componentDidMount(),this.askInstance()}askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData,null,!0);if(t)try{e=JSON.parse(t)}catch{console.error(`Cannot parse json data: ${JSON.stringify(e)}`)}}e===void 0&&(e=null),this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.command||"send",e).then(t=>this.setState({image:t||""}))}}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=b.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(){if(this.props.alive){const e=this.getContext();(e!==this.localContext||!this.initialized)&&(this.localContext=e,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}return this.state.image===void 0?null:o.createElement("img",{alt:"dynamic content",src:this.state.image,style:{width:this.props.schema.width||"100%",height:this.props.schema.height}})}}class Js extends b{index;constructor(e){super(e),this.index=Date.now()}componentDidMount(){if(super.componentDidMount(),this.props.schema.base64){const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e})}else this.props.oContext.socket.fileExists(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.attr).then(e=>e&&this.loadImage())}_getUrl(e){e&&(this.index=Date.now());let t=`files/${this.props.oContext.adapterName}.${this.props.oContext.instance}/${this.props.attr}?t=${this.index}`;return window.location.port==="3000"&&(t=`${window.location.protocol}//${window.location.hostname}:8081/${t}`),t}loadImage(){fetch(this._getUrl()).then(e=>e.blob()).then(e=>{const t=new FileReader;t.onload=()=>{this.setState({value:t.result})},t.readAsDataURL(e)}).catch(e=>console.error(e))}renderItem(e,t){return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},this.props.schema.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,o.createElement(D.UploadImage,{error:!!e,disabled:t,accept:this.props.schema.accept,crop:this.props.schema.crop,maxSize:this.props.schema.maxSize||256*1024,icon:this.state.value||void 0,removeIconFunc:()=>this.setState({value:null},()=>{if(this.props.schema.base64){const s=this.onChange(this.props.attr,this.state.value);s instanceof Promise&&s.catch(i=>console.error(`Cannot set value: ${i}`))}else this.props.oContext.socket.deleteFile(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.attr).catch(s=>console.error(s))}),onChange:s=>this.setState({value:s},()=>{if(this.props.schema.base64){const i=this.onChange(this.props.attr,this.state.value);i instanceof Promise&&i.catch(n=>console.error(`Cannot set value: ${n}`))}else s.startsWith("data")&&(s=s.split(",")[1]);this.props.oContext.socket.writeFile64(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.attr,s).catch(i=>console.error(i))})}),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ct={icon:{width:20,height:20,marginRight:4}};class qs extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);let t=this.props.schema.adapter;t==="_dataSources"&&(t=void 0),this.props.oContext.socket.getAdapterInstances(t,!0).then(async s=>{this.props.schema.adapter==="_dataSources"?s=s.filter(n=>{var r;return(r=n==null?void 0:n.common)==null?void 0:r.getHistory}):this.props.schema.adapter?s=s.filter(n=>n==null?void 0:n._id.startsWith(`system.adapter.${this.props.schema.adapter}.`)):this.props.schema.adapters&&Array.isArray(this.props.schema.adapters)&&(s=s.filter(n=>{var r;return this.props.schema.adapters.includes((r=n==null?void 0:n.common)==null?void 0:r.name)})),this.props.schema.onlyEnabled&&(s=s.filter(n=>{var r;return(r=n==null?void 0:n.common)==null?void 0:r.enabled}));const i=s.map(n=>({value:this.props.schema.long?n._id:this.props.schema.short?n._id.split(".").pop():n._id.replace(/^system\.adapter\./,""),label:`${n.common.name} [${n._id.replace(/^system\.adapter\./,"")}]`,icon:`adapter/${n.common.name}/${n.common.icon}`}));i.sort((n,r)=>n.value>r.value?1:n.value<r.value?-1:0),this.props.schema.allowDeactivate!==!1&&i.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),this.props.schema.all&&i.unshift({label:D.I18n.t("sch_all"),value:"*"}),this.setState({value:e||"",selectOptions:i}),await this.props.oContext.socket.subscribeObject(`system.adapter.${t?`${t}.`:""}*`,this.onInstancesUpdate)}).catch(s=>console.error(`Cannot get instances: ${s}`))}componentWillUnmount(){this.props.oContext.socket.unsubscribeObject("system.adapter.*",this.onInstancesUpdate).then(()=>{}),super.componentWillUnmount()}onInstancesUpdate=(e,t)=>{if(!e.match(/^system\.adapter\.[-_a-z\d]+\.\d+$/))return;const s=this.props.schema.long?e:this.props.schema.short?e.split(".").pop():e.replace(/^system\.adapter\./,""),i=this.state.selectOptions.findIndex(n=>n.value===s);if(t){if(this.props.schema.adapter==="_dataSources"&&(!t.common||!t.common.getHistory))return;if(i===-1){const n=JSON.parse(JSON.stringify(this.state.selectOptions)),r=typeof t.common.name=="object"?t.common.name[D.I18n.getLanguage()]||t.common.name.en:t.common.name;n.push({value:this.props.schema.long?t._id:this.props.schema.short?t._id.split(".").pop():t._id.replace(/^system\.adapter\./,""),label:`${r} [${t._id.replace(/^system\.adapter\./,"")}]`,icon:`adapter/${r}/${t.common.icon}`}),n.sort((a,l)=>a.label>l.label?1:a.label<l.label?-1:0),this.setState({selectOptions:n})}}else if(i!==-1){const n=JSON.parse(JSON.stringify(this.state.selectOptions)),r={};this.state.value===n[i].value&&(r.value=b.NONE_VALUE),n.splice(i,1),r.selectOptions=n,this.setState(r)}};renderItem(e,t){var i;if(!this.state.selectOptions)return null;const s=(i=this.state.selectOptions)==null?void 0:i.find(n=>n.value===this.state.value);return o.createElement(d.FormControl,{fullWidth:!0,key:this.props.attr,variant:"standard"},this.props.schema.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:this.state.value,renderValue:()=>o.createElement("span",{style:{display:"flex"}},s!=null&&s.icon?o.createElement("img",{src:`./${s.icon}`,alt:s.value,style:ct.icon}):null,this.getText(s==null?void 0:s.label,!0)),onChange:n=>this.setState({value:n.target.value},()=>this.onChange(this.props.attr,this.state.value))},this.state.selectOptions.map(n=>o.createElement(d.MenuItem,{key:n.value,value:n.value,style:n.value===b.NONE_VALUE?{opacity:.5}:{}},n.icon?o.createElement("img",{src:`./${n.icon}`,alt:n.value,style:ct.icon}):null,this.getText(n.label,!0)))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ht={address:{fontSize:"smaller",opacity:.5,marginLeft:8}};class Ks extends b{componentDidMount(){super.componentDidMount(),this.props.oContext.socket.getObject(`system.host.${this.props.common.host}`).then(e=>{var s,i;const t=[];if((i=(s=e==null?void 0:e.native)==null?void 0:s.hardware)!=null&&i.networkInterfaces){const n=e.native.hardware.networkInterfaces;Object.keys(n).forEach(r=>{if(this.props.schema.ignoreInternal&&!n[r].find(l=>!l.internal)||this.props.schema.ignoreLoopback&&n[r].find(l=>l.address==="127.0.0.1"||l.address==="::1"))return;let a=n[r].find(l=>l.family==="IPv4");a=a||n[r].find(l=>l.family==="IPv6"),t.push({value:r,address:a.address})})}this.setState({interfaces:t})}).catch(e=>window.alert(`Cannot read interfaces: ${e}`))}renderItem(e,t){var n,r,a;const s=b.getValue(this.props.data,this.props.attr),i=(n=this.state.interfaces)==null?void 0:n.find(l=>l.value===s);return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},(r=this.state.interfaces)!=null&&r.length&&this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,(a=this.state.interfaces)!=null&&a.length?o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:s,renderValue:l=>i?o.createElement("span",null,i.value,o.createElement("span",{style:ht.address},i.address)):l,onChange:l=>this.onChange(this.props.attr,l.target.value)},this.state.interfaces.map((l,c)=>o.createElement(d.MenuItem,{key:c,value:l.value},o.createElement("span",null,l.value,o.createElement("span",{style:ht.address},l.address))))):o.createElement(d.TextField,{fullWidth:!0,variant:"standard",error:!!e,disabled:!!t,value:s,onChange:l=>this.onChange(this.props.attr,l.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const xe={modalDialog:{minWidth:400,maxWidth:800},overflowHidden:{display:"flex",overflow:"hidden"},titleIcon:{marginRight:5},content:{fontSize:16},languageButton:{position:"absolute",right:8,top:8},languageButtonActive:{color:"primary.main"}},Xs=({toggleTranslation:h,noTranslation:e,title:t,fullWidth:s,help:i,maxWidth:n,progress:r,icon:a,applyDisabled:l,applyButton:c,onClose:u,children:m,titleButtonApply:y,titleButtonClose:_,onApply:T,textInput:A,defaultValue:w,overflowHidden:F})=>{const[S,L]=_e.useState(w);_e.useEffect(()=>{L(w)},[w]);let x=null;return a&&(x=a),o.createElement(d.Dialog,{open:!0,maxWidth:n||"md",fullWidth:!!s,disableEscapeKeyDown:!1,onClose:u,sx:{"& .MuiPaper-root":xe.modalDialog}},t&&o.createElement(d.DialogTitle,null,a?o.createElement(x,{style:xe.titleIcon}):null,t,D.I18n.getLanguage()!=="en"&&h?o.createElement(d.IconButton,{size:"large",style:{...xe.languageButton,...e?xe.languageButtonActive:{}},onClick:()=>h(),title:D.I18n.t("Disable/Enable translation")},o.createElement(P.Language,null)):null),o.createElement(d.DialogContent,{sx:{...F?xe.overflowHidden:{},...xe.content},style:{paddingTop:8}},A&&o.createElement(d.TextField,{autoComplete:"off",fullWidth:!0,autoFocus:!0,variant:"outlined",size:"medium",multiline:!0,value:S,onChange:C=>L(C.target.value)}),m,i?o.createElement("div",null,i):null),o.createElement(d.DialogActions,null,c!==!1&&o.createElement(d.Button,{startIcon:o.createElement(P.Check,null),disabled:r||l&&w===S,onClick:()=>T&&T(A?S:""),variant:"contained",color:"primary"},D.I18n.t(y||"Ok")),o.createElement(d.Button,{color:"grey",onClick:()=>u&&u(),disabled:r,variant:"contained",startIcon:o.createElement(P.Close,null)},D.I18n.t(_||"Cancel"))))},{loadShare:Gs}=It,{initPromise:Ys}=_t,Zs=Ys.then(h=>Gs("react-ace",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),Qs=await Zs.then(h=>h());var en=Qs;const tn=St(en);var sn={exports:{}};(function(h,e){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(t,s,i){var n=t("../lib/oop"),r=t("./text_highlight_rules").TextHighlightRules,a=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"punctuation.operator",regex:/[,]/},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};n.inherits(a,r),s.JsonHighlightRules=a}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(t,s,i){var n=t("../range").Range,r=function(){};(function(){this.checkOutdent=function(a,l){return/^\s+$/.test(a)?/^\s*\}/.test(l):!1},this.autoOutdent=function(a,l){var c=a.getLine(l),u=c.match(/^(\s*\})/);if(!u)return 0;var m=u[1].length,y=a.findMatchingBracket({row:l,column:m});if(!y||y.row==l)return 0;var _=this.$getIndent(a.getLine(y.row));a.replace(new n(l,0,l,m-1),_)},this.$getIndent=function(a){return a.match(/^\s*/)[0]}}).call(r.prototype),s.MatchingBraceOutdent=r}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(t,s,i){var n=t("../../lib/oop"),r=t("../../range").Range,a=t("./fold_mode").FoldMode,l=s.FoldMode=function(c){c&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+c.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+c.end)))};n.inherits(l,a),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(c,u,m){var y=c.getLine(m);if(this.singleLineBlockCommentRe.test(y)&&!this.startRegionRe.test(y)&&!this.tripleStarBlockCommentRe.test(y))return"";var _=this._getFoldWidgetBase(c,u,m);return!_&&this.startRegionRe.test(y)?"start":_},this.getFoldWidgetRange=function(c,u,m,y){var _=c.getLine(m);if(this.startRegionRe.test(_))return this.getCommentRegionBlock(c,_,m);var w=_.match(this.foldingStartMarker);if(w){var T=w.index;if(w[1])return this.openingBracketBlock(c,w[1],m,T);var A=c.getCommentFoldRange(m,T+w[0].length,1);return A&&!A.isMultiLine()&&(y?A=this.getSectionRange(c,m):u!="all"&&(A=null)),A}if(u!=="markbegin"){var w=_.match(this.foldingStopMarker);if(w){var T=w.index+w[0].length;return w[1]?this.closingBracketBlock(c,w[1],m,T):c.getCommentFoldRange(m,T,-1)}}},this.getSectionRange=function(c,u){var m=c.getLine(u),y=m.search(/\S/),_=u,T=m.length;u+=1;for(var A=u,w=c.getLength();++u<w;){m=c.getLine(u);var F=m.search(/\S/);if(F!==-1){if(y>F)break;var S=this.getFoldWidgetRange(c,"all",u);if(S){if(S.start.row<=_)break;if(S.isMultiLine())u=S.end.row;else if(y==F)break}A=u}}return new r(_,T,A,c.getLine(A).length)},this.getCommentRegionBlock=function(c,u,m){for(var y=u.search(/\s*$/),_=c.getLength(),T=m,A=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,w=1;++m<_;){u=c.getLine(m);var F=A.exec(u);if(F&&(F[1]?w--:w++,!w))break}var S=m;if(S>T)return new r(T,y,S,u.length)}}.call(l.prototype)}),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/folding/cstyle","ace/worker/worker_client"],function(t,s,i){var n=t("../lib/oop"),r=t("./text").Mode,a=t("./json_highlight_rules").JsonHighlightRules,l=t("./matching_brace_outdent").MatchingBraceOutdent,c=t("./folding/cstyle").FoldMode,u=t("../worker/worker_client").WorkerClient,m=function(){this.HighlightRules=a,this.$outdent=new l,this.$behaviour=this.$defaultBehaviour,this.foldingRules=new c};n.inherits(m,r),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(y,_,T){var A=this.$getIndent(_);if(y=="start"){var w=_.match(/^.*[\{\(\[]\s*$/);w&&(A+=T)}return A},this.checkOutdent=function(y,_,T){return this.$outdent.checkOutdent(_,T)},this.autoOutdent=function(y,_,T){this.$outdent.autoOutdent(_,T)},this.createWorker=function(y){var _=new u(["ace"],"ace/mode/json_worker","JsonWorker");return _.attachToDocument(y.getDocument()),_.on("annotate",function(T){y.setAnnotations(T.data)}),_.on("terminate",function(){y.clearAnnotations()}),_},this.$id="ace/mode/json"}.call(m.prototype),s.Mode=m}),function(){ace.require(["ace/mode/json"],function(t){h&&(h.exports=t)})}()})(sn);var nn={};(function(h){function e(i,n){for(var r=i,a="";r;){var l=n[r];if(typeof l=="string")return l+a;if(l)return l.location.replace(/\/*$/,"/")+(a||l.main||l.name);if(l===!1)return"";var c=r.lastIndexOf("/");if(c===-1)break;a=r.substr(c)+a,r=r.slice(0,c)}return i}if(!(typeof h.window<"u"&&h.document)&&!(h.require&&h.define)){h.console||(h.console=function(){var i=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:i})},h.console.error=h.console.warn=h.console.log=h.console.trace=h.console),h.window=h,h.ace=h,h.onerror=function(i,n,r,a,l){postMessage({type:"error",data:{message:i,data:l&&l.data,file:n,line:r,col:a,stack:l&&l.stack}})},h.normalizeModule=function(i,n){if(n.indexOf("!")!==-1){var r=n.split("!");return h.normalizeModule(i,r[0])+"!"+h.normalizeModule(i,r[1])}if(n.charAt(0)=="."){var a=i.split("/").slice(0,-1).join("/");for(n=(a?a+"/":"")+n;n.indexOf(".")!==-1&&l!=n;){var l=n;n=n.replace(/^\.\//,"").replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}}return n},h.require=function(i,n){if(n||(n=i,i=null),!n.charAt)throw new Error("worker.js require() accepts only (parentId, id) as arguments");n=h.normalizeModule(i,n);var r=h.require.modules[n];if(r)return r.initialized||(r.initialized=!0,r.exports=r.factory().exports),r.exports;if(!h.require.tlns)return console.log("unable to load "+n);var a=e(n,h.require.tlns);return a.slice(-3)!=".js"&&(a+=".js"),h.require.id=n,h.require.modules[n]={},importScripts(a),h.require(i,n)},h.require.modules={},h.require.tlns={},h.define=function(i,n,r){if(arguments.length==2?(r=n,typeof i!="string"&&(n=i,i=h.require.id)):arguments.length==1&&(r=i,n=[],i=h.require.id),typeof r!="function"){h.require.modules[i]={exports:r,initialized:!0};return}n.length||(n=["require","exports","module"]);var a=function(l){return h.require(i,l)};h.require.modules[i]={exports:{},factory:function(){var l=this,c=r.apply(this,n.slice(0,r.length).map(function(u){switch(u){case"require":return a;case"exports":return l.exports;case"module":return l;default:return a(u)}}));return c&&(l.exports=c),l}}},h.define.amd={},h.require.tlns={},h.initBaseUrls=function(i){for(var n in i)this.require.tlns[n]=i[n]},h.initSender=function(){var i=h.require("ace/lib/event_emitter").EventEmitter,n=h.require("ace/lib/oop"),r=function(){};return function(){n.implement(this,i),this.callback=function(a,l){postMessage({type:"call",id:l,data:a})},this.emit=function(a,l){postMessage({type:"event",name:a,data:l})}}.call(r.prototype),new r};var t=h.main=null,s=h.sender=null;h.onmessage=function(i){var n=i.data;if(n.event&&s)s._signal(n.event,n.data);else if(n.command)if(t[n.command])t[n.command].apply(t,n.args);else{if(!h[n.command])throw new Error("Unknown command:"+n.command);h[n.command].apply(h,n.args)}else if(n.init){h.initBaseUrls(n.tlns),s=h.sender=h.initSender();var r=this.require(n.module)[n.classname];t=h.main=new r(s)}}}})(nn),ace.define("ace/lib/oop",[],function(h,e,t){e.inherits=function(s,i){s.super_=i,s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})},e.mixin=function(s,i){for(var n in i)s[n]=i[n];return s},e.implement=function(s,i){e.mixin(s,i)}}),ace.define("ace/apply_delta",[],function(h,e,t){e.applyDelta=function(s,i,n){var r=i.start.row,a=i.start.column,l=s[r]||"";switch(i.action){case"insert":var c=i.lines;if(c.length===1)s[r]=l.substring(0,a)+i.lines[0]+l.substring(a);else{var u=[r,1].concat(i.lines);s.splice.apply(s,u),s[r]=l.substring(0,a)+s[r],s[r+i.lines.length-1]+=l.substring(a)}break;case"remove":var m=i.end.column,y=i.end.row;r===y?s[r]=l.substring(0,a)+l.substring(m):s.splice(r,y-r+1,l.substring(0,a)+s[y].substring(m))}}}),ace.define("ace/lib/event_emitter",[],function(h,e,t){var s={},i=function(){this.propagationStopped=!0},n=function(){this.defaultPrevented=!0};s._emit=s._dispatchEvent=function(r,a){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var l=this._eventRegistry[r]||[],c=this._defaultHandlers[r];if(!(!l.length&&!c)){(typeof a!="object"||!a)&&(a={}),a.type||(a.type=r),a.stopPropagation||(a.stopPropagation=i),a.preventDefault||(a.preventDefault=n),l=l.slice();for(var u=0;u<l.length&&(l[u](a,this),!a.propagationStopped);u++);if(c&&!a.defaultPrevented)return c(a,this)}},s._signal=function(r,a){var l=(this._eventRegistry||{})[r];if(l){l=l.slice();for(var c=0;c<l.length;c++)l[c](a,this)}},s.once=function(r,a){var l=this;if(this.on(r,function c(){l.off(r,c),a.apply(null,arguments)}),!a)return new Promise(function(c){a=c})},s.setDefaultHandler=function(r,a){var l=this._defaultHandlers;if(l||(l=this._defaultHandlers={_disabled_:{}}),l[r]){var c=l[r],u=l._disabled_[r];u||(l._disabled_[r]=u=[]),u.push(c);var m=u.indexOf(a);m!=-1&&u.splice(m,1)}l[r]=a},s.removeDefaultHandler=function(r,a){var l=this._defaultHandlers;if(l){var c=l._disabled_[r];if(l[r]==a)c&&this.setDefaultHandler(r,c.pop());else if(c){var u=c.indexOf(a);u!=-1&&c.splice(u,1)}}},s.on=s.addEventListener=function(r,a,l){this._eventRegistry=this._eventRegistry||{};var c=this._eventRegistry[r];return c||(c=this._eventRegistry[r]=[]),c.indexOf(a)==-1&&c[l?"unshift":"push"](a),a},s.off=s.removeListener=s.removeEventListener=function(r,a){this._eventRegistry=this._eventRegistry||{};var l=this._eventRegistry[r];if(l){var c=l.indexOf(a);c!==-1&&l.splice(c,1)}},s.removeAllListeners=function(r){r||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[r]=void 0),this._defaultHandlers&&(this._defaultHandlers[r]=void 0)},e.EventEmitter=s}),ace.define("ace/range",[],function(h,e,t){var s=function(){function i(n,r,a,l){this.start={row:n,column:r},this.end={row:a,column:l}}return i.prototype.isEqual=function(n){return this.start.row===n.start.row&&this.end.row===n.end.row&&this.start.column===n.start.column&&this.end.column===n.end.column},i.prototype.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},i.prototype.contains=function(n,r){return this.compare(n,r)==0},i.prototype.compareRange=function(n){var r,a=n.end,l=n.start;return r=this.compare(a.row,a.column),r==1?(r=this.compare(l.row,l.column),r==1?2:r==0?1:0):r==-1?-2:(r=this.compare(l.row,l.column),r==-1?-1:r==1?42:0)},i.prototype.comparePoint=function(n){return this.compare(n.row,n.column)},i.prototype.containsRange=function(n){return this.comparePoint(n.start)==0&&this.comparePoint(n.end)==0},i.prototype.intersects=function(n){var r=this.compareRange(n);return r==-1||r==0||r==1},i.prototype.isEnd=function(n,r){return this.end.row==n&&this.end.column==r},i.prototype.isStart=function(n,r){return this.start.row==n&&this.start.column==r},i.prototype.setStart=function(n,r){typeof n=="object"?(this.start.column=n.column,this.start.row=n.row):(this.start.row=n,this.start.column=r)},i.prototype.setEnd=function(n,r){typeof n=="object"?(this.end.column=n.column,this.end.row=n.row):(this.end.row=n,this.end.column=r)},i.prototype.inside=function(n,r){return this.compare(n,r)==0?!(this.isEnd(n,r)||this.isStart(n,r)):!1},i.prototype.insideStart=function(n,r){return this.compare(n,r)==0?!this.isEnd(n,r):!1},i.prototype.insideEnd=function(n,r){return this.compare(n,r)==0?!this.isStart(n,r):!1},i.prototype.compare=function(n,r){return!this.isMultiLine()&&n===this.start.row?r<this.start.column?-1:r>this.end.column?1:0:n<this.start.row?-1:n>this.end.row?1:this.start.row===n?r>=this.start.column?0:-1:this.end.row===n?r<=this.end.column?0:1:0},i.prototype.compareStart=function(n,r){return this.start.row==n&&this.start.column==r?-1:this.compare(n,r)},i.prototype.compareEnd=function(n,r){return this.end.row==n&&this.end.column==r?1:this.compare(n,r)},i.prototype.compareInside=function(n,r){return this.end.row==n&&this.end.column==r?1:this.start.row==n&&this.start.column==r?-1:this.compare(n,r)},i.prototype.clipRows=function(n,r){if(this.end.row>r)var a={row:r+1,column:0};else if(this.end.row<n)var a={row:n,column:0};if(this.start.row>r)var l={row:r+1,column:0};else if(this.start.row<n)var l={row:n,column:0};return i.fromPoints(l||this.start,a||this.end)},i.prototype.extend=function(n,r){var a=this.compare(n,r);if(a==0)return this;if(a==-1)var l={row:n,column:r};else var c={row:n,column:r};return i.fromPoints(l||this.start,c||this.end)},i.prototype.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},i.prototype.isMultiLine=function(){return this.start.row!==this.end.row},i.prototype.clone=function(){return i.fromPoints(this.start,this.end)},i.prototype.collapseRows=function(){return this.end.column==0?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},i.prototype.toScreenRange=function(n){var r=n.documentToScreenPosition(this.start),a=n.documentToScreenPosition(this.end);return new i(r.row,r.column,a.row,a.column)},i.prototype.moveBy=function(n,r){this.start.row+=n,this.start.column+=r,this.end.row+=n,this.end.column+=r},i}();s.fromPoints=function(i,n){return new s(i.row,i.column,n.row,n.column)},s.comparePoints=function(i,n){return i.row-n.row||i.column-n.column},e.Range=s}),ace.define("ace/anchor",[],function(h,e,t){function s(l,c,u){var m=u?l.column<=c.column:l.column<c.column;return l.row<c.row||l.row==c.row&&m}function i(l,c,u){var m=l.action=="insert",y=(m?1:-1)*(l.end.row-l.start.row),_=(m?1:-1)*(l.end.column-l.start.column),T=l.start,A=m?T:l.end;return s(c,T,u)?{row:c.row,column:c.column}:s(A,c,!u)?{row:c.row+y,column:c.column+(c.row==A.row?_:0)}:{row:T.row,column:T.column}}var n=h("./lib/oop"),r=h("./lib/event_emitter").EventEmitter,a=function(){function l(c,u,m){this.$onChange=this.onChange.bind(this),this.attach(c),typeof u!="number"?this.setPosition(u.row,u.column):this.setPosition(u,m)}return l.prototype.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},l.prototype.getDocument=function(){return this.document},l.prototype.onChange=function(c){if(!(c.start.row==c.end.row&&c.start.row!=this.row)&&!(c.start.row>this.row)){var u=i(c,{row:this.row,column:this.column},this.$insertRight);this.setPosition(u.row,u.column,!0)}},l.prototype.setPosition=function(c,u,m){var y;if(m?y={row:c,column:u}:y=this.$clipPositionToDocument(c,u),!(this.row==y.row&&this.column==y.column)){var _={row:this.row,column:this.column};this.row=y.row,this.column=y.column,this._signal("change",{old:_,value:y})}},l.prototype.detach=function(){this.document.off("change",this.$onChange)},l.prototype.attach=function(c){this.document=c||this.document,this.document.on("change",this.$onChange)},l.prototype.$clipPositionToDocument=function(c,u){var m={};return c>=this.document.getLength()?(m.row=Math.max(0,this.document.getLength()-1),m.column=this.document.getLine(m.row).length):c<0?(m.row=0,m.column=0):(m.row=c,m.column=Math.min(this.document.getLine(m.row).length,Math.max(0,u))),u<0&&(m.column=0),m},l}();a.prototype.$insertRight=!1,n.implement(a.prototype,r),e.Anchor=a}),ace.define("ace/document",[],function(h,e,t){var s=h("./lib/oop"),i=h("./apply_delta").applyDelta,n=h("./lib/event_emitter").EventEmitter,r=h("./range").Range,a=h("./anchor").Anchor,l=function(){function c(u){this.$lines=[""],u.length===0?this.$lines=[""]:Array.isArray(u)?this.insertMergedLines({row:0,column:0},u):this.insert({row:0,column:0},u)}return c.prototype.setValue=function(u){var m=this.getLength()-1;this.remove(new r(0,0,m,this.getLine(m).length)),this.insert({row:0,column:0},u||"")},c.prototype.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},c.prototype.createAnchor=function(u,m){return new a(this,u,m)},c.prototype.$detectNewLine=function(u){var m=u.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=m?m[1]:`
`,this._signal("changeNewLineMode")},c.prototype.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return`\r
`;case"unix":return`
`;default:return this.$autoNewLine||`
`}},c.prototype.setNewLineMode=function(u){this.$newLineMode!==u&&(this.$newLineMode=u,this._signal("changeNewLineMode"))},c.prototype.getNewLineMode=function(){return this.$newLineMode},c.prototype.isNewLine=function(u){return u==`\r
`||u=="\r"||u==`
`},c.prototype.getLine=function(u){return this.$lines[u]||""},c.prototype.getLines=function(u,m){return this.$lines.slice(u,m+1)},c.prototype.getAllLines=function(){return this.getLines(0,this.getLength())},c.prototype.getLength=function(){return this.$lines.length},c.prototype.getTextRange=function(u){return this.getLinesForRange(u).join(this.getNewLineCharacter())},c.prototype.getLinesForRange=function(u){var m;if(u.start.row===u.end.row)m=[this.getLine(u.start.row).substring(u.start.column,u.end.column)];else{m=this.getLines(u.start.row,u.end.row),m[0]=(m[0]||"").substring(u.start.column);var y=m.length-1;u.end.row-u.start.row==y&&(m[y]=m[y].substring(0,u.end.column))}return m},c.prototype.insertLines=function(u,m){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(u,m)},c.prototype.removeLines=function(u,m){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(u,m)},c.prototype.insertNewLine=function(u){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(u,["",""])},c.prototype.insert=function(u,m){return this.getLength()<=1&&this.$detectNewLine(m),this.insertMergedLines(u,this.$split(m))},c.prototype.insertInLine=function(u,m){var y=this.clippedPos(u.row,u.column),_=this.pos(u.row,u.column+m.length);return this.applyDelta({start:y,end:_,action:"insert",lines:[m]},!0),this.clonePos(_)},c.prototype.clippedPos=function(u,m){var y=this.getLength();u===void 0?u=y:u<0?u=0:u>=y&&(u=y-1,m=void 0);var _=this.getLine(u);return m==null&&(m=_.length),m=Math.min(Math.max(m,0),_.length),{row:u,column:m}},c.prototype.clonePos=function(u){return{row:u.row,column:u.column}},c.prototype.pos=function(u,m){return{row:u,column:m}},c.prototype.$clipPosition=function(u){var m=this.getLength();return u.row>=m?(u.row=Math.max(0,m-1),u.column=this.getLine(m-1).length):(u.row=Math.max(0,u.row),u.column=Math.min(Math.max(u.column,0),this.getLine(u.row).length)),u},c.prototype.insertFullLines=function(u,m){u=Math.min(Math.max(u,0),this.getLength());var y=0;u<this.getLength()?(m=m.concat([""]),y=0):(m=[""].concat(m),u--,y=this.$lines[u].length),this.insertMergedLines({row:u,column:y},m)},c.prototype.insertMergedLines=function(u,m){var y=this.clippedPos(u.row,u.column),_={row:y.row+m.length-1,column:(m.length==1?y.column:0)+m[m.length-1].length};return this.applyDelta({start:y,end:_,action:"insert",lines:m}),this.clonePos(_)},c.prototype.remove=function(u){var m=this.clippedPos(u.start.row,u.start.column),y=this.clippedPos(u.end.row,u.end.column);return this.applyDelta({start:m,end:y,action:"remove",lines:this.getLinesForRange({start:m,end:y})}),this.clonePos(m)},c.prototype.removeInLine=function(u,m,y){var _=this.clippedPos(u,m),T=this.clippedPos(u,y);return this.applyDelta({start:_,end:T,action:"remove",lines:this.getLinesForRange({start:_,end:T})},!0),this.clonePos(_)},c.prototype.removeFullLines=function(u,m){u=Math.min(Math.max(0,u),this.getLength()-1),m=Math.min(Math.max(0,m),this.getLength()-1);var y=m==this.getLength()-1&&u>0,_=m<this.getLength()-1,T=y?u-1:u,A=y?this.getLine(T).length:0,w=_?m+1:m,F=_?0:this.getLine(w).length,S=new r(T,A,w,F),L=this.$lines.slice(u,m+1);return this.applyDelta({start:S.start,end:S.end,action:"remove",lines:this.getLinesForRange(S)}),L},c.prototype.removeNewLine=function(u){u<this.getLength()-1&&u>=0&&this.applyDelta({start:this.pos(u,this.getLine(u).length),end:this.pos(u+1,0),action:"remove",lines:["",""]})},c.prototype.replace=function(u,m){if(u instanceof r||(u=r.fromPoints(u.start,u.end)),m.length===0&&u.isEmpty())return u.start;if(m==this.getTextRange(u))return u.end;this.remove(u);var y;return m?y=this.insert(u.start,m):y=u.start,y},c.prototype.applyDeltas=function(u){for(var m=0;m<u.length;m++)this.applyDelta(u[m])},c.prototype.revertDeltas=function(u){for(var m=u.length-1;m>=0;m--)this.revertDelta(u[m])},c.prototype.applyDelta=function(u,m){var y=u.action=="insert";(y?u.lines.length<=1&&!u.lines[0]:!r.comparePoints(u.start,u.end))||(y&&u.lines.length>2e4?this.$splitAndapplyLargeDelta(u,2e4):(i(this.$lines,u,m),this._signal("change",u)))},c.prototype.$safeApplyDelta=function(u){var m=this.$lines.length;(u.action=="remove"&&u.start.row<m&&u.end.row<m||u.action=="insert"&&u.start.row<=m)&&this.applyDelta(u)},c.prototype.$splitAndapplyLargeDelta=function(u,m){for(var y=u.lines,_=y.length-m+1,T=u.start.row,A=u.start.column,w=0,F=0;w<_;w=F){F+=m-1;var S=y.slice(w,F);S.push(""),this.applyDelta({start:this.pos(T+w,A),end:this.pos(T+F,A=0),action:u.action,lines:S},!0)}u.lines=y.slice(w),u.start.row=T+w,u.start.column=A,this.applyDelta(u,!0)},c.prototype.revertDelta=function(u){this.$safeApplyDelta({start:this.clonePos(u.start),end:this.clonePos(u.end),action:u.action=="insert"?"remove":"insert",lines:u.lines.slice()})},c.prototype.indexToPosition=function(u,m){for(var y=this.$lines||this.getAllLines(),_=this.getNewLineCharacter().length,T=m||0,A=y.length;T<A;T++)if(u-=y[T].length+_,u<0)return{row:T,column:u+y[T].length+_};return{row:A-1,column:u+y[A-1].length+_}},c.prototype.positionToIndex=function(u,m){for(var y=this.$lines||this.getAllLines(),_=this.getNewLineCharacter().length,T=0,A=Math.min(u.row,y.length),w=m||0;w<A;++w)T+=y[w].length+_;return T+u.column},c.prototype.$split=function(u){return u.split(/\r\n|\r|\n/)},c}();l.prototype.$autoNewLine="",l.prototype.$newLineMode="auto",s.implement(l.prototype,n),e.Document=l}),ace.define("ace/lib/deep_copy",[],function(h,e,t){e.deepCopy=function s(i){if(typeof i!="object"||!i)return i;var n;if(Array.isArray(i)){n=[];for(var r=0;r<i.length;r++)n[r]=s(i[r]);return n}if(Object.prototype.toString.call(i)!=="[object Object]")return i;n={};for(var r in i)n[r]=s(i[r]);return n}}),ace.define("ace/lib/lang",[],function(h,e,t){e.last=function(n){return n[n.length-1]},e.stringReverse=function(n){return n.split("").reverse().join("")},e.stringRepeat=function(n,r){for(var a="";r>0;)r&1&&(a+=n),(r>>=1)&&(n+=n);return a};var s=/^\s\s*/,i=/\s\s*$/;e.stringTrimLeft=function(n){return n.replace(s,"")},e.stringTrimRight=function(n){return n.replace(i,"")},e.copyObject=function(n){var r={};for(var a in n)r[a]=n[a];return r},e.copyArray=function(n){for(var r=[],a=0,l=n.length;a<l;a++)n[a]&&typeof n[a]=="object"?r[a]=this.copyObject(n[a]):r[a]=n[a];return r},e.deepCopy=h("./deep_copy").deepCopy,e.arrayToMap=function(n){for(var r={},a=0;a<n.length;a++)r[n[a]]=1;return r},e.createMap=function(n){var r=Object.create(null);for(var a in n)r[a]=n[a];return r},e.arrayRemove=function(n,r){for(var a=0;a<=n.length;a++)r===n[a]&&n.splice(a,1)},e.escapeRegExp=function(n){return n.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},e.escapeHTML=function(n){return(""+n).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},e.getMatchOffsets=function(n,r){var a=[];return n.replace(r,function(l){a.push({offset:arguments[arguments.length-2],length:l.length})}),a},e.deferredCall=function(n){var r=null,a=function(){r=null,n()},l=function(c){return l.cancel(),r=setTimeout(a,c||0),l};return l.schedule=l,l.call=function(){return this.cancel(),n(),l},l.cancel=function(){return clearTimeout(r),r=null,l},l.isPending=function(){return r},l},e.delayedCall=function(n,r){var a=null,l=function(){a=null,n()},c=function(u){a==null&&(a=setTimeout(l,u||r))};return c.delay=function(u){a&&clearTimeout(a),a=setTimeout(l,u||r)},c.schedule=c,c.call=function(){this.cancel(),n()},c.cancel=function(){a&&clearTimeout(a),a=null},c.isPending=function(){return a},c},e.supportsLookbehind=function(){try{new RegExp("(?<=.)")}catch{return!1}return!0},e.skipEmptyMatch=function(n,r,a){return a&&n.codePointAt(r)>65535?2:1}}),ace.define("ace/worker/mirror",[],function(h,e,t){var s=h("../document").Document,i=h("../lib/lang"),n=e.Mirror=function(r){this.sender=r;var a=this.doc=new s(""),l=this.deferredUpdate=i.delayedCall(this.onUpdate.bind(this)),c=this;r.on("change",function(u){var m=u.data;if(m[0].start)a.applyDeltas(m);else for(var y=0;y<m.length;y+=2){var _,T;if(Array.isArray(m[y+1])?_={action:"insert",start:m[y],lines:m[y+1]}:_={action:"remove",start:m[y],end:m[y+1]},(_.action=="insert"?_.start:_.end).row>=a.$lines.length)throw T=new Error("Invalid delta"),T.data={path:c.$path,linesLength:a.$lines.length,start:_.start,end:_.end},T;a.applyDelta(_,!0)}if(c.$timeout)return l.schedule(c.$timeout);c.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(r){this.$timeout=r},this.setValue=function(r){this.doc.setValue(r),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(r){this.sender.callback(this.doc.getValue(),r)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(n.prototype)}),ace.define("ace/mode/json/json_parse",[],function(h,e,t){var s,i,n={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},r,a=function(w){throw{name:"SyntaxError",message:w,at:s,text:r}},l=function(w){return w&&w!==i&&a("Expected '"+w+"' instead of '"+i+"'"),i=r.charAt(s),s+=1,i},c=function(){var w,F="";for(i==="-"&&(F="-",l("-"));i>="0"&&i<="9";)F+=i,l();if(i===".")for(F+=".";l()&&i>="0"&&i<="9";)F+=i;if(i==="e"||i==="E")for(F+=i,l(),(i==="-"||i==="+")&&(F+=i,l());i>="0"&&i<="9";)F+=i,l();if(w=+F,!isNaN(w))return w;a("Bad number")},u=function(){var w,F,S="",L;if(i==='"')for(;l();){if(i==='"')return l(),S;if(i==="\\")if(l(),i==="u"){for(L=0,F=0;F<4&&(w=parseInt(l(),16),!!isFinite(w));F+=1)L=L*16+w;S+=String.fromCharCode(L)}else{if(typeof n[i]!="string")break;S+=n[i]}else{if(i==`
`||i=="\r")break;S+=i}}a("Bad string")},m=function(){for(;i&&i<=" ";)l()},y=function(){switch(i){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}a("Unexpected '"+i+"'")},_,T=function(){var w=[];if(i==="["){if(l("["),m(),i==="]")return l("]"),w;for(;i;){if(w.push(_()),m(),i==="]")return l("]"),w;l(","),m()}}a("Bad array")},A=function(){var w,F={};if(i==="{"){if(l("{"),m(),i==="}")return l("}"),F;for(;i;){if(w=u(),m(),l(":"),Object.hasOwnProperty.call(F,w)&&a('Duplicate key "'+w+'"'),F[w]=_(),m(),i==="}")return l("}"),F;l(","),m()}}a("Bad object")};return _=function(){switch(m(),i){case"{":return A();case"[":return T();case'"':return u();case"-":return c();default:return i>="0"&&i<="9"?c():y()}},function(w,F){var S;return r=w,s=0,i=" ",S=_(),m(),i&&a("Syntax error"),typeof F=="function"?function L(x,C){var p,g,f=x[C];if(f&&typeof f=="object")for(p in f)Object.hasOwnProperty.call(f,p)&&(g=L(f,p),g!==void 0?f[p]=g:delete f[p]);return F.call(x,C,f)}({"":S},""):S}}),ace.define("ace/mode/json_worker",[],function(h,e,t){var s=h("../lib/oop"),i=h("../worker/mirror").Mirror,n=h("./json/json_parse"),r=e.JsonWorker=function(a){i.call(this,a),this.setTimeout(200)};s.inherits(r,i),function(){this.onUpdate=function(){var a=this.doc.getValue(),l=[];try{a&&n(a)}catch(u){var c=this.doc.indexToPosition(u.at-1);l.push({row:c.row,column:c.column,text:u.message,type:"error"})}this.sender.emit("annotate",l)}}.call(r.prototype)});var rn={exports:{}};(function(h,e){ace.define("ace/theme/clouds_midnight-css",["require","exports","module"],function(t,s,i){i.exports=`.ace-clouds-midnight .ace_gutter {
  background: #232323;
  color: #929292
}

.ace-clouds-midnight .ace_print-margin {
  width: 1px;
  background: #232323
}

.ace-clouds-midnight {
  background-color: #191919;
  color: #929292
}

.ace-clouds-midnight .ace_cursor {
  color: #7DA5DC
}

.ace-clouds-midnight .ace_marker-layer .ace_selection {
  background: #000000
}

.ace-clouds-midnight.ace_multiselect .ace_selection.ace_start {
  box-shadow: 0 0 3px 0px #191919;
}

.ace-clouds-midnight .ace_marker-layer .ace_step {
  background: rgb(102, 82, 0)
}

.ace-clouds-midnight .ace_marker-layer .ace_bracket {
  margin: -1px 0 0 -1px;
  border: 1px solid #BFBFBF
}

.ace-clouds-midnight .ace_marker-layer .ace_active-line {
  background: rgba(215, 215, 215, 0.031)
}

.ace-clouds-midnight .ace_gutter-active-line {
  background-color: rgba(215, 215, 215, 0.031)
}

.ace-clouds-midnight .ace_marker-layer .ace_selected-word {
  border: 1px solid #000000
}

.ace-clouds-midnight .ace_invisible {
  color: #666
}

.ace-clouds-midnight .ace_keyword,
.ace-clouds-midnight .ace_meta,
.ace-clouds-midnight .ace_support.ace_constant.ace_property-value {
  color: #927C5D
}

.ace-clouds-midnight .ace_keyword.ace_operator {
  color: #4B4B4B
}

.ace-clouds-midnight .ace_keyword.ace_other.ace_unit {
  color: #366F1A
}

.ace-clouds-midnight .ace_constant.ace_language {
  color: #39946A
}

.ace-clouds-midnight .ace_constant.ace_numeric {
  color: #46A609
}

.ace-clouds-midnight .ace_constant.ace_character.ace_entity {
  color: #A165AC
}

.ace-clouds-midnight .ace_invalid {
  color: #FFFFFF;
  background-color: #E92E2E
}

.ace-clouds-midnight .ace_fold {
  background-color: #927C5D;
  border-color: #929292
}

.ace-clouds-midnight .ace_storage,
.ace-clouds-midnight .ace_support.ace_class,
.ace-clouds-midnight .ace_support.ace_function,
.ace-clouds-midnight .ace_support.ace_other,
.ace-clouds-midnight .ace_support.ace_type {
  color: #E92E2E
}

.ace-clouds-midnight .ace_string {
  color: #5D90CD
}

.ace-clouds-midnight .ace_comment {
  color: #3C403B
}

.ace-clouds-midnight .ace_entity.ace_name.ace_tag,
.ace-clouds-midnight .ace_entity.ace_other.ace_attribute-name {
  color: #606060
}

.ace-clouds-midnight .ace_indent-guide {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHB3d/8PAAOIAdULw8qMAAAAAElFTkSuQmCC) right repeat-y
}

.ace-clouds-midnight .ace_indent-guide-active {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQIW2PQ1dX9zzBz5sz/ABCcBFFentLlAAAAAElFTkSuQmCC) right repeat-y;
}
`}),ace.define("ace/theme/clouds_midnight",["require","exports","module","ace/theme/clouds_midnight-css","ace/lib/dom"],function(t,s,i){s.isDark=!0,s.cssClass="ace-clouds-midnight",s.cssText=t("./clouds_midnight-css");var n=t("../lib/dom");n.importCssString(s.cssText,s.cssClass,!1)}),function(){ace.require(["ace/theme/clouds_midnight"],function(t){h&&(h.exports=t)})}()})(rn);var on={exports:{}};(function(h,e){ace.define("ace/theme/chrome-css",["require","exports","module"],function(t,s,i){i.exports=`.ace-chrome .ace_gutter {
  background: #ebebeb;
  color: #333;
  overflow : hidden;
}

.ace-chrome .ace_print-margin {
  width: 1px;
  background: #e8e8e8;
}

.ace-chrome {
  background-color: #FFFFFF;
  color: black;
}

.ace-chrome .ace_cursor {
  color: black;
}

.ace-chrome .ace_invisible {
  color: rgb(191, 191, 191);
}

.ace-chrome .ace_constant.ace_buildin {
  color: rgb(88, 72, 246);
}

.ace-chrome .ace_constant.ace_language {
  color: rgb(88, 92, 246);
}

.ace-chrome .ace_constant.ace_library {
  color: rgb(6, 150, 14);
}

.ace-chrome .ace_invalid {
  background-color: rgb(153, 0, 0);
  color: white;
}

.ace-chrome .ace_fold {
}

.ace-chrome .ace_support.ace_function {
  color: rgb(60, 76, 114);
}

.ace-chrome .ace_support.ace_constant {
  color: rgb(6, 150, 14);
}

.ace-chrome .ace_support.ace_type,
.ace-chrome .ace_support.ace_class
.ace-chrome .ace_support.ace_other {
  color: rgb(109, 121, 222);
}

.ace-chrome .ace_variable.ace_parameter {
  font-style:italic;
  color:#FD971F;
}
.ace-chrome .ace_keyword.ace_operator {
  color: rgb(104, 118, 135);
}

.ace-chrome .ace_comment {
  color: #236e24;
}

.ace-chrome .ace_comment.ace_doc {
  color: #236e24;
}

.ace-chrome .ace_comment.ace_doc.ace_tag {
  color: #236e24;
}

.ace-chrome .ace_constant.ace_numeric {
  color: rgb(0, 0, 205);
}

.ace-chrome .ace_variable {
  color: rgb(49, 132, 149);
}

.ace-chrome .ace_xml-pe {
  color: rgb(104, 104, 91);
}

.ace-chrome .ace_entity.ace_name.ace_function {
  color: #0000A2;
}


.ace-chrome .ace_heading {
  color: rgb(12, 7, 255);
}

.ace-chrome .ace_list {
  color:rgb(185, 6, 144);
}

.ace-chrome .ace_marker-layer .ace_selection {
  background: rgb(181, 213, 255);
}

.ace-chrome .ace_marker-layer .ace_step {
  background: rgb(252, 255, 0);
}

.ace-chrome .ace_marker-layer .ace_stack {
  background: rgb(164, 229, 101);
}

.ace-chrome .ace_marker-layer .ace_bracket {
  margin: -1px 0 0 -1px;
  border: 1px solid rgb(192, 192, 192);
}

.ace-chrome .ace_marker-layer .ace_active-line {
  background: rgba(0, 0, 0, 0.07);
}

.ace-chrome .ace_gutter-active-line {
    background-color : #dcdcdc;
}

.ace-chrome .ace_marker-layer .ace_selected-word {
  background: rgb(250, 250, 255);
  border: 1px solid rgb(200, 200, 250);
}

.ace-chrome .ace_storage,
.ace-chrome .ace_keyword,
.ace-chrome .ace_meta.ace_tag {
  color: rgb(147, 15, 128);
}

.ace-chrome .ace_string.ace_regex {
  color: rgb(255, 0, 0)
}

.ace-chrome .ace_string {
  color: #1A1AA6;
}

.ace-chrome .ace_entity.ace_other.ace_attribute-name {
  color: #994409;
}

.ace-chrome .ace_indent-guide {
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;
}
  
.ace-chrome .ace_indent-guide-active {
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAZSURBVHjaYvj///9/hivKyv8BAAAA//8DACLqBhbvk+/eAAAAAElFTkSuQmCC") right repeat-y;
}
`}),ace.define("ace/theme/chrome",["require","exports","module","ace/theme/chrome-css","ace/lib/dom"],function(t,s,i){s.isDark=!1,s.cssClass="ace-chrome",s.cssText=t("./chrome-css");var n=t("../lib/dom");n.importCssString(s.cssText,s.cssClass,!1)}),function(){ace.require(["ace/theme/chrome"],function(t){h&&(h.exports=t)})}()})(on);var an={exports:{}};(function(h,e){ace.define("ace/snippets",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/range_list","ace/keyboard/hash_handler","ace/tokenizer","ace/clipboard","ace/editor"],function(t,s,i){function n(p){var g=new Date().toLocaleString("en-us",p);return g.length==1?"0"+g:g}var r=t("./lib/dom"),a=t("./lib/oop"),l=t("./lib/event_emitter").EventEmitter,c=t("./lib/lang"),u=t("./range").Range,m=t("./range_list").RangeList,y=t("./keyboard/hash_handler").HashHandler,_=t("./tokenizer").Tokenizer,T=t("./clipboard"),A={CURRENT_WORD:function(p){return p.session.getTextRange(p.session.getWordRange())},SELECTION:function(p,g,f){var v=p.session.getTextRange();return f?v.replace(/\n\r?([ \t]*\S)/g,`
`+f+"$1"):v},CURRENT_LINE:function(p){return p.session.getLine(p.getCursorPosition().row)},PREV_LINE:function(p){return p.session.getLine(p.getCursorPosition().row-1)},LINE_INDEX:function(p){return p.getCursorPosition().row},LINE_NUMBER:function(p){return p.getCursorPosition().row+1},SOFT_TABS:function(p){return p.session.getUseSoftTabs()?"YES":"NO"},TAB_SIZE:function(p){return p.session.getTabSize()},CLIPBOARD:function(p){return T.getText&&T.getText()},FILENAME:function(p){return/[^/\\]*$/.exec(this.FILEPATH(p))[0]},FILENAME_BASE:function(p){return/[^/\\]*$/.exec(this.FILEPATH(p))[0].replace(/\.[^.]*$/,"")},DIRECTORY:function(p){return this.FILEPATH(p).replace(/[^/\\]*$/,"")},FILEPATH:function(p){return"/not implemented.txt"},WORKSPACE_NAME:function(){return"Unknown"},FULLNAME:function(){return"Unknown"},BLOCK_COMMENT_START:function(p){var g=p.session.$mode||{};return g.blockComment&&g.blockComment.start||""},BLOCK_COMMENT_END:function(p){var g=p.session.$mode||{};return g.blockComment&&g.blockComment.end||""},LINE_COMMENT:function(p){var g=p.session.$mode||{};return g.lineCommentStart||""},CURRENT_YEAR:n.bind(null,{year:"numeric"}),CURRENT_YEAR_SHORT:n.bind(null,{year:"2-digit"}),CURRENT_MONTH:n.bind(null,{month:"numeric"}),CURRENT_MONTH_NAME:n.bind(null,{month:"long"}),CURRENT_MONTH_NAME_SHORT:n.bind(null,{month:"short"}),CURRENT_DATE:n.bind(null,{day:"2-digit"}),CURRENT_DAY_NAME:n.bind(null,{weekday:"long"}),CURRENT_DAY_NAME_SHORT:n.bind(null,{weekday:"short"}),CURRENT_HOUR:n.bind(null,{hour:"2-digit",hour12:!1}),CURRENT_MINUTE:n.bind(null,{minute:"2-digit"}),CURRENT_SECOND:n.bind(null,{second:"2-digit"})};A.SELECTED_TEXT=A.SELECTION;var w=function(){function p(){this.snippetMap={},this.snippetNameMap={},this.variables=A}return p.prototype.getTokenizer=function(){return p.$tokenizer||this.createTokenizer()},p.prototype.createTokenizer=function(){function g(E){return E=E.substr(1),/^\d+$/.test(E)?[{tabstopId:parseInt(E,10)}]:[{text:E}]}function f(E){return"(?:[^\\\\"+E+"]|\\\\.)"}var v={regex:"/("+f("/")+"+)/",onMatch:function(E,B,$){var O=$[0];return O.fmtString=!0,O.guard=E.slice(1,-1),O.flag="",""},next:"formatString"};return p.$tokenizer=new _({start:[{regex:/\\./,onMatch:function(E,B,$){var O=E[1];return(O=="}"&&$.length||"`$\\".indexOf(O)!=-1)&&(E=O),[E]}},{regex:/}/,onMatch:function(E,B,$){return[$.length?$.shift():E]}},{regex:/\$(?:\d+|\w+)/,onMatch:g},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(E,B,$){var O=g(E.substr(1));return $.unshift(O[0]),O},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+f("\\|")+"*\\|",onMatch:function(E,B,$){var O=E.slice(1,-1).replace(/\\[,|\\]|,/g,function(I){return I.length==2?I[1]:"\0"}).split("\0").map(function(I){return{value:I}});return $[0].choices=O,[O[0]]},next:"start"},v,{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:/:/,onMatch:function(E,B,$){return $.length&&$[0].expectElse?($[0].expectElse=!1,$[0].ifEnd={elseEnd:$[0]},[$[0].ifEnd]):":"}},{regex:/\\./,onMatch:function(E,B,$){var O=E[1];return O=="}"&&$.length||"`$\\".indexOf(O)!=-1?E=O:O=="n"?E=`
`:O=="t"?E="	":"ulULE".indexOf(O)!=-1&&(E={changeCase:O,local:O>"a"}),[E]}},{regex:"/\\w*}",onMatch:function(E,B,$){var O=$.shift();return O&&(O.flag=E.slice(1,-1)),this.next=O&&O.tabstopId?"start":"",[O||E]},next:"start"},{regex:/\$(?:\d+|\w+)/,onMatch:function(E,B,$){return[{text:E.slice(1)}]}},{regex:/\${\w+/,onMatch:function(E,B,$){var O={text:E.slice(2)};return $.unshift(O),[O]},next:"formatStringVar"},{regex:/\n/,token:"newline",merge:!1},{regex:/}/,onMatch:function(E,B,$){var O=$.shift();return this.next=O&&O.tabstopId?"start":"",[O||E]},next:"start"}],formatStringVar:[{regex:/:\/\w+}/,onMatch:function(E,B,$){var O=$[0];return O.formatFunction=E.slice(2,-1),[$.shift()]},next:"formatString"},v,{regex:/:[\?\-+]?/,onMatch:function(E,B,$){E[1]=="+"&&($[0].ifEnd=$[0]),E[1]=="?"&&($[0].expectElse=!0)},next:"formatString"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"formatString"}]}),p.$tokenizer},p.prototype.tokenizeTmSnippet=function(g,f){return this.getTokenizer().getLineTokens(g,f).tokens.map(function(v){return v.value||v})},p.prototype.getVariableValue=function(g,f,v){if(/^\d+$/.test(f))return(this.variables.__||{})[f]||"";if(/^[A-Z]\d+$/.test(f))return(this.variables[f[0]+"__"]||{})[f.substr(1)]||"";if(f=f.replace(/^TM_/,""),!this.variables.hasOwnProperty(f))return"";var E=this.variables[f];return typeof E=="function"&&(E=this.variables[f](g,f,v)),E??""},p.prototype.tmStrFormat=function(g,f,v){if(!f.fmt)return g;var E=f.flag||"",B=f.guard;B=new RegExp(B,E.replace(/[^gim]/g,""));var $=typeof f.fmt=="string"?this.tokenizeTmSnippet(f.fmt,"formatString"):f.fmt,O=this,I=g.replace(B,function(){var k=O.variables.__;O.variables.__=[].slice.call(arguments);for(var M=O.resolveVariables($,v),z="E",W=0;W<M.length;W++){var H=M[W];if(typeof H=="object")if(M[W]="",H.changeCase&&H.local){var J=M[W+1];J&&typeof J=="string"&&(H.changeCase=="u"?M[W]=J[0].toUpperCase():M[W]=J[0].toLowerCase(),M[W+1]=J.substr(1))}else H.changeCase&&(z=H.changeCase);else z=="U"?M[W]=H.toUpperCase():z=="L"&&(M[W]=H.toLowerCase())}return O.variables.__=k,M.join("")});return I},p.prototype.tmFormatFunction=function(g,f,v){return f.formatFunction=="upcase"?g.toUpperCase():f.formatFunction=="downcase"?g.toLowerCase():g},p.prototype.resolveVariables=function(g,f){function v(z){var W=g.indexOf(z,O+1);W!=-1&&(O=W)}for(var E=[],B="",$=!0,O=0;O<g.length;O++){var I=g[O];if(typeof I=="string"){E.push(I),I==`
`?($=!0,B=""):$&&(B=/^\t*/.exec(I)[0],$=/\S/.test(I));continue}if(I){if($=!1,I.fmtString){var k=g.indexOf(I,O+1);k==-1&&(k=g.length),I.fmt=g.slice(O+1,k),O=k}if(I.text){var M=this.getVariableValue(f,I.text,B)+"";I.fmtString&&(M=this.tmStrFormat(M,I,f)),I.formatFunction&&(M=this.tmFormatFunction(M,I,f)),M&&!I.ifEnd?(E.push(M),v(I)):!M&&I.ifEnd&&v(I.ifEnd)}else I.elseEnd?v(I.elseEnd):(I.tabstopId!=null||I.changeCase!=null)&&E.push(I)}}return E},p.prototype.getDisplayTextForSnippet=function(g,f){var v=F.call(this,g,f);return v.text},p.prototype.insertSnippetForSelection=function(g,f,v){v===void 0&&(v={});var E=F.call(this,g,f,v),B=g.getSelectionRange(),$=g.session.replace(B,E.text),O=new S(g),I=g.inVirtualSelectionMode&&g.selection.index;O.addTabstops(E.tabstops,B.start,$,I)},p.prototype.insertSnippet=function(g,f,v){v===void 0&&(v={});var E=this;if(g.inVirtualSelectionMode)return E.insertSnippetForSelection(g,f,v);g.forEachSelection(function(){E.insertSnippetForSelection(g,f,v)},null,{keepOrder:!0}),g.tabstopManager&&g.tabstopManager.tabNext()},p.prototype.$getScope=function(g){var f=g.session.$mode.$id||"";if(f=f.split("/").pop(),f==="html"||f==="php"){f==="php"&&!g.session.$mode.inlinePhp&&(f="html");var v=g.getCursorPosition(),E=g.session.getState(v.row);typeof E=="object"&&(E=E[0]),E.substring&&(E.substring(0,3)=="js-"?f="javascript":E.substring(0,4)=="css-"?f="css":E.substring(0,4)=="php-"&&(f="php"))}return f},p.prototype.getActiveScopes=function(g){var f=this.$getScope(g),v=[f],E=this.snippetMap;return E[f]&&E[f].includeScopes&&v.push.apply(v,E[f].includeScopes),v.push("_"),v},p.prototype.expandWithTab=function(g,f){var v=this,E=g.forEachSelection(function(){return v.expandSnippetForSelection(g,f)},null,{keepOrder:!0});return E&&g.tabstopManager&&g.tabstopManager.tabNext(),E},p.prototype.expandSnippetForSelection=function(g,f){var v=g.getCursorPosition(),E=g.session.getLine(v.row),B=E.substring(0,v.column),$=E.substr(v.column),O=this.snippetMap,I;return this.getActiveScopes(g).some(function(k){var M=O[k];return M&&(I=this.findMatchingSnippet(M,B,$)),!!I},this),I?(f&&f.dryRun||(g.session.doc.removeInLine(v.row,v.column-I.replaceBefore.length,v.column+I.replaceAfter.length),this.variables.M__=I.matchBefore,this.variables.T__=I.matchAfter,this.insertSnippetForSelection(g,I.content),this.variables.M__=this.variables.T__=null),!0):!1},p.prototype.findMatchingSnippet=function(g,f,v){for(var E=g.length;E--;){var B=g[E];if(!(B.startRe&&!B.startRe.test(f))&&!(B.endRe&&!B.endRe.test(v))&&!(!B.startRe&&!B.endRe))return B.matchBefore=B.startRe?B.startRe.exec(f):[""],B.matchAfter=B.endRe?B.endRe.exec(v):[""],B.replaceBefore=B.triggerRe?B.triggerRe.exec(f)[0]:"",B.replaceAfter=B.endTriggerRe?B.endTriggerRe.exec(v)[0]:"",B}},p.prototype.register=function(g,f){function v(k){return k&&!/^\^?\(.*\)\$?$|^\\b$/.test(k)&&(k="(?:"+k+")"),k||""}function E(k,M,z){return k=v(k),M=v(M),k=M+k,k&&k[k.length-1]!="$"&&(k+="$"),new RegExp(k)}function B(k){k.scope||(k.scope=f||"_"),f=k.scope,$[f]||($[f]=[],O[f]={});var M=O[f];if(k.name){var z=M[k.name];z&&I.unregister(z),M[k.name]=k}$[f].push(k),k.prefix&&(k.tabTrigger=k.prefix),!k.content&&k.body&&(k.content=Array.isArray(k.body)?k.body.join(`
`):k.body),k.tabTrigger&&!k.trigger&&(!k.guard&&/^\w/.test(k.tabTrigger)&&(k.guard="\\b"),k.trigger=c.escapeRegExp(k.tabTrigger)),!(!k.trigger&&!k.guard&&!k.endTrigger&&!k.endGuard)&&(k.startRe=E(k.trigger,k.guard),k.triggerRe=new RegExp(k.trigger),k.endRe=E(k.endTrigger,k.endGuard),k.endTriggerRe=new RegExp(k.endTrigger))}var $=this.snippetMap,O=this.snippetNameMap,I=this;g||(g=[]),Array.isArray(g)?g.forEach(B):Object.keys(g).forEach(function(k){B(g[k])}),this._signal("registerSnippets",{scope:f})},p.prototype.unregister=function(g,f){function v($){var O=B[$.scope||f];if(O&&O[$.name]){delete O[$.name];var I=E[$.scope||f],k=I&&I.indexOf($);k>=0&&I.splice(k,1)}}var E=this.snippetMap,B=this.snippetNameMap;g.content?v(g):Array.isArray(g)&&g.forEach(v)},p.prototype.parseSnippetFile=function(g){g=g.replace(/\r/g,"");for(var f=[],v={},E=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm,B;B=E.exec(g);){if(B[1])try{v=JSON.parse(B[1]),f.push(v)}catch{}if(B[4])v.content=B[4].replace(/^\t/gm,""),f.push(v),v={};else{var $=B[2],O=B[3];if($=="regex"){var I=/\/((?:[^\/\\]|\\.)*)|$/g;v.guard=I.exec(O)[1],v.trigger=I.exec(O)[1],v.endTrigger=I.exec(O)[1],v.endGuard=I.exec(O)[1]}else $=="snippet"?(v.tabTrigger=O.match(/^\S*/)[0],v.name||(v.name=O)):$&&(v[$]=O)}}return f},p.prototype.getSnippetByName=function(g,f){var v=this.snippetNameMap,E;return this.getActiveScopes(f).some(function(B){var $=v[B];return $&&(E=$[g]),!!E},this),E},p}();a.implement(w.prototype,l);var F=function(p,g,f){function v(G){for(var ne=[],pe=0;pe<G.length;pe++){var ee=G[pe];if(typeof ee=="object"){if(M[ee.tabstopId])continue;var ke=G.lastIndexOf(ee,pe-1);ee=ne[ke]||{tabstopId:ee.tabstopId}}ne[pe]=ee}return ne}f===void 0&&(f={});var E=p.getCursorPosition(),B=p.session.getLine(E.row),$=p.session.getTabString(),O=B.match(/^\s*/)[0];E.column<O.length&&(O=O.slice(0,E.column)),g=g.replace(/\r/g,"");var I=this.tokenizeTmSnippet(g);I=this.resolveVariables(I,p),I=I.map(function(G){return G==`
`&&!f.excludeExtraIndent?G+O:typeof G=="string"?G.replace(/\t/g,$):G});var k=[];I.forEach(function(G,ne){if(typeof G=="object"){var pe=G.tabstopId,ee=k[pe];if(ee||(ee=k[pe]=[],ee.index=pe,ee.value="",ee.parents={}),ee.indexOf(G)===-1){G.choices&&!ee.choices&&(ee.choices=G.choices),ee.push(G);var ke=I.indexOf(G,ne+1);if(ke!==-1){var Be=I.slice(ne+1,ke),$t=Be.some(function(Lt){return typeof Lt=="object"});$t&&!ee.value?ee.value=Be:Be.length&&(!ee.value||typeof ee.value!="string")&&(ee.value=Be.join(""))}}}}),k.forEach(function(G){G.length=0});for(var M={},z=0;z<I.length;z++){var W=I[z];if(typeof W=="object"){var H=W.tabstopId,J=k[H],N=I.indexOf(W,z+1);if(M[H]){M[H]===W&&(delete M[H],Object.keys(M).forEach(function(G){J.parents[G]=!0}));continue}M[H]=W;var j=J.value;typeof j!="string"?j=v(j):W.fmt&&(j=this.tmStrFormat(j,W,p)),I.splice.apply(I,[z+1,Math.max(0,N-z)].concat(j,W)),J.indexOf(W)===-1&&J.push(W)}}var V=0,U=0,ce="";return I.forEach(function(G){if(typeof G=="string"){var ne=G.split(`
`);ne.length>1?(U=ne[ne.length-1].length,V+=ne.length-1):U+=G.length,ce+=G}else G&&(G.start?G.end={row:V,column:U}:G.start={row:V,column:U})}),{text:ce,tabstops:k,tokens:I}},S=function(){function p(g){if(this.index=0,this.ranges=[],this.tabstops=[],g.tabstopManager)return g.tabstopManager;g.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=c.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(g)}return p.prototype.attach=function(g){this.$openTabstops=null,this.selectedTabstop=null,this.editor=g,this.session=g.session,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},p.prototype.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges.length=0,this.tabstops.length=0,this.selectedTabstop=null,this.editor.off("change",this.$onChange),this.editor.off("changeSelection",this.$onChangeSelection),this.editor.off("changeSession",this.$onChangeSession),this.editor.commands.off("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.session=null,this.editor=null},p.prototype.onChange=function(g){for(var f=g.action[0]=="r",v=this.selectedTabstop||{},E=v.parents||{},B=this.tabstops.slice(),$=0;$<B.length;$++){var O=B[$],I=O==v||E[O.index];if(O.rangeList.$bias=I?0:1,g.action=="remove"&&O!==v){var k=O.parents&&O.parents[v.index],M=O.rangeList.pointIndex(g.start,k);M=M<0?-M-1:M+1;var z=O.rangeList.pointIndex(g.end,k);z=z<0?-z-1:z-1;for(var W=O.rangeList.ranges.slice(M,z),H=0;H<W.length;H++)this.removeRange(W[H])}O.rangeList.$onChange(g)}var J=this.session;!this.$inChange&&f&&J.getLength()==1&&!J.getValue()&&this.detach()},p.prototype.updateLinkedFields=function(){var g=this.selectedTabstop;if(!(!g||!g.hasLinkedRanges||!g.firstNonLinked)){this.$inChange=!0;for(var f=this.session,v=f.getTextRange(g.firstNonLinked),E=0;E<g.length;E++){var B=g[E];if(B.linked){var $=B.original,O=s.snippetManager.tmStrFormat(v,$,this.editor);f.replace(B,O)}}this.$inChange=!1}},p.prototype.onAfterExec=function(g){g.command&&!g.command.readOnly&&this.updateLinkedFields()},p.prototype.onChangeSelection=function(){if(this.editor){for(var g=this.editor.selection.lead,f=this.editor.selection.anchor,v=this.editor.selection.isEmpty(),E=0;E<this.ranges.length;E++)if(!this.ranges[E].linked){var B=this.ranges[E].contains(g.row,g.column),$=v||this.ranges[E].contains(f.row,f.column);if(B&&$)return}this.detach()}},p.prototype.onChangeSession=function(){this.detach()},p.prototype.tabNext=function(g){var f=this.tabstops.length,v=this.index+(g||1);v=Math.min(Math.max(v,1),f),v==f&&(v=0),this.selectTabstop(v),this.updateTabstopMarkers(),v===0&&this.detach()},p.prototype.selectTabstop=function(g){this.$openTabstops=null;var f=this.tabstops[this.index];if(f&&this.addTabstopMarkers(f),this.index=g,f=this.tabstops[this.index],!(!f||!f.length)){this.selectedTabstop=f;var v=f.firstNonLinked||f;if(f.choices&&(v.cursor=v.start),this.editor.inVirtualSelectionMode)this.editor.selection.fromOrientedRange(v);else{var E=this.editor.multiSelect;E.toSingleRange(v);for(var B=0;B<f.length;B++)f.hasLinkedRanges&&f[B].linked||E.addRange(f[B].clone(),!0)}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler),this.selectedTabstop&&this.selectedTabstop.choices&&this.editor.execCommand("startAutocomplete",{matches:this.selectedTabstop.choices})}},p.prototype.addTabstops=function(g,f,v){var E=this.useLink||!this.editor.getOption("enableMultiselect");if(this.$openTabstops||(this.$openTabstops=[]),!g[0]){var B=u.fromPoints(v,v);x(B.start,f),x(B.end,f),g[0]=[B],g[0].index=0}var $=this.index,O=[$+1,0],I=this.ranges,k=this.snippetId=(this.snippetId||0)+1;g.forEach(function(M,z){var W=this.$openTabstops[z]||M;W.snippetId=k;for(var H=0;H<M.length;H++){var J=M[H],N=u.fromPoints(J.start,J.end||J.start);L(N.start,f),L(N.end,f),N.original=J,N.tabstop=W,I.push(N),W!=M?W.unshift(N):W[H]=N,J.fmtString||W.firstNonLinked&&E?(N.linked=!0,W.hasLinkedRanges=!0):W.firstNonLinked||(W.firstNonLinked=N)}W.firstNonLinked||(W.hasLinkedRanges=!1),W===M&&(O.push(W),this.$openTabstops[z]=W),this.addTabstopMarkers(W),W.rangeList=W.rangeList||new m,W.rangeList.$bias=0,W.rangeList.addList(W)},this),O.length>2&&(this.tabstops.length&&O.push(O.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,O))},p.prototype.addTabstopMarkers=function(g){var f=this.session;g.forEach(function(v){v.markerId||(v.markerId=f.addMarker(v,"ace_snippet-marker","text"))})},p.prototype.removeTabstopMarkers=function(g){var f=this.session;g.forEach(function(v){f.removeMarker(v.markerId),v.markerId=null})},p.prototype.updateTabstopMarkers=function(){if(this.selectedTabstop){var g=this.selectedTabstop.snippetId;this.selectedTabstop.index===0&&g--,this.tabstops.forEach(function(f){f.snippetId===g?this.addTabstopMarkers(f):this.removeTabstopMarkers(f)},this)}},p.prototype.removeRange=function(g){var f=g.tabstop.indexOf(g);f!=-1&&g.tabstop.splice(f,1),f=this.ranges.indexOf(g),f!=-1&&this.ranges.splice(f,1),f=g.tabstop.rangeList.ranges.indexOf(g),f!=-1&&g.tabstop.splice(f,1),this.session.removeMarker(g.markerId),g.tabstop.length||(f=this.tabstops.indexOf(g.tabstop),f!=-1&&this.tabstops.splice(f,1),this.tabstops.length||this.detach())},p}();S.prototype.keyboardHandler=new y,S.prototype.keyboardHandler.bindKeys({Tab:function(p){s.snippetManager&&s.snippetManager.expandWithTab(p)||(p.tabstopManager.tabNext(1),p.renderer.scrollCursorIntoView())},"Shift-Tab":function(p){p.tabstopManager.tabNext(-1),p.renderer.scrollCursorIntoView()},Esc:function(p){p.tabstopManager.detach()}});var L=function(p,g){p.row==0&&(p.column+=g.column),p.row+=g.row},x=function(p,g){p.row==g.row&&(p.column-=g.column),p.row-=g.row};r.importCssString(`
.ace_snippet-marker {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    background: rgba(194, 193, 208, 0.09);
    border: 1px dotted rgba(211, 208, 235, 0.62);
    position: absolute;
}`,"snippets.css",!1),s.snippetManager=new w;var C=t("./editor").Editor;(function(){this.insertSnippet=function(p,g){return s.snippetManager.insertSnippet(this,p,g)},this.expandSnippet=function(p){return s.snippetManager.expandWithTab(this,p)}}).call(C.prototype)}),ace.define("ace/autocomplete/popup",["require","exports","module","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/config","ace/lib/useragent"],function(t,s,i){var n=t("../virtual_renderer").VirtualRenderer,r=t("../editor").Editor,a=t("../range").Range,l=t("../lib/event"),c=t("../lib/lang"),u=t("../lib/dom"),m=t("../config").nls,y=t("./../lib/useragent"),_=function(L){return"suggest-aria-id:".concat(L)},T=y.isSafari?"menu":"listbox",A=y.isSafari?"menuitem":"option",w=y.isSafari?"aria-current":"aria-selected",F=function(L){var x=new n(L);x.$maxLines=4;var C=new r(x);return C.setHighlightActiveLine(!1),C.setShowPrintMargin(!1),C.renderer.setShowGutter(!1),C.renderer.setHighlightGutterLine(!1),C.$mouseHandler.$focusTimeout=0,C.$highlightTagPending=!0,C},S=function(){function L(x){var C=u.createElement("div"),p=F(C);x&&x.appendChild(C),C.style.display="none",p.renderer.content.style.cursor="default",p.renderer.setStyle("ace_autocomplete"),p.renderer.$textLayer.element.setAttribute("role",T),p.renderer.$textLayer.element.setAttribute("aria-roledescription",m("autocomplete.popup.aria-roledescription","Autocomplete suggestions")),p.renderer.$textLayer.element.setAttribute("aria-label",m("autocomplete.popup.aria-label","Autocomplete suggestions")),p.renderer.textarea.setAttribute("aria-hidden","true"),p.setOption("displayIndentGuides",!1),p.setOption("dragDelay",150);var g=function(){};p.focus=g,p.$isFocused=!0,p.renderer.$cursorLayer.restartTimer=g,p.renderer.$cursorLayer.element.style.opacity="0",p.renderer.$maxLines=8,p.renderer.$keepTextAreaAtCursor=!1,p.setHighlightActiveLine(!1),p.session.highlight(""),p.session.$searchHighlight.clazz="ace_highlight-marker",p.on("mousedown",function(I){var k=I.getDocumentPosition();p.selection.moveToPosition(k),E.start.row=E.end.row=k.row,I.stop()});var f,v=new a(-1,0,-1,1/0),E=new a(-1,0,-1,1/0);E.id=p.session.addMarker(E,"ace_active-line","fullLine"),p.setSelectOnHover=function(I){I?v.id&&(p.session.removeMarker(v.id),v.id=null):v.id=p.session.addMarker(v,"ace_line-hover","fullLine")},p.setSelectOnHover(!1),p.on("mousemove",function(I){if(!f){f=I;return}if(!(f.x==I.x&&f.y==I.y)){f=I,f.scrollTop=p.renderer.scrollTop,p.isMouseOver=!0;var k=f.getDocumentPosition().row;v.start.row!=k&&(v.id||p.setRow(k),$(k))}}),p.renderer.on("beforeRender",function(){if(f&&v.start.row!=-1){f.$pos=null;var I=f.getDocumentPosition().row;v.id||p.setRow(I),$(I,!0)}}),p.renderer.on("afterRender",function(){for(var I=p.renderer.$textLayer,k=I.config.firstRow,M=I.config.lastRow;k<=M;k++){var z=I.element.childNodes[k-I.config.firstRow];z.setAttribute("role",A),z.setAttribute("aria-roledescription",m("autocomplete.popup.item.aria-roledescription","item")),z.setAttribute("aria-setsize",p.data.length),z.setAttribute("aria-describedby","doc-tooltip"),z.setAttribute("aria-posinset",k+1);var W=p.getData(k);if(W){var H="".concat(W.caption||W.value).concat(W.meta?", ".concat(W.meta):"");z.setAttribute("aria-label",H)}var J=z.querySelectorAll(".ace_completion-highlight");J.forEach(function(N){N.setAttribute("role","mark")})}}),p.renderer.on("afterRender",function(){var I=p.getRow(),k=p.renderer.$textLayer,M=k.element.childNodes[I-k.config.firstRow],z=document.activeElement;if(M!==p.selectedNode&&p.selectedNode&&(u.removeCssClass(p.selectedNode,"ace_selected"),p.selectedNode.removeAttribute(w),p.selectedNode.removeAttribute("id")),z.removeAttribute("aria-activedescendant"),p.selectedNode=M,M){var W=_(I);u.addCssClass(M,"ace_selected"),M.id=W,k.element.setAttribute("aria-activedescendant",W),z.setAttribute("aria-activedescendant",W),M.setAttribute(w,"true")}});var B=function(){$(-1)},$=function(I,k){I!==v.start.row&&(v.start.row=v.end.row=I,k||p.session._emit("changeBackMarker"),p._emit("changeHoverMarker"))};p.getHoveredRow=function(){return v.start.row},l.addListener(p.container,"mouseout",function(){p.isMouseOver=!1,B()}),p.on("hide",B),p.on("changeSelection",B),p.session.doc.getLength=function(){return p.data.length},p.session.doc.getLine=function(I){var k=p.data[I];return typeof k=="string"?k:k&&k.value||""};var O=p.session.bgTokenizer;return O.$tokenizeRow=function(I){function k(G,ne){G&&z.push({type:(M.className||"")+(ne||""),value:G})}var M=p.data[I],z=[];if(!M)return z;typeof M=="string"&&(M={value:M});for(var W=M.caption||M.value||M.name,H=W.toLowerCase(),J=(p.filterText||"").toLowerCase(),N=0,j=0,V=0;V<=J.length;V++)if(V!=j&&(M.matchMask&1<<V||V==J.length)){var U=J.slice(j,V);j=V;var ce=H.indexOf(U,N);if(ce==-1)continue;k(W.slice(N,ce),""),N=ce+U.length,k(W.slice(ce,N),"completion-highlight")}return k(W.slice(N,W.length),""),z.push({type:"completion-spacer",value:" "}),M.meta&&z.push({type:"completion-meta",value:M.meta}),M.message&&z.push({type:"completion-message",value:M.message}),z},O.$updateOnChange=g,O.start=g,p.session.$computeWidth=function(){return this.screenWidth=0},p.isOpen=!1,p.isTopdown=!1,p.autoSelect=!0,p.filterText="",p.isMouseOver=!1,p.data=[],p.setData=function(I,k){p.filterText=k||"",p.setValue(c.stringRepeat(`
`,I.length),-1),p.data=I||[],p.setRow(0)},p.getData=function(I){return p.data[I]},p.getRow=function(){return E.start.row},p.setRow=function(I){I=Math.max(this.autoSelect?0:-1,Math.min(this.data.length-1,I)),E.start.row!=I&&(p.selection.clearSelection(),E.start.row=E.end.row=I||0,p.session._emit("changeBackMarker"),p.moveCursorTo(I||0,0),p.isOpen&&p._signal("select"))},p.on("changeSelection",function(){p.isOpen&&p.setRow(p.selection.lead.row),p.renderer.scrollCursorIntoView()}),p.hide=function(){this.container.style.display="none",p.anchorPos=null,p.anchor=null,p.isOpen&&(p.isOpen=!1,this._signal("hide"))},p.tryShow=function(I,k,M,z){if(!z&&p.isOpen&&p.anchorPos&&p.anchor&&p.anchorPos.top===I.top&&p.anchorPos.left===I.left&&p.anchor===M)return!0;var W=this.container,H=window.innerHeight,J=window.innerWidth,N=this.renderer,j=N.$maxLines*k*1.4,V={top:0,bottom:0},U=H-I.top-3*this.$borderSize-k,ce=I.top-3*this.$borderSize;M||(ce<=U||U>=j?M="bottom":M="top"),M==="top"?(V.bottom=I.top-this.$borderSize,V.top=V.bottom-j):M==="bottom"&&(V.top=I.top+k+this.$borderSize,V.bottom=V.top+j);var G=V.top>=0&&V.bottom<=H;if(!z&&!G)return!1;G?N.$maxPixelHeight=null:M==="top"?N.$maxPixelHeight=ce:N.$maxPixelHeight=U,M==="top"?(W.style.top="",W.style.bottom=H-V.bottom+"px",p.isTopdown=!1):(W.style.top=V.top+"px",W.style.bottom="",p.isTopdown=!0),W.style.display="";var ne=I.left;return ne+W.offsetWidth>J&&(ne=J-W.offsetWidth),W.style.left=ne+"px",W.style.right="",p.isOpen||(p.isOpen=!0,this._signal("show"),f=null),p.anchorPos=I,p.anchor=M,!0},p.show=function(I,k,M){this.tryShow(I,k,M?"bottom":void 0,!0)},p.goTo=function(I){var k=this.getRow(),M=this.session.getLength()-1;switch(I){case"up":k=k<=0?M:k-1;break;case"down":k=k>=M?-1:k+1;break;case"start":k=0;break;case"end":k=M}this.setRow(k)},p.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},p.$imageSize=0,p.$borderSize=1,p}return L}();u.importCssString(`
.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #CAD6FA;
    z-index: 1;
}
.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #3a674e;
}
.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid #abbffe;
    margin-top: -1px;
    background: rgba(233,233,253,0.4);
    position: absolute;
    z-index: 2;
}
.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid rgba(109, 150, 13, 0.8);
    background: rgba(58, 103, 78, 0.62);
}
.ace_completion-meta {
    opacity: 0.5;
    margin-left: 0.9em;
}
.ace_completion-message {
    margin-left: 0.9em;
    color: blue;
}
.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #2d69c7;
}
.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #93ca12;
}
.ace_editor.ace_autocomplete {
    width: 300px;
    z-index: 200000;
    border: 1px lightgray solid;
    position: fixed;
    box-shadow: 2px 3px 5px rgba(0,0,0,.2);
    line-height: 1.4;
    background: #fefefe;
    color: #111;
}
.ace_dark.ace_editor.ace_autocomplete {
    border: 1px #484747 solid;
    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);
    line-height: 1.4;
    background: #25282c;
    color: #c1c1c1;
}
.ace_autocomplete .ace_text-layer  {
    width: calc(100% - 8px);
}
.ace_autocomplete .ace_line {
    display: flex;
    align-items: center;
}
.ace_autocomplete .ace_line > * {
    min-width: 0;
    flex: 0 0 auto;
}
.ace_autocomplete .ace_line .ace_ {
    flex: 0 1 auto;
    overflow: hidden;
    text-overflow: ellipsis;
}
.ace_autocomplete .ace_completion-spacer {
    flex: 1;
}
.ace_autocomplete.ace_loading:after  {
    content: "";
    position: absolute;
    top: 0px;
    height: 2px;
    width: 8%;
    background: blue;
    z-index: 100;
    animation: ace_progress 3s infinite linear;
    animation-delay: 300ms;
    transform: translateX(-100%) scaleX(1);
}
@keyframes ace_progress {
    0% { transform: translateX(-100%) scaleX(1) }
    50% { transform: translateX(625%) scaleX(2) } 
    100% { transform: translateX(1500%) scaleX(3) } 
}
@media (prefers-reduced-motion) {
    .ace_autocomplete.ace_loading:after {
        transform: translateX(625%) scaleX(2);
        animation: none;
     }
}
`,"autocompletion.css",!1),s.AcePopup=S,s.$singleLineEditor=F,s.getAriaId=_}),ace.define("ace/autocomplete/inline_screenreader",["require","exports","module"],function(t,s,i){var n=function(){function r(a){this.editor=a,this.screenReaderDiv=document.createElement("div"),this.screenReaderDiv.classList.add("ace_screenreader-only"),this.editor.container.appendChild(this.screenReaderDiv)}return r.prototype.setScreenReaderContent=function(a){for(!this.popup&&this.editor.completer&&this.editor.completer.popup&&(this.popup=this.editor.completer.popup,this.popup.renderer.on("afterRender",function(){var c=this.popup.getRow(),u=this.popup.renderer.$textLayer,m=u.element.childNodes[c-u.config.firstRow];if(m){for(var y="doc-tooltip ",_=0;_<this._lines.length;_++)y+="ace-inline-screenreader-line-".concat(_," ");m.setAttribute("aria-describedby",y)}}.bind(this)));this.screenReaderDiv.firstChild;)this.screenReaderDiv.removeChild(this.screenReaderDiv.firstChild);this._lines=a.split(/\r\n|\r|\n/);var l=this.createCodeBlock();this.screenReaderDiv.appendChild(l)},r.prototype.destroy=function(){this.screenReaderDiv.remove()},r.prototype.createCodeBlock=function(){var a=document.createElement("pre");a.setAttribute("id","ace-inline-screenreader");for(var l=0;l<this._lines.length;l++){var c=document.createElement("code");c.setAttribute("id","ace-inline-screenreader-line-".concat(l));var u=document.createTextNode(this._lines[l]);c.appendChild(u),a.appendChild(c)}return a},r}();s.AceInlineScreenReader=n}),ace.define("ace/autocomplete/inline",["require","exports","module","ace/snippets","ace/autocomplete/inline_screenreader"],function(t,s,i){var n=t("../snippets").snippetManager,r=t("./inline_screenreader").AceInlineScreenReader,a=function(){function l(){this.editor=null}return l.prototype.show=function(c,u,m){if(m=m||"",c&&this.editor&&this.editor!==c&&(this.hide(),this.editor=null,this.inlineScreenReader=null),!c||!u)return!1;this.inlineScreenReader||(this.inlineScreenReader=new r(c));var y=u.snippet?n.getDisplayTextForSnippet(c,u.snippet):u.value;return u.hideInlinePreview||!y||!y.startsWith(m)?!1:(this.editor=c,this.inlineScreenReader.setScreenReaderContent(y),y=y.slice(m.length),y===""?c.removeGhostText():c.setGhostText(y),!0)},l.prototype.isOpen=function(){return this.editor?!!this.editor.renderer.$ghostText:!1},l.prototype.hide=function(){return this.editor?(this.editor.removeGhostText(),!0):!1},l.prototype.destroy=function(){this.hide(),this.editor=null,this.inlineScreenReader&&(this.inlineScreenReader.destroy(),this.inlineScreenReader=null)},l}();s.AceInline=a}),ace.define("ace/autocomplete/util",["require","exports","module"],function(t,s,i){s.parForEach=function(r,a,l){var c=0,u=r.length;u===0&&l();for(var m=0;m<u;m++)a(r[m],function(y,_){c++,c===u&&l(y,_)})};var n=/[a-zA-Z_0-9\$\-\u00A2-\u2000\u2070-\uFFFF]/;s.retrievePrecedingIdentifier=function(r,a,l){l=l||n;for(var c=[],u=a-1;u>=0&&l.test(r[u]);u--)c.push(r[u]);return c.reverse().join("")},s.retrieveFollowingIdentifier=function(r,a,l){l=l||n;for(var c=[],u=a;u<r.length&&l.test(r[u]);u++)c.push(r[u]);return c},s.getCompletionPrefix=function(r){var a=r.getCursorPosition(),l=r.session.getLine(a.row),c;return r.completers.forEach(function(u){u.identifierRegexps&&u.identifierRegexps.forEach(function(m){!c&&m&&(c=this.retrievePrecedingIdentifier(l,a.column,m))}.bind(this))}.bind(this)),c||this.retrievePrecedingIdentifier(l,a.column)},s.triggerAutocomplete=function(r,l){var l=l??r.session.getPrecedingCharacter();return r.completers.some(function(c){if(c.triggerCharacters&&Array.isArray(c.triggerCharacters))return c.triggerCharacters.includes(l)})}}),ace.define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/inline","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/lang","ace/lib/dom","ace/snippets","ace/config","ace/lib/event","ace/lib/scroll"],function(t,s,i){var n=t("./keyboard/hash_handler").HashHandler,r=t("./autocomplete/popup").AcePopup,a=t("./autocomplete/inline").AceInline,l=t("./autocomplete/popup").getAriaId,c=t("./autocomplete/util"),u=t("./lib/lang"),m=t("./lib/dom"),y=t("./snippets").snippetManager,_=t("./config"),T=t("./lib/event"),A=t("./lib/scroll").preventParentScroll,w=function(x,C){C.completer&&C.completer.destroy()},F=function(){function x(){this.autoInsert=!1,this.autoSelect=!0,this.autoShown=!1,this.exactMatch=!1,this.inlineEnabled=!1,this.keyboardHandler=new n,this.keyboardHandler.bindKeys(this.commands),this.parentNode=null,this.setSelectOnHover=!1,this.hasSeen=new Set,this.showLoadingState=!1,this.stickySelectionDelay=500,this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.onLayoutChange=this.onLayoutChange.bind(this),this.changeTimer=u.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=u.delayedCall(this.updateDocTooltip.bind(this),50),this.popupTimer=u.delayedCall(this.$updatePopupPosition.bind(this),50),this.stickySelectionTimer=u.delayedCall(function(){this.stickySelection=!0}.bind(this),this.stickySelectionDelay),this.$firstOpenTimer=u.delayedCall(function(){var C=this.completionProvider&&this.completionProvider.initialPosition;this.autoShown||this.popup&&this.popup.isOpen||!C||this.editor.completers.length===0||(this.completions=new L(x.completionsForLoading),this.openPopup(this.editor,C.prefix,!1),this.popup.renderer.setStyle("ace_loading",!0))}.bind(this),this.stickySelectionDelay)}return Object.defineProperty(x,"completionsForLoading",{get:function(){return[{caption:_.nls("autocomplete.loading","Loading..."),value:""}]},enumerable:!1,configurable:!0}),x.prototype.$init=function(){return this.popup=new r(this.parentNode||document.body||document.documentElement),this.popup.on("click",function(C){this.insertMatch(),C.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.$onPopupShow.bind(this)),this.popup.on("hide",this.$onHidePopup.bind(this)),this.popup.on("select",this.$onPopupChange.bind(this)),T.addListener(this.popup.container,"mouseout",this.mouseOutListener.bind(this)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup.renderer.on("afterRender",this.$onPopupRender.bind(this)),this.popup},x.prototype.$initInline=function(){if(!(!this.inlineEnabled||this.inlineRenderer))return this.inlineRenderer=new a,this.inlineRenderer},x.prototype.getPopup=function(){return this.popup||this.$init()},x.prototype.$onHidePopup=function(){this.inlineRenderer&&this.inlineRenderer.hide(),this.hideDocTooltip(),this.stickySelectionTimer.cancel(),this.popupTimer.cancel(),this.stickySelection=!1},x.prototype.$seen=function(C){!this.hasSeen.has(C)&&C&&C.completer&&C.completer.onSeen&&typeof C.completer.onSeen=="function"&&(C.completer.onSeen(this.editor,C),this.hasSeen.add(C))},x.prototype.$onPopupChange=function(C){if(this.inlineRenderer&&this.inlineEnabled){var p=C?null:this.popup.getData(this.popup.getRow());if(this.$updateGhostText(p),this.popup.isMouseOver&&this.setSelectOnHover){this.tooltipTimer.call(null,null);return}this.popupTimer.schedule(),this.tooltipTimer.schedule()}else this.popupTimer.call(null,null),this.tooltipTimer.call(null,null)},x.prototype.$updateGhostText=function(C){var p=this.base.row,g=this.base.column,f=this.editor.getCursorPosition().column,v=this.editor.session.getLine(p).slice(g,f);this.inlineRenderer.show(this.editor,C,v)?this.$seen(C):this.inlineRenderer.hide()},x.prototype.$onPopupRender=function(){var C=this.inlineRenderer&&this.inlineEnabled;if(this.completions&&this.completions.filtered&&this.completions.filtered.length>0)for(var p=this.popup.getFirstVisibleRow();p<=this.popup.getLastVisibleRow();p++){var g=this.popup.getData(p);g&&(!C||g.hideInlinePreview)&&this.$seen(g)}},x.prototype.$onPopupShow=function(C){this.$onPopupChange(C),this.stickySelection=!1,this.stickySelectionDelay>=0&&this.stickySelectionTimer.schedule(this.stickySelectionDelay)},x.prototype.observeLayoutChanges=function(){if(!(this.$elements||!this.editor)){window.addEventListener("resize",this.onLayoutChange,{passive:!0}),window.addEventListener("wheel",this.mousewheelListener);for(var C=this.editor.container.parentNode,p=[];C;)p.push(C),C.addEventListener("scroll",this.onLayoutChange,{passive:!0}),C=C.parentNode;this.$elements=p}},x.prototype.unObserveLayoutChanges=function(){var C=this;window.removeEventListener("resize",this.onLayoutChange,{passive:!0}),window.removeEventListener("wheel",this.mousewheelListener),this.$elements&&this.$elements.forEach(function(p){p.removeEventListener("scroll",C.onLayoutChange,{passive:!0})}),this.$elements=null},x.prototype.onLayoutChange=function(){if(!this.popup.isOpen)return this.unObserveLayoutChanges();this.$updatePopupPosition(),this.updateDocTooltip()},x.prototype.$updatePopupPosition=function(){var C=this.editor,p=C.renderer,g=p.layerConfig.lineHeight,f=p.$cursorLayer.getPixelPosition(this.base,!0);f.left-=this.popup.getTextLeftOffset();var v=C.container.getBoundingClientRect();f.top+=v.top-p.layerConfig.offset,f.left+=v.left-C.renderer.scrollLeft,f.left+=p.gutterWidth;var E={top:f.top,left:f.left};p.$ghostText&&p.$ghostTextWidget&&this.base.row===p.$ghostText.position.row&&(E.top+=p.$ghostTextWidget.el.offsetHeight);var B=C.container.getBoundingClientRect().bottom-g,$=B<E.top?{top:B,left:E.left}:E;this.popup.tryShow($,g,"bottom")||this.popup.tryShow(f,g,"top")||this.popup.show(f,g)},x.prototype.openPopup=function(C,p,g){this.$firstOpenTimer.cancel(),this.popup||this.$init(),this.inlineEnabled&&!this.inlineRenderer&&this.$initInline(),this.popup.autoSelect=this.autoSelect,this.popup.setSelectOnHover(this.setSelectOnHover);var f=this.popup.getRow(),v=this.popup.data[f];this.popup.setData(this.completions.filtered,this.completions.filterText),this.editor.textInput.setAriaOptions&&this.editor.textInput.setAriaOptions({activeDescendant:l(this.popup.getRow()),inline:this.inlineEnabled}),C.keyBinding.addKeyboardHandler(this.keyboardHandler);var E;this.stickySelection&&(E=this.popup.data.indexOf(v)),(!E||E===-1)&&(E=0),this.popup.setRow(this.autoSelect?E:-1),E===f&&v!==this.completions.filtered[E]&&this.$onPopupChange();var B=this.inlineRenderer&&this.inlineEnabled;if(E===f&&B){var $=this.popup.getData(this.popup.getRow());this.$updateGhostText($)}g||(this.popup.setTheme(C.getTheme()),this.popup.setFontSize(C.getFontSize()),this.$updatePopupPosition(),this.tooltipNode&&this.updateDocTooltip()),this.changeTimer.cancel(),this.observeLayoutChanges()},x.prototype.detach=function(){this.editor&&(this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener)),this.$firstOpenTimer.cancel(),this.changeTimer.cancel(),this.hideDocTooltip(),this.completionProvider&&this.completionProvider.detach(),this.popup&&this.popup.isOpen&&this.popup.hide(),this.popup&&this.popup.renderer&&this.popup.renderer.off("afterRender",this.$onPopupRender),this.base&&this.base.detach(),this.activated=!1,this.completionProvider=this.completions=this.base=null,this.unObserveLayoutChanges()},x.prototype.changeListener=function(C){var p=this.editor.selection.lead;(p.row!=this.base.row||p.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},x.prototype.blurListener=function(C){var p=document.activeElement,g=this.editor.textInput.getElement(),f=C.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(C.relatedTarget),v=this.popup&&this.popup.container;p!=g&&p.parentNode!=v&&!f&&p!=this.tooltipNode&&C.relatedTarget!=g&&this.detach()},x.prototype.mousedownListener=function(C){this.detach()},x.prototype.mousewheelListener=function(C){this.popup&&!this.popup.isMouseOver&&this.detach()},x.prototype.mouseOutListener=function(C){this.popup.isOpen&&this.$updatePopupPosition()},x.prototype.goTo=function(C){this.popup.goTo(C)},x.prototype.insertMatch=function(C,p){if(C||(C=this.popup.getData(this.popup.getRow())),!C)return!1;if(C.value==="")return this.detach();var g=this.completions,f=this.getCompletionProvider().insertMatch(this.editor,C,g.filterText,p);return this.completions==g&&this.detach(),f},x.prototype.showPopup=function(C,p){this.editor&&this.detach(),this.activated=!0,this.editor=C,C.completer!=this&&(C.completer&&C.completer.detach(),C.completer=this),C.on("changeSelection",this.changeListener),C.on("blur",this.blurListener),C.on("mousedown",this.mousedownListener),C.on("mousewheel",this.mousewheelListener),this.updateCompletions(!1,p)},x.prototype.getCompletionProvider=function(C){return this.completionProvider||(this.completionProvider=new S(C)),this.completionProvider},x.prototype.gatherCompletions=function(C,p){return this.getCompletionProvider().gatherCompletions(C,p)},x.prototype.updateCompletions=function(C,p){if(C&&this.base&&this.completions){var f=this.editor.getCursorPosition(),v=this.editor.session.getTextRange({start:this.base,end:f});if(v==this.completions.filterText)return;if(this.completions.setFilter(v),!this.completions.filtered.length)return this.detach();if(this.completions.filtered.length==1&&this.completions.filtered[0].value==v&&!this.completions.filtered[0].snippet)return this.detach();this.openPopup(this.editor,v,C);return}if(p&&p.matches){var f=this.editor.getSelectionRange().start;return this.base=this.editor.session.doc.createAnchor(f.row,f.column),this.base.$insertRight=!0,this.completions=new L(p.matches),this.getCompletionProvider().completions=this.completions,this.openPopup(this.editor,"",C)}var g=this.editor.getSession(),f=this.editor.getCursorPosition(),v=c.getCompletionPrefix(this.editor);this.base=g.doc.createAnchor(f.row,f.column-v.length),this.base.$insertRight=!0;var E={exactMatch:this.exactMatch,ignoreCaption:this.ignoreCaption};this.getCompletionProvider({prefix:v,pos:f}).provideCompletions(this.editor,E,function(B,$,O){var I=$.filtered,k=c.getCompletionPrefix(this.editor);if(this.$firstOpenTimer.cancel(),O){if(!I.length){var M=!this.autoShown&&this.emptyMessage;if(typeof M=="function"&&(M=this.emptyMessage(k)),M){var z=[{caption:M,value:""}];this.completions=new L(z),this.openPopup(this.editor,k,C),this.popup.renderer.setStyle("ace_loading",!1),this.popup.renderer.setStyle("ace_empty-message",!0);return}return this.detach()}if(I.length==1&&I[0].value==k&&!I[0].snippet)return this.detach();if(this.autoInsert&&!this.autoShown&&I.length==1)return this.insertMatch(I[0])}this.completions=!O&&this.showLoadingState?new L(x.completionsForLoading.concat(I),$.filterText):$,this.openPopup(this.editor,k,C),this.popup.renderer.setStyle("ace_empty-message",!1),this.popup.renderer.setStyle("ace_loading",!O)}.bind(this)),this.showLoadingState&&!this.autoShown&&(!this.popup||!this.popup.isOpen)&&this.$firstOpenTimer.delay(this.stickySelectionDelay/2)},x.prototype.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},x.prototype.updateDocTooltip=function(){var C=this.popup,p=this.completions.filtered,g=p&&(p[C.getHoveredRow()]||p[C.getRow()]),f=null;if(!g||!this.editor||!this.popup.isOpen)return this.hideDocTooltip();for(var v=this.editor.completers.length,E=0;E<v;E++){var B=this.editor.completers[E];if(B.getDocTooltip&&g.completerId===B.id){f=B.getDocTooltip(g);break}}if(!f&&typeof g!="string"&&(f=g),typeof f=="string"&&(f={docText:f}),!f||!f.docHTML&&!f.docText)return this.hideDocTooltip();this.showDocTooltip(f)},x.prototype.showDocTooltip=function(C){this.tooltipNode||(this.tooltipNode=m.createElement("div"),this.tooltipNode.style.margin="0",this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.style.overscrollBehavior="contain",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this),this.tooltipNode.id="doc-tooltip",this.tooltipNode.setAttribute("role","tooltip"),this.tooltipNode.addEventListener("wheel",A));var p=this.editor.renderer.theme;this.tooltipNode.className="ace_tooltip ace_doc-tooltip "+(p.isDark?"ace_dark ":"")+(p.cssClass||"");var g=this.tooltipNode;C.docHTML?g.innerHTML=C.docHTML:C.docText&&(g.textContent=C.docText),g.parentNode||this.popup.container.appendChild(this.tooltipNode);var f=this.popup,v=f.container.getBoundingClientRect();g.style.top=f.container.style.top,g.style.bottom=f.container.style.bottom,g.style.display="block",window.innerWidth-v.right<320?v.left<320?f.isTopdown?(g.style.top=v.bottom+"px",g.style.left=v.left+"px",g.style.right="",g.style.bottom=""):(g.style.top=f.container.offsetTop-g.offsetHeight+"px",g.style.left=v.left+"px",g.style.right="",g.style.bottom=""):(g.style.right=window.innerWidth-v.left+"px",g.style.left=""):(g.style.left=v.right+1+"px",g.style.right="")},x.prototype.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),!!this.tooltipNode){var C=this.tooltipNode;!this.editor.isFocused()&&document.activeElement==C&&this.editor.focus(),this.tooltipNode=null,C.parentNode&&C.parentNode.removeChild(C)}},x.prototype.onTooltipClick=function(C){for(var p=C.target;p&&p!=this.tooltipNode;){if(p.nodeName=="A"&&p.href){p.rel="noreferrer",p.target="_blank";break}p=p.parentNode}},x.prototype.destroy=function(){if(this.detach(),this.popup){this.popup.destroy();var C=this.popup.container;C&&C.parentNode&&C.parentNode.removeChild(C)}this.editor&&this.editor.completer==this&&(this.editor.off("destroy",w),this.editor.completer=null),this.inlineRenderer=this.popup=this.editor=null},x.for=function(C){return C.completer instanceof x||(C.completer&&(C.completer.destroy(),C.completer=null),_.get("sharedPopups")?(x.$sharedInstance||(x.$sharedInstance=new x),C.completer=x.$sharedInstance):(C.completer=new x,C.once("destroy",w))),C.completer},x}();F.prototype.commands={Up:function(x){x.completer.goTo("up")},Down:function(x){x.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(x){x.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(x){x.completer.goTo("end")},Esc:function(x){x.completer.detach()},Return:function(x){return x.completer.insertMatch()},"Shift-Return":function(x){x.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(x){var C=x.completer.insertMatch();if(C||x.tabstopManager)return C;x.completer.goTo("down")},Backspace:function(x){x.execCommand("backspace");var C=c.getCompletionPrefix(x);!C&&x.completer&&x.completer.detach()},PageUp:function(x){x.completer.popup.gotoPageUp()},PageDown:function(x){x.completer.popup.gotoPageDown()}},F.startCommand={name:"startAutocomplete",exec:function(x,C){var p=F.for(x);p.autoInsert=!1,p.autoSelect=!0,p.autoShown=!1,p.showPopup(x,C),p.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var S=function(){function x(C){this.initialPosition=C,this.active=!0}return x.prototype.insertByIndex=function(C,p,g){return!this.completions||!this.completions.filtered?!1:this.insertMatch(C,this.completions.filtered[p],g)},x.prototype.insertMatch=function(C,p,g){if(!p)return!1;if(C.startOperation({command:{name:"insertMatch"}}),p.completer&&p.completer.insertMatch)p.completer.insertMatch(C,p);else{if(!this.completions)return!1;var f=this.completions.filterText.length,v=0;if(p.range&&p.range.start.row===p.range.end.row&&(f-=this.initialPosition.prefix.length,f+=this.initialPosition.pos.column-p.range.start.column,v+=p.range.end.column-this.initialPosition.pos.column),f||v){var E;C.selection.getAllRanges?E=C.selection.getAllRanges():E=[C.getSelectionRange()];for(var B=0,$;$=E[B];B++)$.start.column-=f,$.end.column+=v,C.session.remove($)}p.snippet?y.insertSnippet(C,p.snippet):this.$insertString(C,p),p.completer&&p.completer.onInsert&&typeof p.completer.onInsert=="function"&&p.completer.onInsert(C,p),p.command&&p.command==="startAutocomplete"&&C.execCommand(p.command)}return C.endOperation(),!0},x.prototype.$insertString=function(C,p){var g=p.value||p;C.execCommand("insertstring",g)},x.prototype.gatherCompletions=function(C,p){var g=C.getSession(),f=C.getCursorPosition(),v=c.getCompletionPrefix(C),E=[];this.completers=C.completers;var B=C.completers.length;return C.completers.forEach(function($,O){$.getCompletions(C,g,f,v,function(I,k){$.hideInlinePreview&&(k=k.map(function(M){return Object.assign(M,{hideInlinePreview:$.hideInlinePreview})})),!I&&k&&(E=E.concat(k)),p(null,{prefix:c.getCompletionPrefix(C),matches:E,finished:--B===0})})}),!0},x.prototype.provideCompletions=function(C,p,g){var f=function($){var O=$.prefix,I=$.matches;this.completions=new L(I),p.exactMatch&&(this.completions.exactMatch=!0),p.ignoreCaption&&(this.completions.ignoreCaption=!0),this.completions.setFilter(O),($.finished||this.completions.filtered.length)&&g(null,this.completions,$.finished)}.bind(this),v=!0,E=null;if(this.gatherCompletions(C,function($,O){if(this.active){$&&(g($,[],!0),this.detach());var I=O.prefix;if(I.indexOf(O.prefix)===0){if(v){E=O;return}f(O)}}}.bind(this)),v=!1,E){var B=E;E=null,f(B)}},x.prototype.detach=function(){this.active=!1,this.completers&&this.completers.forEach(function(C){typeof C.cancel=="function"&&C.cancel()})},x}(),L=function(){function x(C,p){this.all=C,this.filtered=C,this.filterText=p||"",this.exactMatch=!1,this.ignoreCaption=!1}return x.prototype.setFilter=function(C){if(C.length>this.filterText&&C.lastIndexOf(this.filterText,0)===0)var p=this.filtered;else var p=this.all;this.filterText=C,p=this.filterCompletions(p,this.filterText),p=p.sort(function(f,v){return v.exactMatch-f.exactMatch||v.$score-f.$score||(f.caption||f.value).localeCompare(v.caption||v.value)});var g=null;p=p.filter(function(f){var v=f.snippet||f.caption||f.value;return v===g?!1:(g=v,!0)}),this.filtered=p},x.prototype.filterCompletions=function(C,p){var g=[],f=p.toUpperCase(),v=p.toLowerCase();e:for(var E=0,B;B=C[E];E++){if(B.skipFilter){B.$score=B.score,g.push(B);continue}var $=!this.ignoreCaption&&B.caption||B.value||B.snippet;if($){var O=-1,I=0,k=0,M,z;if(this.exactMatch){if(p!==$.substr(0,p.length))continue e}else{var W=$.toLowerCase().indexOf(v);if(W>-1)k=W;else for(var H=0;H<p.length;H++){var J=$.indexOf(v[H],O+1),N=$.indexOf(f[H],O+1);if(M=J>=0&&(N<0||J<N)?J:N,M<0)continue e;z=M-O-1,z>0&&(O===-1&&(k+=10),k+=z,I|=1<<H),O=M}}B.matchMask=I,B.exactMatch=k?0:1,B.$score=(B.score||0)-k,g.push(B)}}return g},x}();s.Autocomplete=F,s.CompletionProvider=S,s.FilteredList=L}),ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(t,s,i){function n(c,u){var m=c.getTextRange(a.fromPoints({row:0,column:0},u));return m.split(l).length-1}function r(c,u){var m=n(c,u),y=c.getValue().split(l),_=Object.create(null),T=y[m];return y.forEach(function(A,w){if(!(!A||A===T)){var F=Math.abs(m-w),S=y.length-F;_[A]?_[A]=Math.max(S,_[A]):_[A]=S}}),_}var a=t("../range").Range,l=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;s.getCompletions=function(c,u,m,y,_){var T=r(u,m),A=Object.keys(T);_(null,A.map(function(w){return{caption:w,value:w,score:T[w],meta:"local"}}))}}),ace.define("ace/ext/language_tools",["require","exports","module","ace/snippets","ace/autocomplete","ace/config","ace/lib/lang","ace/autocomplete/util","ace/autocomplete/text_completer","ace/editor","ace/config"],function(t,s,i){var n=t("../snippets").snippetManager,r=t("../autocomplete").Autocomplete,a=t("../config"),l=t("../lib/lang"),c=t("../autocomplete/util"),u=t("../autocomplete/text_completer"),m={getCompletions:function(f,v,E,B,$){if(v.$mode.completer)return v.$mode.completer.getCompletions(f,v,E,B,$);var O=f.session.getState(E.row),I=v.$mode.getCompletions(O,v,E,B);I=I.map(function(k){return k.completerId=m.id,k}),$(null,I)},id:"keywordCompleter"},y=function(f){var v={};return f.replace(/\${(\d+)(:(.*?))?}/g,function(E,B,$,O){return v[B]=O||""}).replace(/\$(\d+?)/g,function(E,B){return v[B]})},_={getCompletions:function(f,v,E,B,$){var O=[],I=v.getTokenAt(E.row,E.column);I&&I.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\.xml$/)?O.push("html-tag"):O=n.getActiveScopes(f);var k=n.snippetMap,M=[];O.forEach(function(z){for(var W=k[z]||[],H=W.length;H--;){var J=W[H],N=J.name||J.tabTrigger;N&&M.push({caption:N,snippet:J.content,meta:J.tabTrigger&&!J.name?J.tabTrigger+"⇥ ":"snippet",completerId:_.id})}},this),$(null,M)},getDocTooltip:function(f){f.snippet&&!f.docHTML&&(f.docHTML=["<b>",l.escapeHTML(f.caption),"</b>","<hr></hr>",l.escapeHTML(y(f.snippet))].join(""))},id:"snippetCompleter"},T=[_,u,m];s.setCompleters=function(f){T.length=0,f&&T.push.apply(T,f)},s.addCompleter=function(f){T.push(f)},s.textCompleter=u,s.keyWordCompleter=m,s.snippetCompleter=_;var A={name:"expandSnippet",exec:function(f){return n.expandWithTab(f)},bindKey:"Tab"},w=function(f,v){F(v.session.$mode)},F=function(f){typeof f=="string"&&(f=a.$modes[f]),f&&(n.files||(n.files={}),S(f.$id,f.snippetFileId),f.modes&&f.modes.forEach(F))},S=function(f,v){!v||!f||n.files[f]||(n.files[f]={},a.loadModule(v,function(E){E&&(n.files[f]=E,!E.snippets&&E.snippetText&&(E.snippets=n.parseSnippetFile(E.snippetText)),n.register(E.snippets||[],E.scope),E.includeScopes&&(n.snippetMap[E.scope].includeScopes=E.includeScopes,E.includeScopes.forEach(function(B){F("ace/mode/"+B)})))}))},L=function(f){var v=f.editor,E=v.completer&&v.completer.activated;if(f.command.name==="backspace")E&&!c.getCompletionPrefix(v)&&v.completer.detach();else if(f.command.name==="insertstring"&&!E){x=f;var B=f.editor.$liveAutocompletionDelay;B?C.delay(B):p(f)}},x,C=l.delayedCall(function(){p(x)},0),p=function(f){var v=f.editor,E=c.getCompletionPrefix(v),B=f.args,$=c.triggerAutocomplete(v,B);if(E&&E.length>=v.$liveAutocompletionThreshold||$){var O=r.for(v);O.autoShown=!0,O.showPopup(v)}},g=t("../editor").Editor;t("../config").defineOptions(g.prototype,"editor",{enableBasicAutocompletion:{set:function(f){f?(this.completers||(this.completers=Array.isArray(f)?f:T),this.commands.addCommand(r.startCommand)):this.commands.removeCommand(r.startCommand)},value:!1},enableLiveAutocompletion:{set:function(f){f?(this.completers||(this.completers=Array.isArray(f)?f:T),this.commands.on("afterExec",L)):this.commands.off("afterExec",L)},value:!1},liveAutocompletionDelay:{initialValue:0},liveAutocompletionThreshold:{initialValue:0},enableSnippets:{set:function(f){f?(this.commands.addCommand(A),this.on("changeMode",w),w(null,this)):(this.commands.removeCommand(A),this.off("changeMode",w))},value:!1}})}),function(){ace.require(["ace/ext/language_tools"],function(t){h&&(h.exports=t)})}()})(an);const pt={jsonError:{border:"1px solid red",minHeight:200},jsonNoError:{border:"1px solid #00000000",minHeight:200}};function ln(h){return o.createElement(tn,{style:h.error===!0?pt.jsonError:h.error===!1?pt.jsonNoError:void 0,mode:h.mode||"json",width:"100%",height:"100%",showPrintMargin:h.editValueMode,showGutter:h.editValueMode,highlightActiveLine:h.editValueMode,defaultValue:h.defaultValue,theme:h.themeType==="dark"?"clouds_midnight":"chrome",value:h.value,readOnly:!h.onChange,onChange:e=>h.onChange(e),name:h.name||"UNIQUE_ID_OF_DIV1",fontSize:h.fontSize||14,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:h.editValueMode,tabSize:h.editValueMode?2:void 0},editorProps:{$blockScrolling:!0}})}const Xe={flex:{display:"flex"},button:{height:48,minWidth:48},wrapper:{width:"calc(100vw - 40px)",height:"calc(100vh - 188px)"}};class un extends b{componentDidMount(){super.componentDidMount();const{data:e,attr:t}=this.props,s=b.getValue(e,t)||{};this.setState({value:s,initialized:!0,jsonError:this.validateJson(s)})}validateJson(e){let t=!1;if(this.props.schema.validateJson!==!1&&(e||!this.props.schema.allowEmpty))try{JSON.parse(e)}catch(s){console.log("Error in JSON",s),t=!0}return t}renderItem(e,t){if(!this.state.initialized)return null;const{schema:s,data:i,attr:n}=this.props,{value:r,showSelectId:a}=this.state;return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},o.createElement("div",{style:Xe.flex},o.createElement(d.Button,{color:"grey",disabled:t,style:Xe.button,size:"small",variant:"outlined",onClick:()=>this.setState({showSelectId:!0})},D.I18n.t("ra_JSON editor"))),a?o.createElement(Xs,{title:this.getText(s.label),overflowHidden:!0,onClose:()=>this.setState({showSelectId:!1,value:b.getValue(i,n)||{}}),onApply:()=>this.setState({showSelectId:!1},()=>this.onChange(n,r))},o.createElement("div",{style:{...Xe.wrapper,...this.state.jsonError?{}:void 0}},o.createElement(ln,{value:typeof r=="object"?JSON.stringify(r):r,onChange:l=>this.setState({value:l,jsonError:this.validateJson(l)}),name:"ConfigJsonEditor",themeType:this.props.oContext.themeType}))):null,s.help||this.state.jsonError?o.createElement(d.FormHelperText,null,this.state.jsonError?D.I18n.t("ra_Invalid JSON"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const cn=[{value:"en",label:"English"},{value:"de",label:"Deutsch"},{value:"ru",label:"русский"},{value:"pt",label:"Portugues"},{value:"nl",label:"Nederlands"},{value:"fr",label:"français"},{value:"it",label:"Italiano"},{value:"es",label:"Espanol"},{value:"pl",label:"Polski"},{value:"uk",label:"Український"},{value:"zh-cn",label:"简体中文"}];class hn extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr),t=[...cn];this.props.schema.system?t.unshift({value:"",label:D.I18n.t("ra_System language")}):t.unshift({value:"",label:D.I18n.t("ra_none")}),this.setState({value:this.props.schema.system?e||"":e||D.I18n.getLanguage(),selectOptions:t})}renderItem(e,t){var i,n;if(!this.state.selectOptions)return null;const s=(i=this.state.selectOptions)==null?void 0:i.find(r=>r.value===this.state.value||!r.value&&!this.state.value);return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,disabled:t,value:this.state.value||"_",renderValue:()=>this.getText(s==null?void 0:s.label,this.props.schema.noTranslation),onChange:r=>{let{value:a}=r.target;a==="_"&&(a=""),this.setState({value:a},()=>{const l=this.onChange(this.props.attr,a);if(l instanceof Promise&&l.catch(c=>console.error(c)),this.props.schema.changeGuiLanguage)if(a){if(a===D.I18n.getLanguage())return;D.I18n.setLanguage(a),this.props.oContext.changeLanguage&&this.props.oContext.changeLanguage()}else this.props.oContext.socket.getSystemConfig().then(c=>{c.common.language!==D.I18n.getLanguage()&&c.common.language&&(D.I18n.setLanguage(c.common.language),this.props.oContext.changeLanguage&&this.props.oContext.changeLanguage())}).catch(c=>console.error(`Cannot read system config: ${c}`))})}},(n=this.state.selectOptions)==null?void 0:n.map(r=>o.createElement(d.MenuItem,{key:r.value,value:r.value},r.label))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}class pn extends b{scrollRef;constructor(e){super(e),this.scrollRef=o.createRef()}scrolledDown(){return this.scrollRef.current?this.scrollRef.current.offsetHeight+this.scrollRef.current.scrollTop>=this.scrollRef.current.scrollHeight:!1}componentDidMount(){super.componentDidMount(),b.getValue(this.props.data,this.props.attr)||(this.props.schema.licenseUrl?(this.setState({showLicenseDialog:!0,loading:!0,scrolledDown:!1}),fetch(this.props.schema.licenseUrl).then(e=>e.text()).then(e=>this.setState({license:e,loading:!1})).catch(e=>this.setState({license:e.toString(),loading:!1,error:!0,scrolledDown:!1}))):this.setState({showLicenseDialog:!0,scrolledDown:!1}),setTimeout(()=>{this.scrollRef.current&&(this.scrolledDown()?this.setState({scrolledDown:!0}):this.scrollRef.current.addEventListener("scroll",()=>{!this.state.scrolledDown&&this.scrolledDown()&&this.setState({scrolledDown:!0})}))},1e3))}renderItem(e,t){return this.state.showLicenseDialog?o.createElement(d.Dialog,{maxWidth:"lg",open:!0,onClose:(s,i)=>{i!=="escapeKeyDown"&&i!=="backdropClick"&&this.setState({showLicenseDialog:!1})}},o.createElement(d.DialogTitle,null,this.props.schema.title?D.I18n.t(this.props.schema.title):D.I18n.t("ra_License agreement")),o.createElement(d.DialogContent,null,this.props.schema.licenseUrl?o.createElement(o.Fragment,null,this.state.loading?o.createElement(d.LinearProgress,null):null,o.createElement("pre",{ref:this.scrollRef,style:{width:"100%",height:"100%",overflowY:"auto",fontSize:14}},this.state.license)):null,!this.props.schema.licenseUrl&&this.props.schema.texts?o.createElement("div",{ref:this.scrollRef,style:{width:"100%",height:"100%",overflowY:"auto",fontSize:14}},this.props.schema.texts.map((s,i)=>this.props.schema.noTranslation?o.createElement("p",{key:i},s):o.createElement("p",{key:i},D.I18n.t(s)))):null),o.createElement(d.DialogActions,null,this.props.schema.checkBox?o.createElement(d.FormControlLabel,{control:o.createElement(d.Checkbox,{disabled:t,checked:!!this.state.licenseChecked,onClick:()=>this.setState({licenseChecked:!this.state.licenseChecked})}),label:D.I18n.t(this.props.schema.checkBox)}):null,o.createElement(d.Button,{disabled:t||this.state.loading||this.state.error||this.props.schema.checkBox&&!this.state.licenseChecked||!this.state.scrolledDown,onClick:()=>{this.setState({showLicenseDialog:!1});const s=this.onChange(this.props.attr,!0);s instanceof Promise&&s.catch(i=>console.error(`Cannot set value: ${i}`))},color:"primary",variant:"contained",startIcon:o.createElement(P.Check,null)},this.props.schema.agreeText?D.I18n.t(this.props.schema.agreeText):D.I18n.t("ra_Accept license")),o.createElement(d.Button,{onClick:()=>{this.setState({showLicenseDialog:!1}),setTimeout(()=>this.setState({showLicenseDialog:!0}),2e3)},color:"grey",variant:"contained",startIcon:o.createElement(P.Close,null)},D.I18n.t("ra_Close")))):null}}const dt={indeterminate:{opacity:.5},control:{flexDirection:"row",width:"100%"}};class dn extends b{updateTimeout;componentDidMount(){super.componentDidMount();let e=b.getValue(this.props.data,this.props.attr);if(e==null&&(e=""),Array.isArray(e)&&this.props.oContext.multiEdit){e=b.DIFFERENT_VALUE,this.setState({_value:e,oldValue:e});return}this.setState({_value:e.toString(),oldValue:e.toString()})}static getDerivedStateFromProps(e,t){if(e.schema.min!==void 0&&e.schema.min<0||e.schema.max!==void 0&&e.schema.max<0)return null;const s=b.getValue(e.data,e.attr);return e.oContext.multiEdit&&t._value===b.DIFFERENT_VALUE?{_value:b.DIFFERENT_VALUE}:s==null||t.oldValue===null||t.oldValue===void 0||s.toString()!==parseFloat(t._value).toString()&&s.toString()!==t.oldValue.toString()?{_value:s}:null}checkValue(e){if(e==null)return null;e=e.toString().trim();const t=e===""?0:parseFloat(e);return e!==""&&Number.isNaN(t)?"ra_Not a number":e!==""&&window.isFinite(t)?this.props.schema.min!==void 0&&t<this.props.schema.min?"ra_Too small":this.props.schema.max!==void 0&&t>this.props.schema.max?"ra_Too big":e===""||e==="-"||Number.isNaN(t)?"ra_Not a number":null:"ra_Not a number"}renderItem(e,t){const s=Array.isArray(this.state._value)||this.state._value===b.DIFFERENT_VALUE;if(this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=void 0,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0),s){const i=b.getValue(this.props.data,this.props.attr),n=(i==null?void 0:i.filter(r=>r||r===0).map(r=>({label:r.toString(),value:r})))||[];return n.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),o.createElement(d.Autocomplete,{style:dt.indeterminate,fullWidth:!0,freeSolo:!0,value:n[0],getOptionSelected:(r,a)=>r.label===a.label,onChange:(r,a)=>{const l=this.onChange(this.props.attr,a==null?void 0:a.value,()=>{this.setState({_value:a==null?void 0:a.value,oldValue:this.state._value})});l instanceof Promise&&l.catch(c=>console.error(c))},options:n,getOptionLabel:r=>r.label,renderInput:r=>o.createElement(d.TextField,{...r,label:this.getText(this.props.schema.label),variant:"standard",slotProps:{htmlInput:{...r.inputProps,readOnly:this.props.schema.readOnly||!1},input:{endAdornment:this.props.schema.unit?this.getText(this.props.schema.unit,this.props.schema.noTranslation):void 0}},error:!!e,placeholder:this.getText(this.props.schema.placeholder),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:!!t})})}return!e&&this.state._value!==null&&this.state._value!==void 0&&this.state._value&&(e=this.checkValue(this.state._value),e&&(e=D.I18n.t(e))),o.createElement(d.FormControl,{variant:"standard",style:dt.control},o.createElement(d.TextField,{variant:"standard",type:"number",fullWidth:!0,slotProps:{htmlInput:{min:this.props.schema.min,max:this.props.schema.max,step:this.props.schema.step,readOnly:this.props.schema.readOnly||!1},input:{endAdornment:this.props.schema.unit?this.getText(this.props.schema.unit,this.props.schema.noTranslation):void 0}},value:this.state._value===null||this.state._value===void 0?"":this.state._value,error:!!e,disabled:!!t,onChange:i=>{const n=i.target.value,r=this.checkValue(n);r?this.onError(this.props.attr,D.I18n.t(r)):this.onError(this.props.attr),this.setState({_value:n,oldValue:this.state._value},()=>this.onChange(this.props.attr,parseFloat(n)))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:e&&typeof e=="string"?e:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}))}}const mt={flex:{display:"flex"},button:{height:48,marginLeft:4,minWidth:48}};class mn extends b{componentDidMount(){super.componentDidMount();const{data:e,attr:t}=this.props,s=b.getValue(e,t)||"";this.setState({value:s,initialized:!0})}renderItem(e,t){if(!this.state.initialized)return null;const s=this.props.oContext.socket,{schema:i,attr:n}=this.props,{value:r,showSelectId:a}=this.state;return o.createElement(d.FormControl,{fullWidth:!0,variant:"standard"},i.label?o.createElement(d.InputLabel,{shrink:!0},this.getText(i.label)):null,o.createElement("div",{style:mt.flex},o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:r,error:!!e,disabled:t,placeholder:this.getText(i.placeholder),label:this.getText(i.label),helperText:this.renderHelp(i.help,i.helpLink,i.noTranslation),onChange:l=>{const c=l.target.value;this.setState({value:c},()=>this.onChange(n,c))}}),o.createElement(d.Button,{color:"grey",disabled:t,style:mt.button,size:"small",variant:"outlined",onClick:()=>this.setState({showSelectId:!0})},"...")),a?o.createElement(D.DialogSelectID,{imagePrefix:this.props.oContext.imagePrefix===void 0?"../..":this.props.oContext.imagePrefix,dialogName:`admin.${this.props.oContext.adapterName}`,filterFunc:i.filterFunc,themeType:this.props.oContext.themeType,theme:this.props.oContext.theme,types:i.types?Array.isArray(i.types)?i.types:[i.types]:void 0,customFilter:i.customFilter,filters:i.filters,socket:s,selected:r,root:i.root,onClose:()=>this.setState({showSelectId:!1}),onOk:l=>this.setState({showSelectId:!1,value:l},()=>this.onChange(n,l))}):null)}}const Ge={fullWidth:{width:"100%",display:"inline-block"},halfWidth1:{width:"calc(50% - 5px)",display:"inline-block",marginRight:8},halfWidth2:{width:"calc(50% - 5px)",display:"inline-block"}},Ne="____ppp____";class fn extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.setState({_repeat:e?Ne:"",_visible:!1,value:e?Ne:"",_notEqual:!1})}onChangePassword(e,t){e===void 0&&(e=this.state.value),t===void 0&&(t=this.state._repeat);const s=!!this.props.schema.repeat&&t!==e;this.setState({value:e,_repeat:t,_notEqual:s},()=>{if(s)this.onError(this.props.attr,D.I18n.t("ra_Passwords are not equal!"));else{this.onError(this.props.attr);const i=this.onChange(this.props.attr,e);i instanceof Promise&&i.catch(n=>this.onError(this.props.attr,n))}})}renderItem(e,t){if(this.state._notEqual===void 0)return null;const s=o.createElement(d.TextField,{variant:"standard",fullWidth:!0,type:this.state._visible&&this.state.value!==Ne?"text":"password",value:this.state.value,error:!!e||this.state._notEqual,disabled:!!t,onChange:i=>this.onChangePassword(i.target.value),label:this.getText(this.props.schema.label),slotProps:{input:{autoComplete:"new-password",endAdornment:this.state.value&&this.state.value!==Ne&&this.props.schema.visible&&!t&&!this.props.schema.readOnly?o.createElement(d.InputAdornment,{position:"end"},o.createElement(d.IconButton,{size:"large",tabIndex:-1,onClick:i=>{i.preventDefault(),i.stopPropagation(),this.setState({_visible:!this.state._visible})},edge:"end"},this.state._visible?o.createElement(P.VisibilityOff,null):o.createElement(P.Visibility,null))):void 0},htmlInput:{autoComplete:"new-password",form:{autoComplete:"off"},maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1}},helperText:this.state._notEqual?D.I18n.t("ra_Passwords are not equal!"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});if(this.props.schema.repeat&&!this.props.schema.readOnly){const i=this.state._visible?null:o.createElement(d.TextField,{variant:"standard",fullWidth:!0,type:"password",value:this.state._repeat,error:!!e||this.state._notEqual,disabled:!!t,onChange:n=>this.onChangePassword(void 0,n.target.value),label:`${this.getText(this.props.schema.label)} (${D.I18n.t("ra_repeat")})`,slotProps:{input:{autoComplete:"new-password"},htmlInput:{autoComplete:"new-password",form:{autoComplete:"off"},maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},helperText:this.state._notEqual?D.I18n.t("ra_Passwords are not equal!"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});return o.createElement("div",{style:Ge.fullWidth},o.createElement("div",{style:Ge.halfWidth1},s),o.createElement("div",{style:Ge.halfWidth2},i))}return s}}class gn extends b{renderItem(e,t){return o.createElement(d.TextField,{variant:"standard",fullWidth:!0,disabled:!!t,slotProps:{input:{endAdornment:this.props.schema.copyToClipboard?o.createElement(d.IconButton,{size:"small",onClick:()=>{D.Utils.copyToClipboard(this.getPattern(this.props.schema.pattern,null,this.props.schema.noTranslation)),window.alert(D.I18n.t("ra_Copied"))}},o.createElement(D.IconCopy,null)):void 0}},value:this.getPattern(this.props.schema.pattern,null,!0),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const Dn={warning:{"& .Mui-error":{color:"orange"}}};class Cn extends b{updateTimeout;async componentDidMount(){super.componentDidMount();let e=b.getValue(this.props.data,this.props.attr);e==null&&(e=""),this.setState({_value:e.toString(),oldValue:e.toString()});const t=await this.props.oContext.socket.getAdapterInstances(),s=`system.adapter.${this.props.oContext.adapterName}.${this.props.oContext.instance}`,i=await this.props.oContext.socket.getObject(s),n=i==null?void 0:i.common.host,r=[];t.forEach(a=>{var c,u,m,y;if(!a||a._id===s||a.common.host!==n||!((c=a.native)!=null&&c.bind))return;if(a!=null&&a.native&&a.native.secure&&a.native.leEnabled&&a.native.leUpdate){const _=parseInt(a.native.leCheckPort||a.native.lePort,10);_&&r.push({name:`${a._id.replace("system.adapter.","")} (LE)`,port:_,v6bind:a.native.bind.includes(":")?a.native.bind:a.native.v6bind,bind:a.native.bind,enabled:!!((u=a.common)!=null&&u.enabled)})}const l=parseInt((m=a==null?void 0:a.native)==null?void 0:m.port,10);l&&r.push({name:a._id.replace("system.adapter.",""),bind:a.native.bind,v6bind:a.native.bind.includes(":")?a.native.bind:a.native.v6bind,port:l,enabled:!!((y=a.common)!=null&&y.enabled)})}),this.setState({ports:r})}static getDerivedStateFromProps(e,t){const s=b.getValue(e.data,e.attr);return s==null||t.oldValue===null||t.oldValue===void 0||s.toString()!==parseInt(t._value,10).toString()&&s.toString()!==t.oldValue.toString()?{_value:s}:null}checkValue(e){if(e==null)return null;const t=this.props.schema.min===void 0?20:this.props.schema.min,s=this.props.schema.max||65535;e=e.toString().trim();const i=e===""?0:parseInt(e,10);return e!==""&&Number.isNaN(i)?"ra_Not a number":e!==""&&window.isFinite(Number(e))?i<t?"ra_Too small":i>s?"ra_Too big":e===""||e==="-"||Number.isNaN(i)?"ra_Not a number":null:"ra_Not a number"}renderItem(e,t){this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=void 0,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0);const s=this.props.schema.min===void 0?20:this.props.schema.min,i=this.props.schema.max||65535;let n;if(this.state.ports){const r=parseInt(this.state._value,10);if(r){const a=this.state.ports.filter(c=>!this.props.data.bind||this.props.data.bind===c.bind||this.props.data.bind==="0.0.0.0"||c.bind==="0.0.0.0");let l=a.findIndex(c=>c.port===r&&c.enabled);l!==-1?e=D.I18n.t("ra_Port is already used by %s",this.state.ports[l].name):(l=a.findIndex(c=>c.port===r&&!c.enabled),l!==-1&&(n=!0,e=D.I18n.t("ra_Port could be used by %s",this.state.ports[l].name)))}}return!e&&this.state._value!==null&&this.state._value!==void 0&&(e=this.checkValue(this.state._value),typeof e=="string"&&(e=D.I18n.t(e))),o.createElement(d.TextField,{variant:"standard",type:"number",fullWidth:!0,slotProps:{htmlInput:{min:s,max:i,readOnly:this.props.schema.readOnly||!1}},value:this.state._value===null||this.state._value===void 0?"":this.state._value,error:!!e,disabled:!!t,sx:n?Dn.warning:void 0,onChange:r=>{const a=Number(r.target.value.toString().replace(/[^0-9]/g,"")).toString(),l=this.checkValue(a);l?this.onError(this.props.attr,D.I18n.t(l)):this.onError(this.props.attr),this.setState({_value:a,oldValue:this.state._value},()=>{if(a.trim()===parseInt(a,10).toString()){const c=this.onChange(this.props.attr,parseInt(a,10)||0);c instanceof Promise&&c.catch(u=>{console.error(`Cannot set value for ${this.props.attr}: ${u}`)})}})},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:e&&typeof e=="string"?e:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}class yn extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.props.oContext.socket.getEnums("rooms").then(t=>{const s=Object.keys(t).map(i=>({value:this.props.schema.short?i.replace("enum.rooms.",""):i,label:this.getText(t[i].common.name),obj:t[i]}));this.props.schema.allowDeactivate!==!1&&s.unshift({label:D.I18n.t(b.NONE_LABEL),value:b.NONE_VALUE}),this.setState({value:e,selectOptions:s})}).catch(t=>console.error(`Cannot get enums: ${t}`))}renderItem(e,t){if(!this.state.selectOptions)return null;const s=this.state.selectOptions.find(i=>i.value===this.state.value);return o.createElement(d.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>s?s.obj?o.createElement(D.TextWithIcon,{value:s.obj,themeType:this.props.oContext.themeType,lang:D.I18n.getLanguage()}):s.label:"",onChange:i=>{this.setState({value:i.target.value==="_"?"":i.target.value},()=>this.onChange(this.props.attr,this.state.value))}},this.state.selectOptions.map(i=>o.createElement(d.MenuItem,{key:i.value,value:i.value,style:i.value===b.DIFFERENT_VALUE?{opacity:.5}:{}},i.obj?o.createElement(D.TextWithIcon,{value:i.obj,themeType:this.props.oContext.themeType,lang:D.I18n.getLanguage()}):i.label))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const vn={noMargin:{"&>div":{marginTop:0}}};class En extends b{initialValue="";componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr),t=[];(this.props.schema.options||[]).forEach(s=>{const i=s;Array.isArray(i.items)?(t.push({label:this.getText(s.label),value:s.value,group:!0}),i.items.forEach(n=>t.push({label:this.getText(n.label),value:n.value,hidden:n.hidden}))):t.push({label:this.getText(s.label),value:s.value,hidden:s.hidden})}),Array.isArray(e)?(this.initialValue=[...e],t.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),this.setState({value:b.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})}renderItem(e,t){if(!this.state.selectOptions)return null;const s=(this.state.selectOptions||[]).filter(n=>n.hidden?this.props.custom?!this.executeCustom(n.hidden,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):!this.execute(n.hidden,this.props.schema.default,this.props.data,this.props.arrayIndex,this.props.globalData):!0),i=s.find(n=>n.value==this.state.value);return o.createElement(d.FormControl,{variant:"standard",fullWidth:!0,sx:this.props.table!==void 0&&vn.noMargin,id:`jsonSelect_${this.props.attr}_${this.props.index||this.props.index===0?this.props.index:""}`},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>this.getText(i==null?void 0:i.label,this.props.schema.noTranslation),onChange:n=>{this.setState({value:n.target.value==="_"?"":n.target.value},()=>{let r;this.state.value===b.DIFFERENT_VALUE?r=this.onChange(this.props.attr,this.initialValue):r=this.onChange(this.props.attr,this.state.value),r instanceof Promise&&r.catch(a=>console.error(a))})}},s.map((n,r)=>n.group?o.createElement(d.ListSubheader,{key:r},this.getText(n.label,this.props.schema.noTranslation)):o.createElement(d.MenuItem,{key:r,value:n.value,style:n.value===b.DIFFERENT_VALUE?{opacity:.5}:{}},this.getText(n.label,this.props.schema.noTranslation)))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const bn={menuPaper:{maxHeight:800}};class xn extends b{initialized=!1;localContext;askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData,null,!0);try{e=JSON.parse(t)}catch{console.error(`Cannot parse json data: ${t}`)}}e===void 0&&(e=null),this.setState({running:!0},()=>{this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.command||"send",e).then(t=>this.setState({list:t,running:!1})).catch(t=>{console.error(`Cannot send command: ${t}`)})})}else{const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e,running:!1})}}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=b.getValue(this.props.data,t)),JSON.stringify(e)}_getValue(){let e=this.state.value===null||this.state.value===void 0?b.getValue(this.props.data,this.props.attr):this.state.value;return this.props.schema.multiple&&(typeof e=="string"?e=[e]:e==null&&(e=[])),e}renderItem(e,t){var r;if(this.props.alive){const a=this.getContext();(a!==this.localContext||!this.initialized)&&(this.localContext=a,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}const s=this._getValue();if(!this.props.alive||!this.state.running&&!((r=this.state.list)!=null&&r.length))return this.props.schema.multiple||this.props.schema.manual===!1?D.I18n.t("ra_Cannot retrieve options, as instance is offline"):o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:s,error:!!e,disabled:!!t,onChange:a=>{const l=a.target.value;this.setState({value:l},()=>this.onChange(this.props.attr,(l||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),slotProps:{input:{endAdornment:this.state.value&&!this.props.schema.noClearButton?o.createElement(d.InputAdornment,{position:"end"},o.createElement(d.IconButton,{size:"small",onClick:()=>this.setState({value:""},()=>this.onChange(this.props.attr,""))},o.createElement(P.Close,null))):null}}});if(this.state.running)return o.createElement(d.CircularProgress,{size:"24"});const i=this.state.list.filter(a=>a.hidden?this.props.custom?!this.executeCustom(a.hidden,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.arrayIndex,this.props.globalData):!this.execute(a.hidden,this.props.schema.default,this.props.data,this.props.arrayIndex,this.props.globalData):!0),n=i.find(a=>a.value===s);return o.createElement(d.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,o.createElement(d.Select,{variant:"standard",error:!!e,multiple:this.props.schema.multiple,disabled:!!t,sx:{"&.MuiSelect-paper":this.props.schema.multiple?bn.menuPaper:void 0},value:s,renderValue:a=>this.props.schema.multiple?o.createElement(d.Box,{sx:{display:"flex",flexWrap:"wrap",gap:.5}},a.map(l=>{const c=i.find(u=>u.value===l);if(c||this.props.schema.showAllValues!==!1){const u=(c==null?void 0:c.label)||l;return o.createElement(d.Chip,{key:l,label:u})}return null})):(n==null?void 0:n.label)||a,onChange:a=>{const l=this.onChange(this.props.attr,a.target.value);l instanceof Promise&&l.catch(c=>console.error(`Cannot set value: ${c}`))}},i.map((a,l)=>o.createElement(d.MenuItem,{key:l,value:a.value},this.props.schema.multiple?o.createElement(d.Checkbox,{checked:s.includes(a.value),onClick:()=>{const c=JSON.parse(JSON.stringify(this._getValue())),u=s.indexOf(a.value);u!==-1?c.splice(u,1):(c.push(a.value),c.sort()),this.setState({value:c},()=>this.onChange(this.props.attr,c))}}):null,o.createElement(d.ListItemText,{primary:a.label})))),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ft={fullWidth:{width:"100%"}};function ge(h){return h.split(".").reduce((e,t)=>(e<<8)+parseInt(t,10),0)>>>0}function wn(h,e){var i,n;const t=(n=(i=h==null?void 0:h.native)==null?void 0:i.hardware)==null?void 0:n.networkInterfaces;if(!t)return null;let s;return Object.keys(t).forEach(r=>t[r].forEach(a=>{a.internal||e.includes(":")&&a.family!=="IPv6"||e.includes(".")&&!e.match(/[^.\d]/)&&a.family!=="IPv4"||(a.family==="IPv4"&&!a.address.startsWith("172")&&(e==="127.0.0.0"||e==="localhost"||e.match(/[^.\d]/))?s=a.address:s||(a.family==="IPv4"&&e.includes(".")&&(ge(e)&ge(a.netmask),ge(a.address)&ge(a.netmask)),s=a.address))})),s||Object.keys(t).forEach(r=>t[r].forEach(a=>{a.internal||e.includes(":")&&a.family!=="IPv6"||e.includes(".")&&!e.match(/[^.\d]/)&&a.family!=="IPv4"||(a.family==="IPv6"&&(e==="127.0.0.0"||e==="localhost"||e.match(/[^.\d]/))?s=a.address:s||(a.family==="IPv4"&&e.includes(".")&&(ge(e)&ge(a.netmask),ge(a.address)&ge(a.netmask)),s=a.address))})),s||Object.keys(t).forEach(r=>{t[r].forEach(a=>{a.internal||e.includes(":")&&a.family!=="IPv6"||e.includes(".")&&!e.match(/[^.\d]/)&&a.family!=="IPv4"||(e==="127.0.0.0"||e==="localhost"||e.match(/[^.\d]/),s=a.address)})}),s||Object.keys(t).forEach(r=>{t[r].forEach(a=>{a.internal||(s=a.address)})}),s}class gt extends b{async componentDidMount(){var t;super.componentDidMount();let e=window.location.hostname;if(this.props.schema.openUrl){const s=await this.props.oContext.socket.getCurrentInstance(),i=await this.props.oContext.socket.getObject(`system.adapter.${s}`);if(i){const n=await this.props.oContext.socket.getObject(`system.host.${(t=i==null?void 0:i.common)==null?void 0:t.host}`);if(n){const r=wn(n,window.location.hostname);if(r)e=`${r}:${window.location.port}`;else{console.warn(`Cannot find suitable IP in host ${i.common.host} for ${i._id}`);return}}}}await new Promise(s=>{this.setState({_error:"",_message:"",hostname:e},s)}),this.props.schema.onLoaded&&this._onClick()}renderErrorDialog(){return this.state._error?o.createElement(D.DialogError,{text:this.state._error,onClose:()=>this.setState({_error:""})}):null}renderMessageDialog(){return this.state._message?o.createElement(D.DialogMessage,{text:this.state._message,onClose:()=>this.setState({_message:""})}):null}_onClick(){this.props.oContext.onCommandRunning(!0),this.setState({running:!0});const e=`${window.location.protocol}//${window.location.host}${window.location.pathname.replace(/\/index\.html$/,"")}`,t=`${window.location.protocol}//${this.state.hostname.split(":").length>3?`[${this.state.hostname}]`:this.state.hostname}${window.location.pathname.replace(/\/index\.html$/,"")}`;let s=this.props.schema.data;if(s===void 0&&this.props.schema.jsonData){const n=this.getPattern(this.props.schema.jsonData,{_origin:e,_originIp:t,...this.props.data},!0);try{s=JSON.parse(n)}catch{console.error(`Cannot parse json data: ${n}`)}}s===void 0&&(s=null),this.props.schema.openUrl&&!s&&(s={_origin:e,_originIp:t});let i;this.props.schema.timeout&&(i=setTimeout(()=>{this.props.oContext.onCommandRunning(!1),this.setState({_error:D.I18n.t("ra_Request timed out"),running:!1})},parseInt(this.props.schema.timeout,10)||1e4)),this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.command||"send",s).then(async n=>{if(i&&(clearTimeout(i),i=void 0),n!=null&&n.error)if(this.props.schema.error&&this.props.schema.error[n.error]){let r=this.getText(this.props.schema.error[n.error]);n.args&&n.args.forEach(a=>r=r.replace("%s",a)),this.setState({_error:r})}else this.setState({_error:n.error?D.I18n.t(n.error):D.I18n.t("ra_Error")});else{if(n!=null&&n.command){this.props.oContext.onBackEndCommand&&this.props.oContext.onBackEndCommand(n.command);return}if(n!=null&&n.reloadBrowser&&this.props.schema.reloadBrowser)window.location.reload();else if(n!=null&&n.openUrl&&this.props.schema.openUrl)window.open(n.openUrl,n.window||this.props.schema.window||"_blank");else if(n!=null&&n.result&&this.props.schema.result&&this.props.schema.result[n.result]){let r=this.getText(this.props.schema.result[n.result]);n.args&&n.args.forEach(a=>r=r.replace("%s",a)),window.alert(r)}if(n!=null&&n.native&&this.props.schema.useNative){for(const[r,a]of Object.entries(n.native))await this.onChangeAsync(r,a);setTimeout(()=>this.props.oContext.forceUpdate(Object.keys(n.native),this.props.data),300)}else n!=null&&n.result?window.alert(typeof n.result=="object"?JSON.stringify(n.result):n.result):window.alert(D.I18n.t("ra_Ok"));n!=null&&n.saveConfig&&this.props.onChange(null,null,null,!0)}}).catch(n=>{this.props.schema.error&&this.props.schema.error[n.toString()]?this.setState({_error:this.getText(this.props.schema.error[n.toString()])}):this.setState({_error:D.I18n.t(n.toString())||D.I18n.t("ra_Error")})}).then(()=>{this.props.oContext.onCommandRunning(!1),this.setState({running:!1})})}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const e=this.state.confirmData||this.props.schema.confirm;let t=null;return e.type==="warning"?t=o.createElement(P.Warning,null):e.type==="error"?t=o.createElement(P.Error,null):e.type==="info"&&(t=o.createElement(P.Info,null)),o.createElement(D.DialogConfirm,{title:this.getText(e.title)||D.I18n.t("ra_Please confirm"),text:this.getText(e.text),ok:this.getText(e.ok)||D.I18n.t("ra_Ok"),cancel:this.getText(e.cancel)||D.I18n.t("ra_Cancel"),icon:t||void 0,onClose:s=>this.setState({confirmDialog:!1},()=>s&&this._onClick())})}renderItem(e,t){const s=this.getIcon();return o.createElement("div",{style:ft.fullWidth},o.createElement(d.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:{...ft.fullWidth,...this.props.schema.controlStyle||void 0},disabled:t||!this.props.alive,startIcon:s,title:this.props.alive?this.getText(this.props.schema.title)||"":D.I18n.t("ra_Instance is not alive"),onClick:()=>{this.props.schema.confirm?this.setState({confirmDialog:!0}):this._onClick()}},this.props.schema.showProcess&&this.state.running?o.createElement(d.CircularProgress,{size:20,style:{marginRight:8}}):null,this.getText(this.props.schema.label,this.props.schema.noTranslation)),this.renderErrorDialog(),this.renderMessageDialog())}}const Dt={fullWidth:{width:"100%"},icon:{width:24,height:24,marginRight:4}};class An extends b{async _onClick(){var s,i;let e=this.props.schema.val;if(typeof e=="string"&&e.includes("${")){e=this.getPattern(e,null,!0);const n=await this.props.oContext.socket.getObject(this.props.schema.id);((s=n==null?void 0:n.common)==null?void 0:s.type)==="number"?e=parseFloat(e):((i=n==null?void 0:n.common)==null?void 0:i.type)==="boolean"&&(e=e==="true"||e===!0||e==="1"||e===1)}const t=(this.props.schema.id||"").replace(/%INSTANCE%/g,(this.props.oContext.instance||0).toString());try{await this.props.oContext.socket.setState(t,{val:e,ack:!!this.props.schema.ack}),this.props.schema.okText&&window.alert(this.getText(this.props.schema.okText))}catch(n){this.props.schema.error&&this.props.schema.error[n.toString()]?window.alert(this.getText(this.props.schema.error[n.toString()])):window.alert(D.I18n.t(n.toString())||D.I18n.t("ra_Error"))}}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const e=this.state.confirmData||this.props.schema.confirm;let t=null;return e.type==="warning"?t=o.createElement(P.Warning,null):e.type==="error"?t=o.createElement(P.Error,null):e.type==="info"&&(t=o.createElement(P.Info,null)),o.createElement(D.DialogConfirm,{title:this.getText(e.title)||D.I18n.t("ra_Please confirm"),text:this.getText(e.text),ok:this.getText(e.ok)||D.I18n.t("ra_Ok"),cancel:this.getText(e.cancel)||D.I18n.t("ra_Cancel"),icon:t,onClose:s=>this.setState({confirmDialog:!1},()=>s&&this._onClick())})}renderItem(e,t){return o.createElement(d.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:Dt.fullWidth,disabled:t,onClick:async()=>{this.props.schema.confirm?this.setState({confirmDialog:!0}):await this._onClick()}},this.props.schema.icon?o.createElement(D.Icon,{src:this.props.schema.icon,style:Dt.icon}):null,this.getText(this.props.schema.label,this.props.schema.noTranslation))}}const Ct={fullWidth:{width:"100%"},slider:{marginLeft:10,marginRight:10,width:"calc(100% - 20px)"}};class Fn extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.setState({_value:e})}static getDerivedStateFromProps(e,t){if(e.schema.min!==void 0&&e.schema.min<0||e.schema.max!==void 0&&e.schema.max<0)return null;const s=b.getValue(e.data,e.attr);return s==null||s.toString()!==parseFloat(t._value).toString()?{_value:s}:null}renderItem(e,t){const s=this.props.schema.min||0,i=this.props.schema.max||100,n=this.props.schema.unit?this.getText(this.props.schema.unit,this.props.schema.noTranslation):"",r=[{value:s,label:s+n},{value:i,label:i+n}];return o.createElement(d.Box,{style:Ct.fullWidth},this.props.schema.label?o.createElement(d.Typography,{gutterBottom:!0},this.getText(this.props.schema.label)):null,o.createElement(d.Slider,{style:Ct.slider,value:this.state._value,getAriaValueText:a=>a+n,step:this.props.schema.step||(i-s)/100,valueLabelDisplay:"auto",marks:r,min:s,max:i,disabled:!!t,onChange:a=>{const l=a.target.value;this.setState({_value:l},()=>this.onChange(this.props.attr,l))}}),this.props.schema.help?o.createElement(d.Typography,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}function De(h,e){return h==="edit"||h==="rename"?o.createElement(P.Edit,{style:e}):h==="delete"?o.createElement(P.Delete,{style:e}):h==="refresh"?o.createElement(P.Refresh,{style:e}):h==="newDevice"||h==="new"||h==="add"?o.createElement(P.Add,{style:e}):h==="discover"||h==="search"?o.createElement(P.Search,{style:e}):h==="unpairDevice"||h==="unpair"?o.createElement(P.LinkOff,{style:e}):h==="pairDevice"||h==="pair"?o.createElement(P.Link,{style:e}):h==="identify"?o.createElement(P.NotListedLocation,{style:e}):h==="play"?o.createElement(P.PlayArrow,{style:e}):h==="stop"?o.createElement(P.Stop,{style:e}):h==="pause"?o.createElement(P.Pause,{style:e}):h==="forward"||h==="next"?o.createElement(P.FastForward,{style:e}):h==="rewind"||h==="previous"?o.createElement(P.FastRewind,{style:e}):h==="lamp"||h==="light"?o.createElement(P.Lightbulb,{style:e}):h==="backlight"?o.createElement(P.Fluorescent,{style:e}):h==="dimmer"?o.createElement(P.WbIncandescent,{style:e}):h==="socket"?o.createElement(P.Power,{style:e}):h==="settings"?o.createElement(P.Settings,{style:e}):h==="users"||h==="group"?o.createElement(P.Group,{style:e}):h==="user"?o.createElement(P.Person,{style:e}):h==="qrcode"?o.createElement(P.QrCode,{style:e}):h==="connection"?o.createElement(P.Wifi,{style:e}):h==="no-connection"?o.createElement(P.WifiOff,{style:e}):h==="visible"?o.createElement(P.Visibility,{style:e}):null}function Sn(h,e){return typeof e=="string"?{"@keyframes newStateAnimationOnceColor":{"0%":{color:e},"100%":{color:h.palette.mode==="dark"?"#fff":"#000"}},animation:"newStateAnimationOnceColor 2s ease-in-out"}:{"@keyframes newStateAnimationOnce":{"0%":{color:"#00f900"},"80%":{color:h.palette.mode==="dark"?"#518851":"#008000"},"100%":{color:h.palette.mode==="dark"?"#fff":"#000"}},animation:"newStateAnimationOnce 2s ease-in-out"}}class Tn extends b{controlTimeout=null;delayedUpdate={timer:null,value:null};getObjectID(){return this.props.schema.foreign?this.props.schema.oid:`${this.props.schema.system?"system.adapter.":""}${this.props.oContext.adapterName}.${this.props.oContext.instance}.${this.props.schema.oid}`}async componentDidMount(){super.componentDidMount();const e=await this.props.oContext.socket.getObject(this.getObjectID()),t=this.props.schema.control||this.detectType(e),s=await this.props.oContext.socket.getState(this.getObjectID());this.setState({stateValue:s?s.val:null,controlType:t,obj:e},async()=>{await this.props.oContext.socket.subscribeState(this.getObjectID(),this.onStateChanged)})}componentWillUnmount(){super.componentWillUnmount(),this.props.oContext.socket.unsubscribeState(this.getObjectID(),this.onStateChanged),this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null),this.controlTimeout&&(clearTimeout(this.controlTimeout),this.controlTimeout=null,this.props.oContext.socket.setState(this.getObjectID(),this.state.stateValue,!1).catch(e=>console.error(`Cannot control value: ${e.toString()}`)))}onStateChanged=(e,t)=>{let s=t?t.val:null;this.state.controlType==="button"||this.state.controlType==="switch"?(s=!!s,this.state.stateValue!==s&&this.setState({stateValue:s})):s!==null&&(this.state.controlType==="slider"||this.state.controlType==="number")?(s=parseFloat(s),console.log(`${Date.now()} Received new value: ${s}`),s!==this.state.stateValue?(this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null),this.delayedUpdate.value=s,this.delayedUpdate.timer=setTimeout(()=>{this.setState({stateValue:this.delayedUpdate.value})},500)):this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null)):this.state.stateValue.toString()!==s.toString()&&this.setState({stateValue:s})};detectType(e){if(e=e||{},e.common=e.common||{},e.common.type==="boolean"){if(this.props.schema.controlled!==!1){if(e.common.read===!1||this.props.schema.controlled===!0)return"button";if(e.common.write||this.props.schema.controlled===!0)return"switch"}return"text"}return e.common.type==="number"&&this.props.schema.controlled!==!1?e.common.write||this.props.schema.controlled===!0?e.common.max!==void 0?"slider":"input":"text":e.common.write&&this.props.schema.controlled!==!1?"input":"text"}renderItem(e,t){var i,n,r,a,l;if(!this.state.obj)return null;let s;if(this.state.controlType==="button"||!this.state.controlType&&this.state.obj.common.type==="boolean"&&(this.state.obj.common.write&&this.state.obj.common.read===!1||(i=this.state.obj.common.role)!=null&&i.includes("button"))){let c=null;this.props.schema.falseImage&&(c=De(this.props.schema.falseImage));const u=this.getText(this.props.schema.falseText||this.props.schema.label,this.props.schema.noTranslation);!u&&c?s=o.createElement(d.IconButton,{style:this.props.schema.falseTextStyle,disabled:!!this.props.schema.readOnly,onClick:async()=>{this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:async m=>{m&&await this.props.oContext.socket.setState(this.getObjectID(),this.props.schema.buttonValue!==void 0?this.props.schema.buttonValue:!0,!1)}}):await this.props.oContext.socket.setState(this.getObjectID(),this.props.schema.buttonValue!==void 0?this.props.schema.buttonValue:!0,!1)}},c):s=o.createElement(d.Button,{variant:this.props.schema.variant||"contained",startIcon:c,style:this.props.schema.falseTextStyle,disabled:t||!!this.props.schema.readOnly,onClick:async()=>{this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:async m=>{m&&await this.props.oContext.socket.setState(this.getObjectID(),this.props.schema.buttonValue!==void 0?this.props.schema.buttonValue:!0,!1)}}):await this.props.oContext.socket.setState(this.getObjectID(),this.props.schema.buttonValue!==void 0?this.props.schema.buttonValue:!0,!1)}},u||this.getObjectID().split(".").pop())}else if(this.state.controlType==="input"||!this.state.controlType&&this.state.obj.common.write&&this.state.obj.common.type==="string")s=o.createElement(d.TextField,{style:{width:"100%"},value:this.state.stateValue,variant:"standard",slotProps:{input:{endAdornment:this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||void 0},htmlInput:{readOnly:!!this.props.schema.readOnly}},onChange:c=>{this.setState({stateValue:c.target.value},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(async()=>{this.controlTimeout=null,await this.props.oContext.socket.setState(this.getObjectID(),this.state.stateValue,!1)},this.props.schema.controlDelay||0)})},label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});else{let c;this.props.schema.size==="normal"?c=16:this.props.schema.size==="large"?c=20:typeof this.props.schema.size=="number"&&(c=this.props.schema.size);let u=this.getText(this.props.schema.label,this.props.schema.noTranslation);const m={display:"flex",alignItems:"center",fontSize:c||"1rem",gap:8};this.props.schema.narrow||(m.width="100%",m.justifyContent="space-between"),u.trim()&&!u.trim().endsWith(":")&&this.props.schema.addColon&&(u=`${u.trim()}:`);let y;this.props.schema.blinkOnUpdate&&(y=Sn(this.props.oContext.theme,this.props.schema.blinkOnUpdate));let _;this.props.schema.labelIcon&&(_=o.createElement(D.Icon,{src:this.props.schema.labelIcon,style:{marginRight:4}}));let T;if(u&&_?T=o.createElement("div",{style:{whiteSpace:"nowrap"}},_,u):u?T=o.createElement("div",{style:{whiteSpace:"nowrap"}},u):_&&(T=_),this.state.controlType==="switch"||!this.state.controlType&&this.state.obj.common.type==="boolean"&&(this.state.obj.common.write&&this.state.obj.common.read!==!1||(n=this.state.obj.common.role)!=null&&n.includes("switch"))){let A=null;const w=this.getText(this.props.schema.falseText,this.props.schema.noTranslation);this.props.schema.falseImage&&(A=De(this.props.schema.falseImage,w?{marginLeft:8}:void 0));let F=null;const S=this.getText(this.props.schema.trueText,this.props.schema.noTranslation);this.props.schema.trueImage&&(F=De(this.props.schema.trueImage,S?{marginRight:8}:void 0)),s=o.createElement(d.Switch,{checked:!!this.state.stateValue,disabled:!!this.props.schema.readOnly,onChange:async()=>{this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:async L=>{L&&await this.props.oContext.socket.setState(this.getObjectID(),!this.state.stateValue,!1)}}):await this.props.oContext.socket.setState(this.getObjectID(),!this.state.stateValue,!1)}}),(w||A||S||F)&&(s=o.createElement("div",{style:{display:"flex",alignItems:"center",fontSize:14}},o.createElement("span",{style:this.props.schema.falseTextStyle},w,A),s,o.createElement("span",{style:this.props.schema.trueTextStyle},F,S))),T&&(s=o.createElement("div",{style:m},T,s))}else if(this.state.controlType==="slider"||!this.state.controlType&&this.state.obj.common.type==="number"&&(this.state.obj.common.write&&(this.state.obj.common.max!==void 0||this.state.obj.common.unit==="%")||(r=this.state.obj.common.role)!=null&&r.includes("slider")||(a=this.state.obj.common.role)!=null&&a.includes("dimmer")||(l=this.state.obj.common.role)!=null&&l.includes("blind"))){let A=null;const w=this.getText(this.props.schema.falseText,this.props.schema.noTranslation);this.props.schema.falseImage&&(A=De(this.props.schema.falseImage,w?{marginLeft:8}:void 0));let F=null;const S=this.getText(this.props.schema.trueText,this.props.schema.noTranslation);this.props.schema.trueImage&&(F=De(this.props.schema.trueImage,S?{marginRight:8}:void 0));const L=this.props.schema.min===void 0?this.state.obj.common.min||0:this.props.schema.min,x=this.props.schema.max===void 0?this.state.obj.common.max===void 0?100:this.state.obj.common.max:this.props.schema.max,C=this.props.schema.step===void 0?this.state.obj.common.step||1:this.props.schema.step;s=o.createElement(d.Slider,{style:{width:"100%",flexGrow:1},min:L,max:x,disabled:!!this.props.schema.readOnly,step:C,value:this.state.stateValue,valueLabelDisplay:"auto",valueLabelFormat:p=>`${p}${this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||""}`,onChange:(p,g)=>{this.setState({stateValue:g},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(async()=>{console.log(`${Date.now()} Send new value: ${this.state.stateValue}`),this.controlTimeout=null,await this.props.oContext.socket.setState(this.getObjectID(),this.state.stateValue,!1)},this.props.schema.controlDelay||0)})}}),(w||A||S||F)&&(s=o.createElement("div",{style:{display:"flex",width:"100%",flexGrow:1,alignItems:"center"}},o.createElement("span",{style:{marginRight:16,...this.props.schema.falseTextStyle}},w,A),s,o.createElement("span",{style:{marginLeft:16,...this.props.schema.trueTextStyle}},F,S))),T&&(s=o.createElement("div",{style:m},T,s))}else if(this.state.obj.common.type==="number"&&this.state.obj.common.write){const A=this.props.schema.min===void 0?this.state.obj.common.min===void 0?void 0:this.state.obj.common.min:this.props.schema.min,w=this.props.schema.max===void 0?this.state.obj.common.max===void 0?void 0:this.state.obj.common.max:this.props.schema.max,F=this.props.schema.step===void 0?this.state.obj.common.step===void 0?void 0:this.state.obj.common.step:this.props.schema.step;s=o.createElement(d.TextField,{variant:"standard",style:{width:"100%"},value:this.state.stateValue,type:"number",slotProps:{htmlInput:{min:A,max:w,step:F,readOnly:!!this.props.schema.readOnly},input:{endAdornment:this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||void 0}},onChange:S=>{this.setState({stateValue:S.target.value},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(async()=>{this.controlTimeout=null;const L=parseFloat(this.state.stateValue);await this.props.oContext.socket.setState(this.getObjectID(),L,!1)},this.props.schema.controlDelay||0)})},label:this.getText(this.props.schema.label,this.props.schema.noTranslation),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}else if(this.state.obj.common.type==="boolean"){let A=null,w,F;this.state.stateValue?(w=this.getText(this.props.schema.trueText,this.props.schema.noTranslation),this.props.schema.trueImage&&(A=De(this.props.schema.falseImage,w?{marginRight:8}:void 0)),F=this.props.schema.trueTextStyle):(w=this.getText(this.props.schema.falseText,this.props.schema.noTranslation),this.props.schema.falseImage&&(A=De(this.props.schema.falseImage,w?{marginLeft:8}:void 0)),F=this.props.schema.falseTextStyle),F=Object.assign(m,F),s=o.createElement("div",{style:F},T,o.createElement(d.Box,{style:{display:"flex",alignItems:"center",gap:8},sx:y,key:this.props.schema.blinkOnUpdate?w:void 0},A,w||(this.state.stateValue?D.I18n.t("ra_true"):D.I18n.t("ra_false"))))}else{const A=this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit;let w,F;this.state.controlType==="html"?(F=(this.state.stateValue||"").toString(),w=o.createElement("span",{dangerouslySetInnerHTML:{__html:this.state.stateValue}})):this.state.stateValue===null?(w="null",F=w):this.state.stateValue===void 0?(w="undefined",F=w):(w=this.state.stateValue.toString(),F=w),s=o.createElement("div",{style:m},T,o.createElement("div",{style:{display:"flex",alignItems:"baseline",gap:4}},o.createElement(d.Box,{sx:y,key:this.props.schema.blinkOnUpdate?F:void 0},w),A?o.createElement("span",{style:{opacity:.7,fontSize:"smaller"}},A):null))}}return s}}const Ye={fullWidth:h=>({width:"100%",backgroundColor:h.palette.mode==="dark"?"#FFF":"#000",borderStyle:"hidden"}),primary:h=>({backgroundColor:h.palette.primary.main}),secondary:h=>({backgroundColor:h.palette.secondary.main})};class _n extends b{renderItem(){return o.createElement(d.Box,{component:"hr",sx:D.Utils.getStyle(this.props.oContext.theme,Ye.fullWidth,this.props.schema.color==="primary"?Ye.primary:this.props.schema.color==="secondary"?Ye.secondary:{backgroundColor:this.props.schema.color||(this.props.oContext.themeType==="dark"?"#333":"#ddd")},{height:this.props.schema.color?this.props.schema.height||2:this.props.schema.height||1})})}}const In={header:h=>({width:"100%",background:h.palette.primary.main,color:h.palette.primary.contrastText,padding:"4px !important",borderRadius:"3px",marginBlockEnd:0,marginBlockStart:0})};class kn extends b{renderItem(){let e="h5";switch((this.props.schema.size||5).toString()){case"1":e="h1";break;case"2":e="h2";break;case"3":e="h3";break;case"4":e="h4";break;case"5":default:e="h5";break}return o.createElement(d.Box,{component:e,sx:In.header},this.getText(this.props.schema.label||this.props.schema.text,this.props.schema.noTranslation))}}class Bn extends b{renderItem(){let e=this.props.schema.src;return e&&!e.startsWith(".")&&!e.startsWith("http")&&!e.startsWith(`adapter/${this.props.oContext.adapterName}/`)&&!e.startsWith(`./adapter/${this.props.oContext.adapterName}/`)&&(e=`adapter/${this.props.oContext.adapterName}/${e}`),o.createElement("img",{src:e,style:{cursor:this.props.schema.href?"pointer":void 0,width:"100%",height:"100%"},onClick:this.props.schema.href?()=>this.props.schema.href&&window.open(this.props.schema.href,"_blank"):null,alt:""})}}function yt(h,e,t){return typeof t=="string"?{"@keyframes newValueAnimationOnceColor":{"0%":{color:e?`${t} !important`:t},"100%":{color:h.palette.mode==="dark"?e?"#fff !important":"#fff":e?"#000 !important":"#000"}},animation:"newValueAnimationOnceColor 2s ease-in-out"}:{"@keyframes newValueAnimationOnce":{"0%":{color:e?"#00f900 !important":"#00f900"},"80%":{color:h.palette.mode==="dark"?e?"#518851 !important":"#518851":e?"#008000 !important":"#008000"},"100%":{color:h.palette.mode==="dark"?e?"#fff !important":"#fff":e?"#000 !important":"#000"}},animation:"newValueAnimationOnce 2s ease-in-out"}}function vt(h,e){return typeof e=="string"?{"@keyframes blinkAnimationColor":{"0%":{color:e},"100%":{color:h.palette.mode==="dark"?"#fff":"#000"}},animation:"blinkAnimationColor 2s ease-in-out infinite"}:{"@keyframes blinkAnimation":{"0%":{color:"#00f900"},"80%":{color:h.palette.mode==="dark"?"#518851":"#008000"},"100%":{color:h.palette.mode==="dark"?"#fff":"#000"}},animation:"blinkAnimation 2s ease-in-out infinite"}}const we={label:{fontWeight:"bold",whiteSpace:"nowrap"},valueImage:{maxHeight:"100%"},valueAndUnit:{display:"flex",gap:4,alignItems:"baseline"},value:{},unit:{fontSize:"smaller",opacity:.7}};class On extends b{renderItem(e){let t=this.getText(this.props.schema.text||this.props.schema.label,this.props.schema.noTranslation);this.props.schema.addColon&&typeof t=="string"&&!t.trim().endsWith(":")&&(t=`${t.trim()}:`),t&&(t.includes("<a ")||t.includes("<br")||t.includes("<b>")||t.includes("<i>"))&&(t=D.Utils.renderTextWithA(t));let s;this.props.schema.size==="normal"?s=16:this.props.schema.size==="large"?s=20:typeof this.props.schema.size=="number"&&(s=this.props.schema.size);const i={width:"100%",height:"100%",display:"flex",alignItems:"center",position:"relative",fontSize:s};this.props.schema.narrow?i.gap=8:i.justifyContent="space-between";let n,r;this.props.schema.data&&typeof this.props.schema.data=="object"&&this.props.schema.data.en?r=this.getText(this.props.schema.data):typeof this.props.schema.data=="object"||this.props.schema.data===void 0||this.props.schema.data===null?r=JSON.stringify(this.props.schema.data):typeof this.props.schema.data=="number"?(r=this.props.schema.data.toString(),this.props.oContext.isFloatComma&&(r=r.replace(".",","))):(!this.props.schema.booleanAsCheckbox||typeof this.props.schema.data!="boolean")&&(r=this.props.schema.data.toString());let a=!1;if(this.props.schema.booleanAsCheckbox&&typeof this.props.schema.data=="boolean")n=o.createElement(d.Checkbox,{checked:!!n,disabled:!0,size:this.props.schema.size==="small"?"small":this.props.schema.size==="large"?"large":void 0});else if(r.startsWith("data:image/"))n=o.createElement("div",{style:{...we.value,...we.valueImage,...this.props.schema.styleValue||void 0}},o.createElement(D.Icon,{src:r}));else{const m={...we.value,...this.props.schema.styleValue||void 0};this.props.schema.html?n=o.createElement("div",{style:m,dangerouslySetInnerHTML:{__html:r}}):Array.isArray(this.props.schema.data)?(a=!0,n=o.createElement("div",{style:m},this.props.schema.data.map((y,_)=>o.createElement("div",{key:_},typeof y=="object"||y===null||y===void 0?JSON.stringify(y):y)))):r.includes(`
`)?(a=!0,n=o.createElement("div",{style:m},D.Utils.renderTextWithA(r))):n=o.createElement("div",{style:m},r)}if(this.props.schema.blinkOnUpdate&&this.props.schema.blink){const m=yt(this.props.oContext.theme,!0,this.props.schema.blinkOnUpdate),y=vt(this.props.oContext.theme,this.props.schema.blink);n=o.createElement(d.Box,{key:r,sx:{...m,...y}},n)}else if(this.props.schema.blinkOnUpdate){const m=yt(this.props.oContext.theme,!1,this.props.schema.blinkOnUpdate);n=o.createElement(d.Box,{key:r,sx:m},n)}else if(this.props.schema.blink){const m=vt(this.props.oContext.theme,this.props.schema.blink);n=o.createElement(d.Box,{sx:m},n)}this.props.schema.unit&&(n=o.createElement("div",{style:we.valueAndUnit},n,o.createElement("div",{style:{...we.unit,...this.props.schema.styleUnit||void 0}},this.getText(this.props.schema.unit,this.props.schema.noTranslation))));let l;this.props.schema.labelIcon&&(l=o.createElement(D.Icon,{src:this.props.schema.labelIcon,style:{marginRight:4}}));let c;this.props.schema.copyToClipboard&&(c=o.createElement(P.ContentCopy,{className:"staticCopyButton",style:{position:"absolute",top:"calc(50% - 12px)",right:0,cursor:"pointer"},onClick:()=>{D.Utils.copyToClipboard(r),window.alert(D.I18n.t("ra_Copied"))}}));const u={"& .staticCopyButton":{display:"none"},"& .staticCopyButton:action":{transform:"scale(0.9)"},"&:hover .staticCopyButton":{display:"block"}};return this.props.schema.highlight&&(u["&:hover"]={backgroundColor:this.props.oContext.themeType==="dark"?"#51515180":"#b8b8b880"}),a&&(i.alignItems="top"),o.createElement(d.Box,{component:"div",style:i,sx:u},o.createElement("div",{style:{...we.label,...this.props.schema.styleLabel||void 0}},l,t),n,c)}}const Et={fullWidth:{height:"100%",width:"100%"},link:h=>({textDecoration:"underline",color:h.palette.mode==="dark"?"#4dabf5":"#254e72",cursor:"pointer"})};function bt(h,e,t){let s,i="";h?h.toString().startsWith("#")||h.toString().startsWith("/")?(s=e||"_self",i=h):h.startsWith("http://")||h.startsWith("https://")?(s=e||"_blank",i=h):(i=`#tab-instances/config/${t}/${h}`,s=e||"_self"):(i=`#tab-instances/config/${t}`,s=e||"_self"),s==="_self"?setTimeout(n=>{n.startsWith("#")?window.location.hash=n:n.startsWith("/")?i=`${window.location.protocol}:${window.location.host}${i}`:(n.startsWith("http://")||n.startsWith("https://"))&&(window.location.href=n)},100,i):(i.startsWith("#")?i=`${window.location.protocol}:${window.location.host}${window.location.pathname}${i}`:i.startsWith("/")&&(i=`${window.location.protocol}:${window.location.host}${i}`),window.open(i,s))}class xt extends b{renderItem(e,t){if(this.props.schema.button){const i=this.getIcon();return o.createElement(d.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:{...Et.fullWidth,...this.props.schema.controlStyle||void 0},disabled:t,startIcon:i,onClick:this.props.schema.href?()=>{const n=this.props.schema.href?this.getText(this.props.schema.href,!0):null;n&&(this.props.oContext.onBackEndCommand?this.props.oContext.onBackEndCommand({command:"link",url:n,target:this.props.schema.target,close:this.props.schema.close}):bt(n,this.props.schema.target,`${this.props.oContext.adapterName}.${this.props.oContext.instance}`))}:null},this.getText(this.props.schema.text||this.props.schema.label,this.props.schema.noTranslation))}let s=this.getText(this.props.schema.text||this.props.schema.label,this.props.schema.noTranslation);return s&&(s.includes("<a ")||s.includes("<br")||s.includes("<b>")||s.includes("<i>"))&&(s=D.Utils.renderTextWithA(s)),o.createElement(d.Box,{component:"span",style:{...this.props.schema.controlStyle||void 0},sx:this.props.schema.href?Et.link:void 0,onClick:this.props.schema.href?()=>{const i=this.props.schema.href?this.getText(this.props.schema.href,!0):null;i&&(this.props.oContext.onBackEndCommand?this.props.oContext.onBackEndCommand({command:"link",url:i,target:this.props.schema.target||"_blank",close:this.props.schema.close}):bt(i,this.props.schema.target||"_blank",`${this.props.oContext.adapterName}.${this.props.oContext.instance}`))}:null},s)}}const Ze=1024*1024,X={paper:{width:"100%",marginBottom:16,backgroundColor:"rgba(255, 255, 255, 0.1)"},headerText:{width:"100%"},table:{minWidth:750},label:{display:"flex",justifyContent:"space-between"},title:{flex:"1 1 100%"},rootTool:{paddingLeft:16,paddingRight:8},silver:{opacity:.2},flex:{display:"flex",alignItems:"baseline"},filteredOut:{padding:10,display:"flex",textAlign:"center"},buttonEmpty:{width:34,display:"inline-block"},buttonCell:{whiteSpace:"nowrap"},dropZone:{width:"100%",height:100,position:"relative"},dropZoneEmpty:{},uploadDiv:{position:"relative",width:"100%",minHeight:300,opacity:.9,marginTop:30,cursor:"pointer",outline:"none"},uploadDivDragging:{opacity:1,background:"rgba(128,255,128,0.1)"},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"calc(100% - 10px)",height:"calc(100% - 10px)",minHeight:300,position:"relative",display:"flex"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},tooltip:{pointerEvents:"none"}};function $n(h,e,t){e=e||"key";const s=[];return Object.keys(h).forEach(i=>{const n={};n[e]=i,t?(n[t]=h[i],s.push(n)):s.push(Object.assign(n,h[i]))}),s}function wt(h,e,t){e=e||"key";const s={};return h.forEach(i=>{let n=i[e];n==null&&(n=""),delete i[e],t?s[n]=i[t]:s[n]=i}),s}function Ln(h,e){let t="";for(let s=0;s<e.length;s++)t+=String.fromCharCode(h[s%h.length].charCodeAt(0)^e.charCodeAt(s));return t}function Nn(h,e){let t="";for(let s=0;s<e.length;s++)t+=String.fromCharCode(h[s%h.length].charCodeAt(0)^e.charCodeAt(s));return t}class oe extends b{filterRefs;typingTimer=null;resizeTimeout=null;secret="Zgfr56gFe87jJOM";refDiv;constructor(e){super(e),this.filterRefs={},this.props.schema.items=this.props.schema.items||[],this.props.schema.items.forEach(t=>{t.filter&&(this.filterRefs[t.attr]=_e.createRef())}),this.refDiv=o.createRef()}async componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr)||[];let t;if(this.props.schema.objKeyName?t=$n(e,this.props.schema.objKeyName,this.props.schema.objValueName):t=e,Array.isArray(t)||(t=[]),this.props.schema.encryptedAttributes){const s=await this.props.oContext.socket.getCompactSystemConfig();this.secret=(s==null?void 0:s.native.secret)||this.secret,e.forEach(i=>{this.props.schema.encryptedAttributes.forEach(n=>{i[n]&&(i[n]=Nn(this.secret,i[n]))})})}this.setState({value:t,visibleValue:null,orderBy:"",order:"asc",iteration:0,filterOn:[],width:0},()=>this.validateUniqueProps())}componentWillUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),super.componentWillUnmount()}itemTable(e,t,s){var a;const{schema:i}=this.props,n=(a=i.items)==null?void 0:a.find(l=>l.attr===e);if(!n)return null;const r={items:{[e]:n}};return o.createElement(Ae,{oContext:this.props.oContext,alive:this.props.alive,arrayIndex:s,changed:this.props.changed,common:this.props.common,custom:!0,data:t,globalData:this.props.data,index:s+this.state.iteration,onChange:(l,c)=>{const u=JSON.parse(JSON.stringify(this.state.value));u[s][l]=c,this.setState({value:u},()=>{this.validateUniqueProps(),this.onChangeWrapper(u,!0)})},onError:(l,c)=>this.onError(l,c),originalData:this.props.originalData,schema:r,table:!0,themeName:this.props.themeName})}validateUniqueProps(){if(this.props.schema.uniqueColumns)for(const e of this.props.schema.uniqueColumns){const t=[];this.state.value.find(i=>{const n=i[e];return t.includes(n)?(this.onError(e,"is not unique"),this.setState({errorMessage:D.I18n.t('Non-allowed duplicate entry "%s" in column "%s"',n,e)}),!0):(t.push(n),!1)})||(this.onError(e,null),this.setState({errorMessage:""}))}}static descendingComparator(e,t,s){return t[s]<e[s]?-1:t[s]>e[s]?1:0}static getComparator(e,t){return e==="desc"?(s,i)=>oe.descendingComparator(s,i,t):(s,i)=>-oe.descendingComparator(s,i,t)}static getFilterValue(e){var t,s,i;return(i=(s=(t=e==null?void 0:e.current)==null?void 0:t.children[0])==null?void 0:s.children[0])==null?void 0:i.value}static setFilterValue(e,t){return e.current.children[0].children[0].value=t}handleRequestSort=(e,t=!1)=>{const{order:s,orderBy:i}=this.state,r=t?s:i===e&&s==="asc"?"desc":"asc",a=this.stableSort(r,e);JSON.stringify(a)!==JSON.stringify(this.state.value)&&this.setState({value:a,order:r,orderBy:e,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,a))};stableSort=(e,t)=>{const{value:s}=this.state,i=oe.getComparator(e,t),n=s.map((r,a)=>({el:r,index:a}));return n.sort((r,a)=>{const l=i(r.el,a.el);return l!==0?l:r.index-a.index}),n.map(r=>r.el)};renderShowHideFilter(e){return e.filter?o.createElement(d.IconButton,{title:D.I18n.t("ra_Show/hide filter input"),size:"small",onClick:()=>{const t=[...this.state.filterOn],s=this.state.filterOn.indexOf(e.attr);s===-1?t.push(e.attr):t.splice(s,1),this.setState({filterOn:t},()=>{s&&oe.getFilterValue(this.filterRefs[e.attr])&&(oe.setFilterValue(this.filterRefs[e.attr],""),this.applyFilter())})}},this.state.filterOn.includes(e.attr)?o.createElement(P.FilterAltOff,null):o.createElement(P.FilterAlt,null)):null}renderImportExportButtons(e){return o.createElement(o.Fragment,null,!e.noDelete&&e.import?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Import data from %s file","CSV"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.setState({showImportDialog:!0})},o.createElement(P.UploadFile,null))):null,e.export?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Export data to %s file","CSV"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.onExport()},o.createElement(P.Download,null))):null,o.createElement(d.IconButton,{disabled:!0,size:"small"},o.createElement(P.Delete,null)))}renderAddButton(e){return o.createElement(d.Tooltip,{title:e?D.I18n.t("ra_Cannot add items with set filter"):D.I18n.t("ra_Add row"),slotProps:{popper:{sx:X.tooltip}}},o.createElement("span",null,o.createElement(d.IconButton,{size:"small",color:"primary",disabled:!!e&&!this.props.schema.allowAddByFilter,onClick:this.onAdd},o.createElement(P.Add,null))))}enhancedTableHead(e,t){var r;const{schema:s}=this.props,{order:i,orderBy:n}=this.state;return o.createElement(d.TableHead,null,o.createElement(d.TableRow,null,(r=s.items)==null?void 0:r.map((a,l)=>this.renderOneFilter({schema:s,style:{width:a.width},showAddButton:!l&&!s.noDelete,headCell:a,order:i,orderBy:n,index:l,doAnyFilterSet:t})),!s.noDelete&&o.createElement(d.TableCell,{style:{paddingLeft:20,paddingRight:20,width:e,textAlign:"right"},padding:"checkbox"},this.renderImportExportButtons(s))))}onDelete=e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value));t.splice(e,1),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))};onExport(){const{schema:e}=this.props,{value:t}=this.state,i=[e.items.map(a=>a.attr).join(";")];t.forEach(a=>{const l=[];e.items.forEach(c=>{var u;(u=a[c.attr])!=null&&u.includes(";")?l.push(`"${a[c.attr]}"`):l.push(a[c.attr]===void 0||a[c.attr]===null?"":a[c.attr])}),i.push(l.join(";"))});const n=document.createElement("a");n.setAttribute("href",`data:text/csv;charset=utf-8,${encodeURIComponent(i.join(`
`))}`);const r=new Date;n.setAttribute("download",`${r.getFullYear()}_${(r.getMonth()+1).toString().padStart(2,"0")}_${r.getDate().toString().padStart(2,"0")}_${this.props.oContext.adapterName}.${this.props.oContext.instance}_${this.props.attr}.csv`),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}onImport(e){var r;const t=e.split(`
`).map(a=>a.replace("\r","").trim()),{schema:s}=this.props,i=t.shift().split(";").filter(a=>a&&s.items.find(l=>l.attr===a)),n=[];t.forEach(a=>{const l=a.split(";"),c={};for(let u=0;u<l.length;u++){let m=l[u];if(m.startsWith('"')){for(m=m.substring(1);u<l.length&&!m.endsWith('"');)m+=`;${l[++u]}`;m=m.substring(0,m.length-1)}let y=m;if(m==="true")y=!0;else if(m==="false")y=!1;else if(window.isFinite(m)){const _=this.props.schema.items.find(T=>T.attr===i[u]);_&&_.type==="number"?y=parseFloat(m):y=m}else y=m;c[i[u]]=y}n.push(c)}),n.length?(r=this.state.value)!=null&&r.length?this.setState({showTypeOfImportDialog:n,showImportDialog:!1}):this.setState({value:n,showImportDialog:!1}):window.alert("ra_No data found in file")}onClone=e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value)),s=JSON.parse(JSON.stringify(t[e]));if(typeof this.props.schema.clone=="string"&&typeof s[this.props.schema.clone]=="string"){let i=1,n=s[this.props.schema.clone];const r=n.match(/(\d+)$/);for(r?(n=n.replace(r[0],""),i=parseInt(r[0],10)+1):n+="_";t.find(a=>a[this.props.schema.clone]===n+i.toString());)i++;s[this.props.schema.clone]=`${s[this.props.schema.clone]}_${i}`}t.splice(e,0,s),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))};onChangeWrapper=(e,t)=>{this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=setTimeout((s,i)=>{this.typingTimer=null;let n;if(this.props.schema.encryptedAttributes){const r=JSON.parse(JSON.stringify(s));if(r.forEach(a=>{this.props.schema.encryptedAttributes.forEach(l=>{a[l]&&(a[l]=Ln(this.secret,a[l]))})}),this.props.schema.objKeyName){const a=wt(r,this.props.schema.objKeyName,this.props.schema.objValueName);n=this.onChange(this.props.attr,a)}else n=this.onChange(this.props.attr,r)}else if(this.props.schema.objKeyName){const r=wt(JSON.parse(JSON.stringify(s)),this.props.schema.objKeyName,this.props.schema.objValueName);n=this.onChange(this.props.attr,r)}else n=this.onChange(this.props.attr,s);n instanceof Promise&&n.catch(r=>console.error(`Cannot save: ${r}`)),i&&(this.applyFilter(!1,s),this.handleRequestSort(this.state.orderBy,!0))},300,e,t)};onAdd=()=>{var i;const{schema:e}=this.props,t=JSON.parse(JSON.stringify(this.state.value)),s=(i=e.items)==null?void 0:i.reduce((n,r)=>{let a;return r.defaultFunc?this.props.custom?a=r.defaultFunc?this.executeCustom(r.defaultFunc,this.props.data,this.props.customObj,this.props.oContext.instanceObj,t.length,this.props.data):this.props.schema.default:a=r.defaultFunc?this.execute(r.defaultFunc,this.props.schema.default,this.props.data,t.length,this.props.data):this.props.schema.default:a=r.default===void 0?null:r.default,n[r.attr]=a,n},{});t.push(s),this.setState({value:t},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))};isAnyFilterSet(){return!!Object.keys(this.filterRefs).find(e=>oe.getFilterValue(this.filterRefs[e]))}applyFilter=(e,t,s)=>{t=t||this.state.value;let i=t.map((n,r)=>r);if(Object.keys(this.filterRefs).forEach(n=>{let r=oe.getFilterValue(this.filterRefs[n]);!e&&r?(r=r.toLowerCase(),i=i.filter(a=>t[a]&&t[a][n]&&t[a][n].toLowerCase().includes(r))):this.filterRefs[n].current&&oe.setFilterValue(this.filterRefs[n],"")}),i.length===t.length&&(i=null),i===null&&this.state.visibleValue===null){s&&s();return}JSON.stringify(i)!==JSON.stringify(this.state.visibleValue)?this.setState({visibleValue:i},()=>s&&s()):s&&s()};onMoveUp(e){const t=JSON.parse(JSON.stringify(this.state.value)),s=t[e];t.splice(e,1),t.splice(e-1,0,s),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))}onMoveDown(e){const t=JSON.parse(JSON.stringify(this.state.value)),s=t[e];t.splice(e,1),t.splice(e+1,0,s),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))}onDrop(e){const t=e[0],s=new FileReader;s.onabort=()=>console.log("file reading was aborted"),s.onerror=()=>console.log("file reading has failed"),s.onload=()=>{if(t.size>Ze){window.alert(D.I18n.t("ra_File is too big. Max %sk allowed. Try use SVG.",Math.round(Ze/1024)));return}const i=new Uint8Array(s.result).reduce((n,r)=>n+String.fromCharCode(r),"");this.onImport(i)},s.readAsArrayBuffer(t)}showTypeOfImportDialog(){return this.state.showTypeOfImportDialog?o.createElement(d.Dialog,{open:!0,onClose:()=>this.setState({showTypeOfImportDialog:!1}),maxWidth:"md"},o.createElement(d.DialogTitle,null,D.I18n.t("ra_Append or replace?")),o.createElement(d.DialogContent,null,D.I18n.t("ra_Append %s entries or replace existing?",this.state.showTypeOfImportDialog.length)),o.createElement(d.DialogActions,null,o.createElement(d.Button,{variant:"contained",color:"primary",autoFocus:!0,onClick:()=>{const e=JSON.parse(JSON.stringify(this.state.value));this.state.showTypeOfImportDialog.forEach(t=>e.push(t)),this.setState({value:e,iteration:this.state.iteration+1e4,showTypeOfImportDialog:!1},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(e)))}},D.I18n.t("ra_Append")),o.createElement(d.Button,{variant:"contained",color:"secondary",autoFocus:!0,onClick:()=>{const e=this.state.showTypeOfImportDialog;this.setState({value:e,iteration:this.state.iteration+1e4,showTypeOfImportDialog:!1},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(e)))}},D.I18n.t("ra_Replace")))):null}showImportDialog(){return this.state.showImportDialog?o.createElement(d.Dialog,{open:!0,onClose:()=>this.setState({showImportDialog:!1}),sx:{"& .MuiDialog-paper":{minHeight:500}},maxWidth:"md",fullWidth:!0},o.createElement(d.DialogTitle,null,D.I18n.t("ra_Import from %s","CSV")),o.createElement(d.DialogContent,null,o.createElement(Tt,{multiple:!1,accept:{"text/csv":[".csv"]},maxSize:Ze,onDragEnter:()=>this.setState({uploadFile:"dragging"}),onDragLeave:()=>this.setState({uploadFile:!0}),onDrop:(e,t)=>{this.setState({uploadFile:!1}),e.length?this.onDrop(e):window.alert(t&&t[0]&&t[0].errors&&t[0].errors[0]&&t[0].errors[0].message||D.I18n.t("ra_Cannot upload"))}},({getRootProps:e,getInputProps:t})=>o.createElement("div",{style:{...X.uploadDiv,...this.state.uploadFile==="dragging"?X.uploadDivDragging:void 0,...X.dropZone,...this.state.icon?void 0:X.dropZoneEmpty},...e()},o.createElement("input",{...t()}),o.createElement("div",{style:X.uploadCenterDiv},o.createElement("div",{style:X.uploadCenterTextAndIcon},o.createElement(P.UploadFile,{style:X.uploadCenterIcon}),o.createElement("div",{style:X.uploadCenterText},this.state.uploadFile==="dragging"?D.I18n.t("ra_Drop file here"):D.I18n.t("ra_Place your files here or click here to open the browse dialog"))))))),o.createElement(d.DialogActions,null,o.createElement(d.Button,{variant:"contained",onClick:()=>this.setState({showImportDialog:!1}),color:"primary",startIcon:o.createElement(P.Close,null)},D.I18n.t("Cancel")))):null}renderOneFilter(e){return o.createElement(d.TableCell,{key:`${e.headCell.attr}_${e.index}`,style:e.style,align:"left",sortDirection:e.orderBy===e.headCell.attr?e.order:!1},o.createElement("div",{style:{...X.flex,...e.schema.showFirstAddOnTop?{flexDirection:"column"}:void 0}},e.showAddButton?this.renderAddButton(e.doAnyFilterSet):null,e.headCell.sort&&o.createElement(d.TableSortLabel,{active:!0,style:e.orderBy!==e.headCell.attr?X.silver:void 0,direction:e.orderBy===e.headCell.attr?e.order:"asc",onClick:()=>this.handleRequestSort(e.headCell.attr)}),e.headCell.filter&&this.state.filterOn.includes(e.headCell.attr)?o.createElement(d.TextField,{variant:"standard",ref:this.filterRefs[e.headCell.attr],onChange:()=>this.applyFilter(),title:D.I18n.t("ra_You can filter entries by entering here some text"),slotProps:{input:{endAdornment:oe.getFilterValue(this.filterRefs[e.headCell.attr])&&o.createElement(d.InputAdornment,{position:"end"},o.createElement(d.IconButton,{size:"small",onClick:()=>{oe.setFilterValue(this.filterRefs[e.headCell.attr],""),this.applyFilter()}},o.createElement(P.Close,null)))}},fullWidth:!0,placeholder:this.getText(e.headCell.title)}):o.createElement("span",{style:X.headerText},this.getText(e.headCell.title)),this.renderShowHideFilter(e.headCell)))}enhancedFilterCard(){var n;const{schema:e}=this.props,{order:t,orderBy:s}=this.state;let i;return this.props.schema.compact&&(i={paddingTop:1,paddingBottom:1}),o.createElement(d.Grid2,{size:{xs:e.xs||12,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0}},o.createElement(d.Card,null,o.createElement(d.Paper,{style:X.paper},o.createElement(d.Accordion,{style:X.paper},o.createElement(d.AccordionSummary,{expandIcon:o.createElement(P.ExpandMore,null)},o.createElement(d.Typography,null,D.I18n.t("ra_Filter and Data Actions"))),o.createElement(d.AccordionDetails,null,o.createElement(d.Table,null,o.createElement(d.TableBody,null,(n=e.items)==null?void 0:n.map((r,a)=>o.createElement(d.TableRow,{key:`${r.attr}_${a}`},this.renderOneFilter({schema:e,style:i,showAddButton:!1,headCell:r,order:t,orderBy:s,index:a,doAnyFilterSet:!1}))),o.createElement(d.TableRow,null,o.createElement(d.TableCell,{align:"left",style:i},o.createElement("span",{style:X.headerText},D.I18n.t("ra_Actions"))),o.createElement(d.TableCell,{style:i},this.renderImportExportButtons(e))))))))))}enhancedBottomCard(){const{schema:e}=this.props;let t;this.props.schema.compact&&(t={paddingTop:1,paddingBottom:1});const s=this.isAnyFilterSet();return o.createElement(d.Grid2,{size:{xs:e.xs||12,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0}},o.createElement(d.Card,null,o.createElement(d.Paper,{style:X.paper},o.createElement(d.Table,null,o.createElement(d.TableBody,null,o.createElement(d.TableRow,null,o.createElement(d.TableCell,{colSpan:e.items.length+1,style:t},this.renderAddButton(s))))))))}renderCards(){const{schema:e}=this.props;let{visibleValue:t}=this.state,s;this.props.schema.compact&&(s={paddingTop:1,paddingBottom:1}),t=t||this.state.value.map((n,r)=>r);const i=this.isAnyFilterSet();return o.createElement(d.Grid2,{container:!0},this.showImportDialog(),this.showTypeOfImportDialog(),this.enhancedFilterCard(),t.map((n,r)=>{var a;return o.createElement(d.Grid2,{key:`${n}_${r}`,size:{xs:e.xs||12,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0}},o.createElement(d.Card,null,o.createElement(d.Paper,{style:X.paper},o.createElement(d.Table,null,o.createElement(d.TableBody,null,(a=e.items)==null?void 0:a.map(l=>o.createElement(d.TableRow,{key:`${l.attr}_${n}`},o.createElement(d.TableCell,{align:"left",style:s},o.createElement("span",{style:X.headerText},this.getText(l.title))),o.createElement(d.TableCell,{align:"left",style:s},this.itemTable(l.attr,this.state.value[n],n)))),o.createElement(d.TableRow,null,o.createElement(d.TableCell,{align:"left",style:s},o.createElement("span",{style:X.headerText},this.getText("Actions"))),o.createElement(d.TableCell,{align:"left",style:s},!i&&!this.state.orderBy?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move up"),slotProps:{popper:{sx:X.tooltip}}},o.createElement("span",null,o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveUp(n),disabled:r===0},o.createElement(P.ArrowUpward,null)))):null,!i&&!this.state.orderBy?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move down"),slotProps:{popper:{sx:X.tooltip}}},o.createElement("span",null,o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveDown(n),disabled:r===t.length-1},o.createElement(P.ArrowDownward,null)))):null,o.createElement(d.Tooltip,{title:D.I18n.t("ra_Delete current row"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onDelete(n)},o.createElement(P.Delete,null))),this.props.schema.clone?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Clone current row"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onClone(n)},o.createElement(P.ContentCopy,null))):null)))))))}),this.enhancedBottomCard())}renderTable(){const{schema:e}=this.props;let{visibleValue:t}=this.state;t=t||this.state.value.map((n,r)=>r);const s=this.isAnyFilterSet();let i;return this.props.schema.compact&&(i={paddingTop:1,paddingBottom:1}),o.createElement(d.Paper,{style:X.paper},this.showImportDialog(),this.showTypeOfImportDialog(),e.label?o.createElement("div",{style:X.label},o.createElement(d.Toolbar,{variant:"dense",style:X.rootTool},o.createElement(d.Typography,{style:X.title,variant:"h6",id:"tableTitle",component:"div"},this.getText(e.label)))):null,o.createElement(d.TableContainer,null,o.createElement(d.Table,{style:X.table,size:"small"},this.enhancedTableHead(!s&&!this.state.orderBy?120:64,s),o.createElement(d.TableBody,null,t.map((n,r)=>{var a;return o.createElement(d.TableRow,{hover:!0,key:`${n}_${r}`},(a=e.items)==null?void 0:a.map(l=>o.createElement(d.TableCell,{key:`${l.attr}_${n}`,align:"left",style:i},this.itemTable(l.attr,this.state.value[n],n))),!e.noDelete&&o.createElement(d.TableCell,{align:"left",style:{...i,...X.buttonCell}},!s&&!this.state.orderBy?r?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move up"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveUp(n)},o.createElement(P.ArrowUpward,null))):o.createElement("div",{style:X.buttonEmpty}):null,!s&&!this.state.orderBy?r<t.length-1?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Move down"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:()=>this.onMoveDown(n)},o.createElement(P.ArrowDownward,null))):o.createElement("div",{style:X.buttonEmpty}):null,o.createElement(d.Tooltip,{title:D.I18n.t("ra_Delete current row"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onDelete(n)},o.createElement(P.Delete,null))),this.props.schema.clone?o.createElement(d.Tooltip,{title:D.I18n.t("ra_Clone current row"),slotProps:{popper:{sx:X.tooltip}}},o.createElement(d.IconButton,{size:"small",onClick:this.onClone(n)},o.createElement(P.ContentCopy,null))):null))}),!e.noDelete&&t.length>=(e.showSecondAddAt||5)?o.createElement(d.TableRow,null,o.createElement(d.TableCell,{colSpan:e.items.length+1,style:{...i}},this.renderAddButton(s))):null)),!t.length&&this.state.value.length?o.createElement("div",{style:X.filteredOut},o.createElement(d.Typography,{style:X.title,variant:"h6",id:"tableTitle",component:"div"},D.I18n.t("ra_All items are filtered out"),o.createElement(d.IconButton,{size:"small",onClick:()=>this.applyFilter(!0)},o.createElement(P.Close,null)))):null),e.help?o.createElement(d.FormHelperText,{style:{paddingLeft:16}},this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null,this.state.errorMessage?o.createElement("div",{style:{display:"flex",padding:"5px"}},o.createElement(P.Warning,{color:"error"}),o.createElement("span",{style:{color:"red",alignSelf:"center"}},this.state.errorMessage)):null)}componentDidUpdate(){var e;(e=this.refDiv.current)!=null&&e.clientWidth&&this.refDiv.current.clientWidth!==this.state.width&&(this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{var t;this.resizeTimeout=null,this.setState({width:(t=this.refDiv.current)==null?void 0:t.clientWidth})},50))}getCurrentBreakpoint(){return this.state.width?this.state.width<600?"xs":this.state.width<900?"sm":this.state.width<1200?"md":this.state.width<1536?"lg":"xl":"md"}renderItem(){const{schema:e}=this.props;if(!this.state.value||!Array.isArray(this.state.value))return null;const t=this.getCurrentBreakpoint();let s;return t&&(e.useCardFor||["xs"]).includes(t)?s=this.renderCards():s=this.renderTable(),o.createElement("div",{ref:this.refDiv,style:{width:"100%"}},s)}}const Pe={indeterminate:{opacity:.5},label:{width:"100%",fontSize:14,marginBottom:2},helper:{width:"100%",fontSize:12},error:{width:"100%",fontSize:12,color:"#FF0000"}};class Pn extends b{updateTimeout=null;componentDidMount(){super.componentDidMount();let e=b.getValue(this.props.data,this.props.attr);if(Array.isArray(e)&&this.props.oContext.multiEdit){e=b.DIFFERENT_VALUE,this.setState({value:e,oldValue:e,jsonError:!1});return}this.setState({value:e,oldValue:e,jsonError:this.validateJson(e)})}validateJson(e){let t=!1;if(this.props.schema.validateJson&&(e||!this.props.schema.allowEmpty))try{JSON.parse(e)}catch(s){console.log("Error in JSON",s),t=!0}return t}static getDerivedStateFromProps(e,t){if(e.oContext.multiEdit&&t.value===b.DIFFERENT_VALUE)return{value:b.DIFFERENT_VALUE};let s=b.getValue(e.data,e.attr);return s!=null&&(s=s.toString()),s==null||s!==t.value&&s!==t.oldValue?{value:s}:null}renderItem(e,t){const s=Array.isArray(this.state.value)||this.state.value===b.DIFFERENT_VALUE;if(this.props.schema.time){let r="";return typeof this.state.value=="number"?this.state.value&&this.state.value<9466596e5?r=new Date(this.state.value*1e3).toLocaleString():r=new Date(this.state.value).toLocaleString():typeof this.state.value=="string"&&(r=new Date(this.state.value).toLocaleString()),o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:r,error:!!e||!!this.state.jsonError,disabled:!!t,slotProps:{htmlInput:{readOnly:!0}},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}if(this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=null,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=null),s){const r=b.getValue(this.props.data,this.props.attr),a=(r==null?void 0:r.filter(l=>l||l===0).map(l=>({label:l.toString()||"",value:l})))||[];return a.unshift({label:D.I18n.t(b.DIFFERENT_LABEL),value:b.DIFFERENT_VALUE}),o.createElement(d.Autocomplete,{style:Pe.indeterminate,fullWidth:!0,value:a[0],onChange:(l,c)=>{const u=c?c.value:"",m=this.onChange(this.props.attr,u,()=>{this.setState({value:u,oldValue:u,jsonError:this.validateJson(c)})});m instanceof Promise&&m.catch(y=>console.error(`Cannot set value: ${y}`))},options:a,getOptionLabel:l=>l.label,renderInput:l=>o.createElement(d.TextField,{variant:"standard",...l,error:!!e,placeholder:this.getText(this.props.schema.placeholder),slotProps:{htmlInput:{...l.inputProps,maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1}},label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:!!t})})}let i,n;if((this.props.schema.readOnly||t)&&this.props.schema.copyToClipboard?(this.props.schema.minRows>1&&(n={position:"absolute",right:3,top:20,zIndex:1e3}),i=o.createElement(d.IconButton,{style:n,size:"small",onClick:()=>{D.Utils.copyToClipboard(this.state.value),window.alert(D.I18n.t("ra_Copied"))}},o.createElement(D.IconCopy,null))):!this.props.schema.readOnly&&!t&&this.state.value&&!this.props.schema.noClearButton&&(this.props.schema.minRows>1&&(n={position:"absolute",right:3,top:20,zIndex:1e3}),i=o.createElement(d.IconButton,{style:n,size:"small",onClick:()=>this.setState({value:"",oldValue:this.state.value},()=>this.onChange(this.props.attr,""))},o.createElement(P.Close,null)),this.props.schema.minRows<=1&&(i=o.createElement(d.InputAdornment,{position:"end"},i))),this.props.schema.minRows>1){const r=this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation);return o.createElement("div",{style:{width:"100%",position:"relative"}},this.props.schema.label?o.createElement("div",{style:Pe.label},this.getText(this.props.schema.label)):null,o.createElement(d.TextareaAutosize,{style:{width:"100%",resize:"vertical",backgroundColor:this.props.oContext.themeType==="dark"?"#363636":"#cccccc",color:this.props.oContext.themeType==="dark"?"#fff":"#111"},minRows:this.props.schema.minRows,maxRows:this.props.schema.maxRows,value:this.state.value===null||this.state.value===void 0?"":this.state.value,disabled:!!t,readOnly:this.props.schema.readOnly||!1,onChange:a=>{const l=a.target.value;this.setState({value:l,oldValue:this.state.value,jsonError:this.validateJson(l)},()=>this.onChange(this.props.attr,l||""))},placeholder:this.getText(this.props.schema.placeholder)}),r||e||this.state.jsonError?o.createElement("div",{style:e?Pe.error:Pe.helper},e||(this.state.jsonError?D.I18n.t("ra_Invalid JSON"):r)):null)}return o.createElement(d.TextField,{variant:"standard",fullWidth:!0,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e||!!this.state.jsonError,disabled:!!t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1},input:{endAdornment:i}},onChange:r=>{const a=r.target.value;this.setState({value:a,oldValue:this.state.value,jsonError:this.validateJson(a)},()=>this.onChange(this.props.attr,a))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.state.jsonError?D.I18n.t("ra_Invalid JSON"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const Rn={fullWidth:{width:"100%"}};class Mn extends b{initialized=!1;localContext;askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData,null,!0);try{e=JSON.parse(t)}catch{console.error(`Cannot parse json data: ${t}`)}}e===void 0&&(e=null),this.props.oContext.socket.sendTo(`${this.props.oContext.adapterName}.${this.props.oContext.instance}`,this.props.schema.command||"send",e).then(t=>{if(typeof t=="object"){const s=t;this.setState({text:s.text||"",style:s.style,icon:s.icon,iconStyle:s.iconStyle})}else typeof t=="string"&&this.setState({text:t||""})}).catch(t=>console.error(`Cannot send command: ${t}`))}}getLocalContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=b.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(){if(this.props.alive){const t=this.getLocalContext();(t!==this.localContext||!this.initialized)&&(this.localContext=t,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}if(this.state.text===void 0)return null;let e=null;return this.state.icon&&(e=De(this.state.icon,{marginRight:this.state.text?8:void 0,...this.state.iconStyle||void 0}),e||(e=o.createElement(D.Icon,{src:this.state.icon,style:{marginRight:this.state.text?8:void 0,...this.state.iconStyle||void 0}}))),this.props.schema.container==="text"?o.createElement(d.TextField,{variant:"standard",fullWidth:!0,slotProps:{input:{endAdornment:this.props.schema.copyToClipboard?o.createElement(d.IconButton,{size:"small",onClick:()=>{D.Utils.copyToClipboard(this.state.text),window.alert(D.I18n.t("ra_Copied"))}},o.createElement(D.IconCopy,null)):void 0}},value:this.state.text,label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}):o.createElement("div",{style:{...Rn.fullWidth,...this.state.style||void 0}},e,this.props.schema.container==="html"?o.createElement("span",{dangerouslySetInnerHTML:{__html:this.state.text||""}}):this.state.text)}}class Vn extends b{componentDidMount(){super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);this.setState({value:e})}renderItem(e,t){const s=this.props.schema.returnFormat!=="HH:mm:ss",i=new Date(Date.parse(`Thu, 01 Jan 1970 ${this.state.value||"00:00:00"}`));return o.createElement(Ot.TimePicker,{sx:n=>({width:"100%",borderBottom:`1px solid ${n.palette.text.primary}`,"& fieldset":{display:"none"},"& input":{padding:`${n.spacing(1.5)} 0 4px 0`},"& .MuiInputAdornment-root":{marginLeft:0,marginTop:1},"& label":{transform:"translate(0px, -9px) scale(0.75)"}}),ampm:this.props.oContext.systemConfig.dateFormat.includes("/"),timeSteps:this.props.schema.timeSteps||this.props.schema.timesteps||{hours:1,minutes:5,seconds:5},format:this.props.schema.format||"HH:mm:ss",disabled:!!t,value:i,onChange:n=>{let r;r=n instanceof Date?n.toTimeString().split(" ")[0]:n.toTimeString(),s&&(r=r.split(":").slice(0,2).join(":")),this.setState({value:r},()=>this.onChange(this.props.attr,this.state.value))},views:this.props.schema.views||["hours","minutes","seconds"],label:this.getText(this.props.schema.label)})}}function jn(h,e){let t;return e&&h.substring(0,e.length)===e?t=h.substring(e.length+1):t=h,t=t.replace(/\./g,"/").replace(/_/g," "),t}class Un extends b{componentDidMount(){var t;super.componentDidMount();const e=b.getValue(this.props.data,this.props.attr);if(!e&&((t=this.props.customObj)!=null&&t._id)){const s=jn(this.props.customObj._id,`${this.props.oContext.adapterName}.${this.props.oContext.instance}`);this.setState({value:s})}else this.setState({value:e||""})}renderItem(e,t){return o.createElement(d.TextField,{variant:"standard",fullWidth:!0,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},value:this.state.value,error:!!e,disabled:t,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),onChange:s=>{const i=s.target.value;this.setState({value:i},()=>this.onChange(this.props.attr,i))}})}}class Wn extends b{async componentDidMount(){var t;super.componentDidMount();const e=await this.props.oContext.socket.getObject("system.meta.uuid");this.setState({uuid:((t=e==null?void 0:e.native)==null?void 0:t.uuid)||"unknown"})}renderItem(e,t){return o.createElement(d.TextField,{variant:"standard",fullWidth:!0,error:!!e,disabled:!!t,slotProps:{htmlInput:{readOnly:!0},input:{endAdornment:o.createElement(d.IconButton,{onClick:()=>{D.Utils.copyToClipboard(this.state.uuid),window.alert(D.I18n.t("ra_Copied %s",this.state.uuid))}},o.createElement(P.ContentCopy,null))}},value:this.state.uuid||"",label:this.getText(this.props.schema.label)||D.I18n.t("ra_Serial number (UUID)"),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const At={icon:{width:16,height:16,marginRight:8}};class zn extends b{componentDidMount(){super.componentDidMount(),this.props.oContext.socket.getUsers().then(e=>{const t={},s=D.I18n.getLanguage();this.props.schema.short?e.forEach(i=>{var n,r;return t[i._id]={color:(n=i.common)==null?void 0:n.color,icon:(r=i.common)==null?void 0:r.icon,name:D.Utils.getObjectNameFromObj(i,s)}}):e.forEach(i=>{var n,r;return t[i._id.replace(/^system\.user\./,"")]={color:(n=i.common)==null?void 0:n.color,icon:(r=i.common)==null?void 0:r.icon,name:D.Utils.getObjectNameFromObj(i,s)}}),this.setState({users:t})}).catch(e=>console.error(`Cannot get users: ${e}`))}renderItem(e,t){var i,n;const s=b.getValue(this.props.data,this.props.attr);return o.createElement(d.FormControl,{variant:"standard",fullWidth:!0},this.state.users&&this.props.schema.label?o.createElement(d.InputLabel,null,this.getText(this.props.schema.label)):null,this.state.users?o.createElement(d.Select,{variant:"standard",error:!!e,disabled:!!t,value:s,renderValue:r=>{var a,l,c;return o.createElement("span",null,this.state.users&&((a=this.state.users[r])!=null&&a.icon)?o.createElement(D.Icon,{src:this.state.users&&((l=this.state.users[r])==null?void 0:l.icon),style:At.icon}):null,this.state.users&&((c=this.state.users[r])==null?void 0:c.name)||r||"")},style:{color:this.state.users&&((i=this.state.users[s])==null?void 0:i.color)||void 0,backgroundColor:D.Utils.getInvertedColor(this.state.users&&((n=this.state.users[s])==null?void 0:n.color),this.props.oContext.themeType)},onChange:r=>this.onChange(this.props.attr,r.target.value)},this.state.users&&Object.keys(this.state.users).map(r=>o.createElement(d.MenuItem,{style:{color:this.state.users[r].color||void 0,backgroundColor:D.Utils.getInvertedColor(this.state.users[r].color,this.props.oContext.themeType)},key:r,value:r},this.state.users[r].icon?o.createElement(D.Icon,{src:this.state.users[r].icon,style:At.icon}):null,this.state.users[r].name))):o.createElement(d.TextField,{variant:"standard",error:!!e,disabled:!!t,value:s,onChange:r=>this.onChange(this.props.attr,r.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?o.createElement(d.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}class Hn extends b{async componentDidMount(){super.componentDidMount();const e=await jt(()=>import("./index-DhhR2_Nl.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4]),import.meta.url);this.setState({QRCode:e.default})}renderItem(){const e=this.state.QRCode;return e?o.createElement(e,{value:this.props.schema.data,size:this.props.schema.size,fgColor:this.props.schema.fgColor,bgColor:this.props.schema.bgColor,level:this.props.schema.level}):null}}const Jn={accordion:us,alive:cs,autocomplete:hs,autocompleteSendTo:ps,certCollection:gs,certificate:ms,certificates:fs,checkbox:Ds,checkLicense:Ce,chip:ut,chips:ut,color:bs,coordinates:xs,cron:ds,custom:Ie,datePicker:Is,deviceManager:ks,divider:_n,file:Us,fileSelector:Ue,func:Ws,header:kn,image:Js,imageSendTo:Hs,instance:qs,interface:Ks,ip:zs,jsonEditor:un,language:hn,license:pn,number:dn,objectId:mn,password:fn,pattern:gn,port:Cn,qrCode:Hn,room:yn,select:En,selectSendTo:xn,sendto:gt,sendTo:gt,setState:An,slider:Fn,state:Tn,staticImage:Bn,staticInfo:On,staticLink:xt,staticText:xt,table:oe,text:Pn,textSendTo:Mn,timePicker:Vn,topic:Un,uuid:Wn,user:zn},he={fullWidth:{width:"100%"},paper:{margin:1,width:"auto !important",overflowY:"auto",paddingBottom:1},paperWithIcons:{height:"calc(100vh - 259px) !important"},paperWithoutIcons:{height:"calc(100vh - 235px) !important"},padding:{padding:"10px"},heading:{},primary:h=>({backgroundColor:h.palette.primary.main,color:h.palette.mode==="dark"?"inherit":"#FFF"}),secondary:h=>({backgroundColor:h.palette.secondary.main})};class Ae extends b{componentDidMount(){var e;super.componentDidMount(),(e=this.props.schema)!=null&&e.collapsable&&this.setState({expanded:(window._localStorage||window.localStorage).getItem(`${this.props.oContext.adapterName}.${this.props.attr}`)==="true"})}renderItems(e,t){return e?Object.keys(e).map(s=>{if(this.props.oContext.multiEdit&&e[s].noMultiEdit)return null;const i=e[s].type||"panel";let n,r="Use this.props.oContext.socket!";return i==="custom"?(e[s].url?n=Ie:this.props.oContext.customs&&this.props.oContext.customs[e[s].component]?n=this.props.oContext.customs[e[s].component]:(console.error(`Cannot find custom component: ${e[s].component}`),n=b),r=this.props.oContext.socket):i==="panel"?n=Ae:n=Jn[i]||b,o.createElement(n,{socket:r,globalData:this.props.globalData,oContext:this.props.oContext,key:`${s}_${this.props.index===void 0?"":this.props.index}`,index:this.props.index,changed:this.props.changed,arrayIndex:this.props.arrayIndex,commandRunning:this.props.commandRunning,style:he.panel,common:this.props.common,alive:this.props.alive,themeName:this.props.themeName,data:this.props.data,originalData:this.props.originalData,onError:this.props.onError,onChange:this.props.onChange,disabled:t,customObj:this.props.customObj,custom:this.props.custom,schema:e[s],attr:s,table:this.props.table})}):null}render(){const e=this.props.schema;if(!e)return null;const{disabled:t,hidden:s}=this.calculate(e),i=this.props.schema.items,n=this.props.schema.style||{};if(s){if(e.hideOnlyControl){const a=o.createElement(d.Grid2,{size:{xs:e.xs||void 0,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},sx:D.Utils.getStyle(this.props.oContext.theme,{marginBottom:0,textAlign:"left"},n,this.props.oContext.themeType==="dark"&&e.darkStyle)});return e.newLine?o.createElement(o.Fragment,null,o.createElement("div",{style:{flexBasis:"100%",height:0}}),a):a}return null}if(this.props.table)return this.renderItems(i,t);if(this.props.custom)return o.createElement(d.Grid2,{key:`${this.props.attr}_${this.props.index}`,container:!0,style:he.fullWidth,columnSpacing:2,rowSpacing:1,sx:n},this.renderItems(i,t));let r;if(e.collapsable?r=o.createElement(d.Accordion,{key:`${this.props.attr}_${this.props.index}`,style:he.fullWidth,expanded:!!this.state.expanded,onChange:()=>{(window._localStorage||window.localStorage).setItem(`${this.props.oContext.adapterName}.${this.props.attr}`,this.state.expanded?"false":"true"),this.setState({expanded:!this.state.expanded})}},o.createElement(d.AccordionSummary,{expandIcon:o.createElement(P.ExpandMore,null),sx:D.Utils.getStyle(this.props.oContext.theme,n,this.props.oContext.themeType&&e.darkStyle,e.color==="primary"?he.primary:e.color==="secondary"&&he.secondary,{width:"100%"})},o.createElement(d.Typography,{style:he.heading},this.getText(e.label))),o.createElement(d.AccordionDetails,null,o.createElement(d.Grid2,{container:!0,columnSpacing:2,rowSpacing:1,sx:{...n,width:"100%",padding:"10px"}},this.renderItems(i,t)))):r=o.createElement(d.Box,{component:"div",key:`${this.props.attr}_${this.props.index}`,className:this.props.className,sx:D.Utils.getStyle(this.props.oContext.theme,this.props.style,n,{width:"100%"},this.props.isParentTab&&he.paper,this.props.isParentTab&&(this.props.withIcons?he.paperWithIcons:he.paperWithoutIcons))},o.createElement(d.Grid2,{container:!0,columnSpacing:2,rowSpacing:1,sx:D.Utils.getStyle(this.props.oContext.theme,{width:"100%"},this.props.isParentTab&&he.padding,this.props.schema.innerStyle)},this.renderItems(i,t))),!this.props.isParentTab){const a=o.createElement(d.Grid2,{title:this.getText(e.tooltip),size:{xs:e.xs||void 0,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},sx:{marginBottom:0,textAlign:"left",...n}},r);return e.newLine?o.createElement(o.Fragment,null,o.createElement("div",{style:{flexBasis:"100%",height:0}}),a):a}return r}}const Re={tabs:{height:"100%",width:"100%"},panel:{width:"100%",display:"block"},panelWithIcons:{height:"calc(100% - 72px)"},panelWithoutIcons:{height:"calc(100% - 48px)"}};class qn extends b{resizeTimeout=null;refDiv;constructor(e){super(e);let t;if(this.props.root){const s=(window.location.hash||"").replace(/^#/,"").split("/");if(s.length>=3&&s[1]==="config"){const i=s[3],n=parseInt(i,10);i&&n.toString()===i?n>=0&&n<Object.keys(this.props.schema.items).length&&(t=Object.keys(this.props.schema.items)[n]):i&&Object.keys(this.props.schema.items).includes(i)&&(t=i),window.addEventListener("hashchange",this.onHashTabsChanged,!1)}}t===void 0&&(t=(window._localStorage||window.localStorage).getItem(`${this.props.dialogName||"App"}.${this.props.oContext.adapterName}`)||Object.keys(this.props.schema.items)[0],Object.keys(this.props.schema.items).includes(t)||(t=Object.keys(this.props.schema.items)[0])),this.refDiv=o.createRef(),Object.assign(this.state,{tab:t,width:0,openMenu:null})}componentWillUnmount(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),window.removeEventListener("hashchange",this.onHashTabsChanged,!1),super.componentWillUnmount()}onHashTabsChanged=()=>{const e=(window.location.hash||"").replace(/^#/,"").split("/");if(e.length>3&&e[1]==="config"){const t=e[3],s=parseInt(t,10);let i;s.toString()===t?s>=0&&s<Object.keys(this.props.schema.items).length&&(i=Object.keys(this.props.schema.items)[s]):Object.keys(this.props.schema.items).includes(t)&&(i=t),i!==void 0&&i!==this.state.tab&&((window._localStorage||window.localStorage).setItem(`${this.props.dialogName||"App"}.${this.props.oContext.adapterName}`,i),this.setState({tab:i}))}};getCurrentBreakpoint(){if(!this.state.width)return"md";if(!this.state.initialBreakpoint){let e;return this.state.width<600?e="xs":this.state.width<900?e="sm":this.state.width<1200?e="md":this.state.width<1536?e="lg":e="xl",setTimeout(()=>{this.setState({initialBreakpoint:e})},50),e}return this.state.initialBreakpoint}componentDidUpdate(){var e;!this.state.initialBreakpoint&&((e=this.refDiv.current)!=null&&e.clientWidth)&&this.refDiv.current.clientWidth!==this.state.width&&(this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{var t;this.resizeTimeout=null,this.setState({width:(t=this.refDiv.current)==null?void 0:t.clientWidth})},50))}onMenuChange(e){(window._localStorage||window.localStorage).setItem(`${this.props.dialogName||"App"}.${this.props.oContext.adapterName}`,e),this.setState({tab:e},()=>{if(this.props.root){const t=(window.location.hash||"").split("/");t.length>=3&&t[1]==="config"&&(t[3]=this.state.tab,window.location.hash=t.join("/"))}})}render(){const e=this.props.schema.items;let t=!1;const s=[];Object.keys(e).map(r=>{let a;if(this.props.custom){if(this.executeCustom(e[r].hidden,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.index,this.props.globalData))return;a=this.executeCustom(e[r].disabled,this.props.data,this.props.customObj,this.props.oContext.instanceObj,this.props.index,this.props.globalData)}else{if(this.execute(e[r].hidden,!1,this.props.data,this.props.index,this.props.globalData))return;a=this.execute(e[r].disabled,!1,this.props.data,this.props.index,this.props.globalData)}const l=this.getIcon(e[r].icon);t=t||!!l,s.push({icon:l,disabled:a,label:this.getText(e[r].label),name:r})});const i=this.getCurrentBreakpoint();let n;return i==="xs"&&s.length>2?n=o.createElement(d.Toolbar,{style:{top:2,backgroundColor:this.props.oContext.themeType==="dark"?"#222":"#DDD"},variant:"dense"},o.createElement(d.IconButton,{onClick:r=>this.setState({openMenu:r.currentTarget})},o.createElement(P.Menu,null)),this.state.openMenu?o.createElement(d.Menu,{open:!0,anchorEl:this.state.openMenu,onClose:()=>this.setState({openMenu:null})},s.map(r=>o.createElement(d.MenuItem,{disabled:r.disabled,key:r.name,onClick:()=>{this.setState({openMenu:null},()=>this.onMenuChange(r.name))},selected:r.name===this.state.tab},t?o.createElement(d.ListItemIcon,null,r.icon):null,r.label))):null):n=o.createElement(d.Tabs,{variant:"scrollable",scrollButtons:"auto",style:this.props.schema.tabsStyle,value:this.state.tab,onChange:(r,a)=>this.onMenuChange(a)},s.map(r=>o.createElement(d.Tab,{id:r.name,wrapped:!0,disabled:r.disabled,key:r.name,value:r.name,iconPosition:this.props.schema.iconPosition||"start",icon:r.icon,label:r.label}))),o.createElement("div",{style:Re.tabs,ref:this.refDiv},n,o.createElement(Ae,{oContext:this.props.oContext,isParentTab:!0,changed:this.props.changed,key:this.state.tab,index:1001,arrayIndex:this.props.arrayIndex,globalData:this.props.globalData,commandRunning:this.props.commandRunning,style:{...Re.panel,...t?Re.panelWithIcons:Re.panelWithoutIcons},common:this.props.common,alive:this.props.alive,themeName:this.props.themeName,data:this.props.data,originalData:this.props.originalData,onChange:this.props.onChange,onError:this.props.onError,customObj:this.props.customObj,custom:this.props.custom,schema:e[this.state.tab],table:this.props.table,withIcons:t}))}}const Kn={root:{width:"100%",height:"100%"}};class Qe extends _e.Component{forceUpdateHandlers;errorTimeout=null;errorCached=null;oContext;constructor(e){super(e),this.state={originalData:JSON.stringify(this.props.data),changed:!1,errors:{},updateData:this.props.updateData||0,systemConfig:null,alive:!1,commandRunning:!1,schema:JSON.parse(JSON.stringify(this.props.schema))},this.forceUpdateHandlers={},this.buildDependencies(this.state.schema),this.readData()}static getDerivedStateFromProps(e,t){return e.updateData!==t.updateData?{updateData:e.updateData,originalData:JSON.stringify(e.data),schema:JSON.parse(JSON.stringify(e.schema))}:null}static async loadI18n(e,t,s){if(t===!0||t&&typeof t=="string"){const i=D.I18n.getLanguage(),n=typeof t=="string"?t:"i18n";let r=await e.fileExists(`${s}.admin`,`${n}/${i}.json`),a;if(r?a=`${n}/${i}.json`:(r=await e.fileExists(`${s}.admin`,`${n}/${i}/translations.json`),r?a=`${n}/${i}/translations.json`:i!=="en"&&(r=await e.fileExists(`${s}.admin`,`${n}/en.json`),r?a=`${n}/en.json`:(r=await e.fileExists(`${s}.admin`,`${n}/en/translations.json`),r&&(a=`${n}/en/translations.json`)))),a){const l=await e.readFile(`${s}.admin`,a);let c;l.file!==void 0?c=l.file:c=l;try{const u=JSON.parse(c);D.I18n.extendTranslations(u,i)}catch(u){return console.error(`Cannot parse language file "${s}.admin/${a}: ${u}`),""}return a}return console.warn(`Cannot find i18n for ${s} / ${a}`),""}return t&&typeof t=="object"&&D.I18n.extendTranslations(t),""}onCommandRunning=e=>this.setState({commandRunning:e});readData(){this.props.socket.getCompactSystemConfig().then(e=>this.props.socket.getState(`system.adapter.${this.props.adapterName}.${this.props.instance}.alive`).then(t=>this.setState({systemConfig:e.common,alive:!!(t&&t.val)},()=>{this.updateContext(!0),this.props.custom||this.props.socket.subscribeState(`system.adapter.${this.props.adapterName}.${this.props.instance}.alive`,this.onAlive)}))).catch(e=>console.error(`Cannot read system config: ${e}`))}onAlive=(e,t)=>{!!(t!=null&&t.val)!==this.state.alive&&this.setState({alive:!!(t!=null&&t.val)})};onChange=(e,t,s,i)=>{if(this.props.onValueChange)this.props.onValueChange(e,t,i),s&&s();else if(e&&this.props.onChange){const n={changed:JSON.stringify(e)!==this.state.originalData};this.setState(n,()=>{this.props.onChange(e,n.changed,i),s&&s()})}else i&&this.props.onChange(null,null,i)};onError=(e,t)=>{this.errorCached=this.errorCached||JSON.parse(JSON.stringify(this.state.errors));const s=this.errorCached;t?s[e]=t:delete s[e],this.errorTimeout&&clearTimeout(this.errorTimeout),JSON.stringify(s)!==JSON.stringify(this.state.errors)?this.errorTimeout=setTimeout(()=>this.setState({errors:this.errorCached},()=>{this.errorTimeout=null,this.errorCached=null,this.props.onError(!!Object.keys(this.state.errors).length)}),50):this.errorCached=null};flatten(e,t){return t=t||{},e.items&&Object.keys(e.items).forEach(s=>{t[s]=e.items[s],this.flatten(e.items[s],t)}),t}buildDependencies(e){const t=this.flatten(e);Object.keys(t).forEach(s=>{var i,n,r,a,l,c,u,m,y,_;(i=t[s].confirm)!=null&&i.alsoDependsOn&&((n=t[s].confirm)==null||n.alsoDependsOn.forEach(T=>{if(!t[T])console.error(`[JsonConfigComponent] Attribute ${T} does not exist!`),T.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${T.replace(/^data\./,"")}" instead of "${T}"`);else{t[T].confirmDependsOn=t[T].confirmDependsOn||[];const A={...t[s],attr:s};A.confirm&&(A.confirm.cancel="Undo"),t[T].confirmDependsOn.push(A)}})),(r=t[s].onChange)!=null&&r.alsoDependsOn&&((a=t[s].onChange)==null||a.alsoDependsOn.forEach(T=>{if(!t[T])console.error(`[JsonConfigComponent] Attribute ${T} does not exist!`),T.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${T.replace(/^data\./,"")}" instead of "${T}"`);else{t[T].onChangeDependsOn=t[T].onChangeDependsOn||[];const A={...t[s],attr:s};t[T].onChangeDependsOn.push(A)}})),(l=t[s].hidden)!=null&&l.alsoDependsOn&&((c=t[s].hidden)==null||c.alsoDependsOn.forEach(T=>{if(!t[T])console.error(`[JsonConfigComponent] Attribute ${T} does not exist!`),T.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${T.replace(/^data\./,"")}" instead of "${T}"`);else{t[T].hiddenDependsOn=t[T].hiddenDependsOn||[];const A={...t[s],attr:s};t[T].hiddenDependsOn.push(A)}})),(u=t[s].label)!=null&&u.alsoDependsOn&&((m=t[s].label)==null||m.alsoDependsOn.forEach(T=>{if(!t[T])console.error(`[JsonConfigComponent] Attribute ${T} does not exist!`),T.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${T.replace(/^data\./,"")}" instead of "${T}"`);else{t[T].labelDependsOn=t[T].labelDependsOn||[];const A={...t[s],attr:s};t[T].labelDependsOn.push(A)}})),(y=t[s].help)!=null&&y.alsoDependsOn&&((_=t[s].help)==null||_.alsoDependsOn.forEach(T=>{if(!t[T])console.error(`[JsonConfigComponent] Attribute ${T} does not exist!`),T.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${T.replace(/^data\./,"")}" instead of "${T}"`);else{t[T].helpDependsOn=t[T].helpDependsOn||[];const A={...t[s],attr:s};t[T].helpDependsOn.push(A)}}))})}updateContext(e){this.oContext={DeviceManager:this.props.DeviceManager,adapterName:this.props.adapterName,changeLanguage:this.changeLanguage,common:this.props.common,customs:this.props.customs,dateFormat:this.props.dateFormat,embedded:this.props.embedded,expertMode:this.props.expertMode,forceUpdate:this.forceAttrUpdate,imagePrefix:this.props.imagePrefix,instance:this.props.instance,instanceObj:this.props.instanceObj,isFloatComma:this.props.isFloatComma,multiEdit:this.props.multiEdit,onBackEndCommand:this.props.onBackEndCommand,onCommandRunning:this.onCommandRunning,onValueChange:this.props.onValueChange,registerOnForceUpdate:this.registerOnForceUpdate,socket:this.props.socket,systemConfig:this.state.systemConfig,theme:this.props.theme,themeType:this.props.themeType,_themeName:this.props.themeName,updateData:this.state.updateData},e&&this.forceUpdate()}renderItem(e){return e.type==="tabs"?o.createElement(qn,{oContext:this.oContext,alive:this.state.alive,changed:this.state.changed,commandRunning:this.state.commandRunning,common:this.props.common,custom:this.props.custom,customObj:this.props.customObj,data:this.props.data,onChange:this.onChange,onError:(t,s)=>this.onError(t,s),originalData:JSON.parse(this.state.originalData),root:!0,schema:e,themeName:this.props.themeName}):e.type==="panel"||!e.type?o.createElement(Ae,{oContext:this.oContext,alive:this.state.alive,changed:this.state.changed,commandRunning:this.state.commandRunning,common:this.props.common,custom:this.props.custom,customObj:this.props.customObj,data:this.props.data,index:1e3,isParentTab:!this.props.embedded,onChange:this.onChange,onError:(t,s)=>this.onError(t,s),originalData:JSON.parse(this.state.originalData),root:!0,schema:e,themeName:this.props.themeName}):(console.error(`Unknown item type in root: ${JSON.stringify(e)}`),null)}changeLanguage=()=>{this.forceUpdate()};forceAttrUpdate=(e,t)=>{Array.isArray(e)?e.forEach(s=>this.forceUpdateHandlers[s]&&this.forceUpdateHandlers[s](t)):this.forceUpdateHandlers[e]&&this.forceUpdateHandlers[e](t)};registerOnForceUpdate=(e,t)=>{t?this.forceUpdateHandlers[e]=t:this.forceUpdateHandlers[e]&&delete this.forceUpdateHandlers[e]};render(){return!this.state.systemConfig||!this.oContext?o.createElement(d.LinearProgress,null):(this.oContext._themeName!==this.props.themeName&&(this.oContext._themeName=this.props.themeName,setTimeout(()=>this.updateContext(!0),0)),o.createElement("div",{style:{...this.props.embedded?void 0:Kn.root,...this.props.style,...this.state.schema.style}},this.renderItem(this.state.schema)))}}const be={root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scroll:{height:"calc(100% - 48px)",overflowY:"auto"},exportImportButtons:{position:"absolute",top:5,right:0,zIndex:3},button:{marginRight:"5px"},tooltip:{pointerEvents:"none"}};function Xn(h,e){let t="";for(let s=0;s<e.length;s++)t+=String.fromCharCode(h[s%h.length].charCodeAt(0)^e.charCodeAt(s));return t}function Gn(h,e){let t="";for(let s=0;s<e.length;s++)t+=String.fromCharCode(h[s%h.length].charCodeAt(0)^e.charCodeAt(s));return t}function Yn(h,e){if(typeof e!="string")return e;if(!e.startsWith("$/aes-192-cbc:")||!/^[0-9a-f]{48}$/.test(h))return Xn(h,e);const t=e.split(":",3),s=window.CryptoJS.enc.Hex.parse(h),i=window.CryptoJS.enc.Hex.parse(t[1]),n=window.CryptoJS.lib.CipherParams.create({ciphertext:window.CryptoJS.enc.Hex.parse(t[2])}),r=window.CryptoJS.AES.decrypt(n,s,{iv:i});return window.CryptoJS.enc.Utf8.stringify(r)}function Zn(h,e,t){if(typeof e!="string")return e;if(!/^[0-9a-f]{48}$/.test(h))return Gn(h,e);let s;s=window.CryptoJS.lib.WordArray.random(128/8);const i=window.CryptoJS.enc.Hex.parse(h),n=window.CryptoJS.AES.encrypt(e,i,{iv:s}).ciphertext;return`$/aes-192-cbc:${window.CryptoJS.enc.Hex.stringify(s)}:${n}`}function Ft(h,e){var t;return document.getElementById(e)?(t=document.getElementById(e))==null?void 0:t.onload:new Promise(s=>{const i=document.createElement("script");i.setAttribute("id",e),i.onload=s,i.src=h,document.getElementsByTagName("head")[0].appendChild(i)})}class fi extends D.Router{fileSubscribed=[];fileLangSubscribed="";secret;constructor(e){super(e),this.state={updateData:0,changed:!1,confirmDialog:!1,theme:D.Theme(e.themeName),saveConfigDialog:!1,hash:"_"},this.secret=e.secret||"",this.getInstanceObject().then(t=>this.getConfigFile().then(s=>Qe.loadI18n(this.props.socket,s==null?void 0:s.i18n,this.props.adapterName).then(i=>{i&&(this.fileLangSubscribed||(this.fileLangSubscribed=i,this.props.socket.subscribeFiles(`${this.props.adapterName}.admin`,this.fileLangSubscribed,this.onFileChange))),t?this.setState({schema:s,data:t.native,common:t.common,hash:at(JSON.stringify(s)).toString()}):window.alert(`Instance system.adapter.${this.props.adapterName}.${this.props.instance} not found!`)})))}componentWillUnmount(){super.componentWillUnmount(),this.fileSubscribed.length&&(this.props.socket.unsubscribeFiles(`${this.props.adapterName}.admin`,this.fileSubscribed,this.onFileChange),this.fileSubscribed=[]),this.fileLangSubscribed&&(this.props.socket.unsubscribeFiles(`${this.props.adapterName}.admin`,this.fileLangSubscribed,this.onFileChange),this.fileLangSubscribed="")}handleFileSelect=e=>{const t=e.target.files[0];if(t){const s=new FileReader;s.onload=i=>{if(!i.target)return;const n=i.target.result;try{const r=JSON.parse(n);this.setState({data:r,changed:JSON.stringify(r)!==JSON.stringify(this.state.originalData)})}catch{window.alert(D.I18n.t("[JsonConfig] Failed to parse JSON file"))}},s.readAsText(t)}else window.alert(D.I18n.t("[JsonConfig] Failed to open JSON File"))};getExportImportButtons(){return o.createElement("div",{style:be.exportImportButtons},o.createElement(d.Tooltip,{title:this.props.t("Import settings from JSON file"),slotProps:{popper:{sx:be.tooltip}}},o.createElement(d.Fab,{size:"small",sx:{"&.MuiFab-root":be.button},onClick:()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("id","files"),e.setAttribute("opacity",0),e.addEventListener("change",t=>this.handleFileSelect(t),!1),e.click()}},o.createElement(P.Publish,null))),o.createElement(d.Tooltip,{title:this.props.t("Export setting to JSON file"),slotProps:{popper:{sx:be.tooltip}}},o.createElement(d.Fab,{size:"small",sx:{"&.MuiFab-root":be.button},onClick:()=>{this.state.data&&D.Utils.generateFile(`${this.props.adapterName}.${this.props.instance}.json`,this.state.data)}},o.createElement(P.Publish,{style:{transform:"rotate(180deg)"}}))))}onFileChange=async(e,t,s)=>{var i;if(e===`${this.props.adapterName}.admin`&&s){if(t===this.fileLangSubscribed)try{await Qe.loadI18n(this.props.socket,(i=this.state.schema)==null?void 0:i.i18n,this.props.adapterName),this.setState({hash:`${this.state.hash}1`})}catch{}else if(this.fileSubscribed.includes(t))try{const n=await this.getConfigFile(this.fileSubscribed[0]);this.setState({schema:n,hash:at(JSON.stringify(n)).toString()})}catch{}}};async getInstanceObject(){var e;try{const t=await this.props.socket.getObject(`system.adapter.${this.props.adapterName}.${this.props.instance}`);if(Array.isArray(t.encryptedNative)){if(!this.secret){const s=await this.props.socket.getSystemConfig();await Ft("../../lib/js/crypto-js/crypto-js.js","crypto-js"),this.secret=s.native.secret}return(e=t.encryptedNative)==null||e.forEach(s=>{t.native[s]&&(t.native[s]=Yn(this.secret,t.native[s]))}),t}return t}catch(t){window.alert(`[JsonConfig] Cannot read instance object: ${t}`)}return null}renderDialogConfirm(){return this.state.confirmDialog?o.createElement(D.DialogConfirm,{title:D.I18n.t("ra_Please confirm"),text:D.I18n.t("ra_Some data are not stored. Discard?"),ok:D.I18n.t("ra_Discard"),cancel:D.I18n.t("ra_Cancel"),onClose:e=>this.setState({confirmDialog:!1},()=>e&&D.Router.doNavigate(null))}):null}async scanForInclude(e,t){if(typeof e["#include"]=="string"){const i=await this._getConfigFile(e["#include"],[...t]);return delete e["#include"],i&&(e={...e,...i}),e}const s=Object.keys(e);for(let i=0;i<s.length;i++)e[s[i]]&&typeof e[s[i]]=="object"&&(e[s[i]]=await this.scanForInclude(e[s[i]],t));return e}async getConfigFile(e){return this._getConfigFile(e)}async _getConfigFile(e,t){if(e=e||"jsonConfig.json5",t=t||[],t.includes(e))return window.alert(`[JsonConfig] Circular reference in file: ${e} => ${t.join(" => ")}`),null;t.push(e);try{await this.props.socket.fileExists(`${this.props.adapterName}.admin`,e)||(e="jsonConfig.json");const i=await this.props.socket.readFile(`${this.props.adapterName}.admin`,e);let n="",r="";if(i.file!==void 0&&(r=i.file),typeof r=="string")n=r;else if(r.type==="Buffer"){let a="";const l=new Uint8Array(r.data),c=l.byteLength;for(let u=0;u<c;u++)a+=String.fromCharCode(l[u]);n=a}this.fileSubscribed.includes(e)||(this.fileSubscribed.push(e),await this.props.socket.subscribeFiles(`${this.props.adapterName}.admin`,e,this.onFileChange));try{return await this.scanForInclude(Qt.parse(n),t)}catch(a){window.alert("[JsonConfig] Cannot parse json5 config!"),console.log(a)}}catch(s){this.state.schema||window.alert(`[JsonConfig] Cannot read file "${e}: ${s}`)}return null}renderSaveConfigDialog(){return this.state.saveConfigDialog?o.createElement(D.DialogConfirm,{title:D.I18n.t("ra_Please confirm"),text:D.I18n.t("Save configuration?"),ok:D.I18n.t("ra_Save"),cancel:D.I18n.t("ra_Cancel"),onClose:e=>this.setState({saveConfigDialog:!1},()=>e&&this.onSave(!0))}):null}findAttr(e,t){if(t=t||this.state.schema,t!=null&&t.items){if(e in t.items)return t.items[e];for(const s of Object.values(t.items)){const i=this.findAttr(e,s);if(i)return i}}return null}postProcessing(e,t,s){if(s=s||this.state.schema,!e){console.error(`Data is empty in postProcessing: ${t}, ${JSON.stringify(s)}`);return}const i=e[t];if(s.items)if(s.type==="table"){const n=i;if(!Array.isArray(n))return;for(const r of n)for(const a of s.items)this.postProcessing(r,a.attr,a)}else for(const[n,r]of Object.entries(s.items)){if(r.type==="panel"||r.type==="tabs"||r.type==="accordion")return;this.postProcessing(e,n,r)}else if(t&&typeof i=="string")if(s.type==="text")s.trim!==!1&&(e[t]=i.trim());else if(s.type==="ip")e[t]=i.trim();else if(s.type==="number"){const n=parseFloat(i.toString().replace(",","."));s.min!==void 0&&n<s.min?e[t]=s.min:s.max!==void 0&&n>s.max?e[t]=s.max:e[t]=n}else if(s.type==="port"){const n=parseInt(i.toString(),10);s.min!==void 0&&n<s.min?e[t]=s.min:s.max!==void 0&&n>s.max&&(e[t]=s.max),e[t]!==0&&n<20?e[t]=20:n>65535?e[t]=65535:e[t]=n}else s.type==="checkbox"&&(e[t]=e[t]===!0||e[t]==="true"||e[t]==="on"||e[t]===1||e[t]==="1")}async onSave(e,t){if(e){const s=await this.getInstanceObject();if(!s){console.error("Something went wrong: may be no connection?"),window.alert("Something went wrong: may be no connection?");return}if(!this.state.data||!this.state.schema)return;const i={};for(const r of Object.keys(this.state.data)){const a=this.findAttr(r);(!a||!a.doNotSave||a.type==="state")&&!r.startsWith("_")?b.setValue(s.native,r,this.state.data[r]):(b.setValue(s.native,r,null),i[r]=this.state.data[r])}try{const r=JSON.parse(JSON.stringify(s));if(Array.isArray(r.encryptedNative)){await Ft("../../lib/js/crypto-js/crypto-js.js","crypto-js");for(const a of r.encryptedNative)r.native[a]&&(r.native[a]=Zn(this.secret,r.native[a]))}await this.props.socket.setObject(r._id,r)}catch(r){window.alert(`[JsonConfig] Cannot set object: ${r}`)}const n={...s.native,...i};console.log(n),this.setState({changed:!1,data:n,updateData:this.state.updateData+1,originalData:n},()=>t&&D.Router.doNavigate(null))}else this.state.changed?this.setState({confirmDialog:!0}):D.Router.doNavigate(null)}componentDidUpdate(e,t){t.changed!==this.state.changed&&this.props.configStored(!this.state.changed)}async componentDidMount(){const e=`${window.location.protocol}//${window.location.host}${window.location.pathname}validate_config/${this.props.adapterName}`;console.log(`fetch ${e}`),await fetch(e)}render(){return!this.state.data||!this.state.schema?o.createElement(d.LinearProgress,null):o.createElement("div",{style:be.root},this.renderDialogConfirm(),this.getExportImportButtons(),this.renderSaveConfigDialog(),o.createElement(Qe,{key:this.state.hash,style:be.scroll,socket:this.props.socket,themeName:this.props.themeName,themeType:this.props.themeType,adapterName:this.props.adapterName,instance:this.props.instance,isFloatComma:this.props.isFloatComma,dateFormat:this.props.dateFormat,schema:this.state.schema,common:this.state.common,expertMode:this.props.expertMode,data:this.state.data,updateData:this.state.updateData,onError:e=>this.setState({error:e}),onChange:(e,t,s)=>{s&&this.state.error&&(window.alert(D.I18n.t("Cannot save configuration because of error in configuration")),s=!1),s&&!this.state.changed&&!t&&(s=!1),e?this.setState({data:e,changed:t,saveConfigDialog:s}):s!==void 0&&this.setState({saveConfigDialog:s})},DeviceManager:this.props.DeviceManager,theme:this.state.theme}),o.createElement(D.SaveCloseButtons,{isIFrame:!1,dense:!0,paddingLeft:0,newReact:!0,theme:this.state.theme,noTextOnButtons:this.props.width==="xs"||this.props.width==="sm"||this.props.width==="md",changed:!!(this.state.error||this.state.changed),error:!!this.state.error,onSave:e=>this.onSave(!0,e),onClose:()=>this.onSave(!1)}))}}export{b as ConfigGeneric,Ae as ConfigPanel,fi as JsonConfig,Qe as JsonConfigComponent};
